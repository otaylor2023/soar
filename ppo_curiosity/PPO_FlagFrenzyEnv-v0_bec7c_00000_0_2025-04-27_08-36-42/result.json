{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.26389194621193796, "policy_loss": -0.01839391172773415, "vf_loss": 0.009210709530132942, "vf_explained_var": -0.04020241921947849, "kl": 0.007307118612202344, "entropy": 25.61701749986218, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 155.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.83329724562503, "num_env_steps_trained_throughput_per_sec": 195.83329724562503, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 20425.448, "sample_time_ms": 16741.811, "load_time_ms": 22.241, "load_throughput": 179845.166, "learn_time_ms": 3527.543, "learn_throughput": 1133.934, "synch_weights_time_ms": 131.042}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "bec7c_00000", "date": "2025-04-27_08-37-13", "timestamp": 1745743033, "time_this_iter_s": 20.43236494064331, "time_total_s": 20.43236494064331, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 20.43236494064331, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.69655172413792, "ram_util_percent": 12.431034482758617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.2672619631093356, "policy_loss": -0.02067115958179197, "vf_loss": 0.009085350569371405, "vf_explained_var": 0.003896954559510754, "kl": 0.007240445420041309, "entropy": 25.712424911991242, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.20814913067997, "num_env_steps_trained_throughput_per_sec": 213.20814913067997, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 19593.215, "sample_time_ms": 15945.161, "load_time_ms": 264.276, "load_throughput": 15135.69, "learn_time_ms": 3293.664, "learn_throughput": 1214.453, "synch_weights_time_ms": 87.176}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "bec7c_00000", "date": "2025-04-27_08-37-32", "timestamp": 1745743052, "time_this_iter_s": 18.76795244216919, "time_total_s": 39.2003173828125, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 39.2003173828125, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 52.8925925925926, "ram_util_percent": 12.274074074074074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.26969449481656477, "policy_loss": -0.020053409550699494, "vf_loss": 0.007761098271951214, "vf_explained_var": -0.0802548223926175, "kl": 0.0075620423358864295, "entropy": 25.89145997570407, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 775.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.01832905310303, "num_env_steps_trained_throughput_per_sec": 222.01832905310303, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 19067.642, "sample_time_ms": 15430.863, "load_time_ms": 343.72, "load_throughput": 11637.394, "learn_time_ms": 3218.455, "learn_throughput": 1242.833, "synch_weights_time_ms": 71.657}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "bec7c_00000", "date": "2025-04-27_08-37-50", "timestamp": 1745743070, "time_this_iter_s": 18.023032903671265, "time_total_s": 57.223350286483765, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 57.223350286483765, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 53.79599999999999, "ram_util_percent": 12.927999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.27622695542691694, "policy_loss": -0.023231758615903316, "vf_loss": 0.005476945774928261, "vf_explained_var": 0.06609929030941379, "kl": 0.006329827401162718, "entropy": 25.973811531066893, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 1085.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.93297109616964, "num_env_steps_trained_throughput_per_sec": 222.93297109616964, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 18786.377, "sample_time_ms": 15135.275, "load_time_ms": 382.497, "load_throughput": 10457.591, "learn_time_ms": 3201.366, "learn_throughput": 1249.466, "synch_weights_time_ms": 64.293}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "bec7c_00000", "date": "2025-04-27_08-38-08", "timestamp": 1745743088, "time_this_iter_s": 17.94924783706665, "time_total_s": 75.17259812355042, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 75.17259812355042, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.312000000000005, "ram_util_percent": 13.38}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.27437075258142524, "policy_loss": -0.02169711000376171, "vf_loss": 0.0056294259911913785, "vf_explained_var": -0.1032871590506646, "kl": 0.007488266761391705, "entropy": 25.980072685980026, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.74481977378665, "num_env_steps_trained_throughput_per_sec": 220.74481977378665, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 18653.19, "sample_time_ms": 15001.557, "load_time_ms": 406.55, "load_throughput": 9838.893, "learn_time_ms": 3182.256, "learn_throughput": 1256.97, "synch_weights_time_ms": 59.848}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "bec7c_00000", "date": "2025-04-27_08-38-26", "timestamp": 1745743106, "time_this_iter_s": 18.12756896018982, "time_total_s": 93.30016708374023, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 93.30016708374023, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 51.223076923076924, "ram_util_percent": 13.68846153846154}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.27601065959052873, "policy_loss": -0.021153801457295493, "vf_loss": 0.0043806276062593585, "vf_explained_var": 0.024037465164738318, "kl": 0.009034291004800351, "entropy": 26.104434868597217, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 1705.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.587499999999988, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507558389340872, "mean_inference_ms": 2.2843815200861113, "mean_action_processing_ms": 0.24894598005717902, "mean_env_wait_ms": 64.9259920523783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06798307100931804, "StateBufferConnector_ms": 0.006814797719319661, "ViewRequirementAgentConnector_ms": 0.15976428985595703}}, "episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.587499999999988, "episode_len_mean": 900.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507558389340872, "mean_inference_ms": 2.2843815200861113, "mean_action_processing_ms": 0.24894598005717902, "mean_env_wait_ms": 64.9259920523783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06798307100931804, "StateBufferConnector_ms": 0.006814797719319661, "ViewRequirementAgentConnector_ms": 0.15976428985595703}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.71498537384366, "num_env_steps_trained_throughput_per_sec": 218.71498537384366, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 18592.425, "sample_time_ms": 14916.132, "load_time_ms": 438.85, "load_throughput": 9114.741, "learn_time_ms": 3177.373, "learn_throughput": 1258.902, "synch_weights_time_ms": 57.085}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 6, "trial_id": "bec7c_00000", "date": "2025-04-27_08-38-45", "timestamp": 1745743125, "time_this_iter_s": 18.298920154571533, "time_total_s": 111.59908723831177, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 111.59908723831177, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 54.232, "ram_util_percent": 13.516000000000002}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.2739769931161596, "policy_loss": -0.016743153039245836, "vf_loss": 0.00364379208044885, "vf_explained_var": -0.004046118067156884, "kl": 0.0071616803830341184, "entropy": 26.230997368597215, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 2015.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.587499999999988, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507558389340872, "mean_inference_ms": 2.2843815200861113, "mean_action_processing_ms": 0.24894598005717902, "mean_env_wait_ms": 64.9259920523783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06798307100931804, "StateBufferConnector_ms": 0.006814797719319661, "ViewRequirementAgentConnector_ms": 0.15976428985595703}}, "episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.587499999999988, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507558389340872, "mean_inference_ms": 2.2843815200861113, "mean_action_processing_ms": 0.24894598005717902, "mean_env_wait_ms": 64.9259920523783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06798307100931804, "StateBufferConnector_ms": 0.006814797719319661, "ViewRequirementAgentConnector_ms": 0.15976428985595703}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.84542854325682, "num_env_steps_trained_throughput_per_sec": 218.84542854325682, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 18547.465, "sample_time_ms": 14864.786, "load_time_ms": 448.197, "load_throughput": 8924.657, "learn_time_ms": 3176.644, "learn_throughput": 1259.19, "synch_weights_time_ms": 54.831}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 24, "training_iteration": 7, "trial_id": "bec7c_00000", "date": "2025-04-27_08-39-03", "timestamp": 1745743143, "time_this_iter_s": 18.28484082221985, "time_total_s": 129.88392806053162, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 129.88392806053162, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 54.465384615384615, "ram_util_percent": 13.28846153846154}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.2811808864150437, "policy_loss": -0.02409440621493324, "vf_loss": 0.004339548773620458, "vf_explained_var": 0.0038986311804863716, "kl": 0.006338494363283263, "entropy": 26.269373339991414, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.587499999999988, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507558389340872, "mean_inference_ms": 2.2843815200861113, "mean_action_processing_ms": 0.24894598005717902, "mean_env_wait_ms": 64.9259920523783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06798307100931804, "StateBufferConnector_ms": 0.006814797719319661, "ViewRequirementAgentConnector_ms": 0.15976428985595703}}, "episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.587499999999988, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507558389340872, "mean_inference_ms": 2.2843815200861113, "mean_action_processing_ms": 0.24894598005717902, "mean_env_wait_ms": 64.9259920523783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06798307100931804, "StateBufferConnector_ms": 0.006814797719319661, "ViewRequirementAgentConnector_ms": 0.15976428985595703}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.73180271089666, "num_env_steps_trained_throughput_per_sec": 216.73180271089666, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 18536.027, "sample_time_ms": 14856.05, "load_time_ms": 455.756, "load_throughput": 8776.622, "learn_time_ms": 3167.605, "learn_throughput": 1262.784, "synch_weights_time_ms": 53.593}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 24, "training_iteration": 8, "trial_id": "bec7c_00000", "date": "2025-04-27_08-39-21", "timestamp": 1745743161, "time_this_iter_s": 18.464141845703125, "time_total_s": 148.34806990623474, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 148.34806990623474, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 54.03076923076923, "ram_util_percent": 13.48076923076923}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.2768762298409016, "policy_loss": -0.018687431406109564, "vf_loss": 0.004190969822188743, "vf_explained_var": 0.06831630968278454, "kl": 0.009321134289137027, "entropy": 26.424399825065368, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 2635.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.587499999999988, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507558389340872, "mean_inference_ms": 2.2843815200861113, "mean_action_processing_ms": 0.24894598005717902, "mean_env_wait_ms": 64.9259920523783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06798307100931804, "StateBufferConnector_ms": 0.006814797719319661, "ViewRequirementAgentConnector_ms": 0.15976428985595703}}, "episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.587499999999988, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.507558389340872, "mean_inference_ms": 2.2843815200861113, "mean_action_processing_ms": 0.24894598005717902, "mean_env_wait_ms": 64.9259920523783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06798307100931804, "StateBufferConnector_ms": 0.006814797719319661, "ViewRequirementAgentConnector_ms": 0.15976428985595703}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.89864005117803, "num_env_steps_trained_throughput_per_sec": 219.89864005117803, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 18497.598, "sample_time_ms": 14812.427, "load_time_ms": 460.755, "load_throughput": 8681.4, "learn_time_ms": 3169.153, "learn_throughput": 1262.167, "synch_weights_time_ms": 52.251}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 24, "training_iteration": 9, "trial_id": "bec7c_00000", "date": "2025-04-27_08-39-40", "timestamp": 1745743180, "time_this_iter_s": 18.196864366531372, "time_total_s": 166.5449342727661, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 166.5449342727661, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.163999999999994, "ram_util_percent": 13.588}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.2698374289658762, "policy_loss": -0.013057765271514653, "vf_loss": 0.005165990627691856, "vf_explained_var": -0.05039468734495101, "kl": 0.008905677861559375, "entropy": 26.37267931661298, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 2945.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.570279999999993, "episode_len_mean": 894.16, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5066981229481579, "mean_inference_ms": 2.2832498687721396, "mean_action_processing_ms": 0.24883856924607964, "mean_env_wait_ms": 64.9857134278555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06708049774169922, "StateBufferConnector_ms": 0.006815910339355469, "ViewRequirementAgentConnector_ms": 0.15938854217529297}}, "episode_reward_max": 18.879999999999914, "episode_reward_min": 15.57500000000003, "episode_reward_mean": 17.570279999999993, "episode_len_mean": 894.16, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5066981229481579, "mean_inference_ms": 2.2832498687721396, "mean_action_processing_ms": 0.24883856924607964, "mean_env_wait_ms": 64.9857134278555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06708049774169922, "StateBufferConnector_ms": 0.006815910339355469, "ViewRequirementAgentConnector_ms": 0.15938854217529297}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.50876605310143, "num_env_steps_trained_throughput_per_sec": 216.50876605310143, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 18495.335, "sample_time_ms": 14807.874, "load_time_ms": 464.934, "load_throughput": 8603.37, "learn_time_ms": 3167.813, "learn_throughput": 1262.701, "synch_weights_time_ms": 51.63}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 25, "training_iteration": 10, "trial_id": "bec7c_00000", "date": "2025-04-27_08-39-58", "timestamp": 1745743198, "time_this_iter_s": 18.482781410217285, "time_total_s": 185.0277156829834, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 185.0277156829834, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 52.25384615384615, "ram_util_percent": 13.64230769230769}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.285295347342523, "policy_loss": -0.026677739187594383, "vf_loss": 0.004168910886191072, "vf_explained_var": 0.18481344772923378, "kl": 0.007822271313111813, "entropy": 26.43509767593876, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}}, "episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.76708856495804, "num_env_steps_trained_throughput_per_sec": 212.76708856495804, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 18332.778, "sample_time_ms": 14657.699, "load_time_ms": 512.551, "load_throughput": 7804.101, "learn_time_ms": 3116.858, "learn_throughput": 1283.344, "synch_weights_time_ms": 42.557}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 48, "training_iteration": 11, "trial_id": "bec7c_00000", "date": "2025-04-27_08-40-17", "timestamp": 1745743217, "time_this_iter_s": 18.80781126022339, "time_total_s": 203.8355269432068, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 203.8355269432068, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 50.89629629629629, "ram_util_percent": 13.607407407407404}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.27449993880751034, "policy_loss": -0.019954060967410765, "vf_loss": 0.007739579654345664, "vf_explained_var": -0.10932584654900336, "kl": 0.011797984038989497, "entropy": 26.464506167750205, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 3565.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}}, "episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.71840784114704, "num_env_steps_trained_throughput_per_sec": 219.71840784114704, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 18277.188, "sample_time_ms": 14585.462, "load_time_ms": 520.826, "load_throughput": 7680.115, "learn_time_ms": 3125.339, "learn_throughput": 1279.861, "synch_weights_time_ms": 42.429}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 12, "trial_id": "bec7c_00000", "date": "2025-04-27_08-40-35", "timestamp": 1745743235, "time_this_iter_s": 18.21325397491455, "time_total_s": 222.04878091812134, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 222.04878091812134, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 55.532, "ram_util_percent": 13.503999999999998}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.27751385877509754, "policy_loss": -0.02579321287452213, "vf_loss": 0.009271837776947406, "vf_explained_var": -0.06471562923923616, "kl": 0.014771170382840454, "entropy": 26.39467216614754, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 3875.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}}, "episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.40092818509444, "num_env_steps_trained_throughput_per_sec": 210.40092818509444, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 18376.668, "sample_time_ms": 14672.602, "load_time_ms": 528.836, "load_throughput": 7563.779, "learn_time_ms": 3129.136, "learn_throughput": 1278.308, "synch_weights_time_ms": 42.932}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 48, "training_iteration": 13, "trial_id": "bec7c_00000", "date": "2025-04-27_08-40-54", "timestamp": 1745743254, "time_this_iter_s": 19.037659645080566, "time_total_s": 241.0864405632019, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 241.0864405632019, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 52.05925925925926, "ram_util_percent": 13.625925925925925}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.28177658559889684, "policy_loss": -0.031118595588111107, "vf_loss": 0.010443621346207839, "vf_explained_var": 0.007436725401109265, "kl": 0.014534087658619448, "entropy": 26.400843275746993, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}}, "episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.19684475183325, "num_env_steps_trained_throughput_per_sec": 212.19684475183325, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 18467.449, "sample_time_ms": 14764.968, "load_time_ms": 528.346, "load_throughput": 7570.8, "learn_time_ms": 3127.786, "learn_throughput": 1278.86, "synch_weights_time_ms": 43.166}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 48, "training_iteration": 14, "trial_id": "bec7c_00000", "date": "2025-04-27_08-41-13", "timestamp": 1745743273, "time_this_iter_s": 18.85817527770996, "time_total_s": 259.94461584091187, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 259.94461584091187, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 52.876923076923084, "ram_util_percent": 13.676923076923078}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.2853092528066613, "policy_loss": -0.03432736078337316, "vf_loss": 0.010000645797246703, "vf_explained_var": 0.04933403595801323, "kl": 0.01580348219882111, "entropy": 26.414323782151744, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 4495.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}}, "episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.460666666666658, "episode_len_mean": 896.9583333333334, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.49496193895199775, "mean_inference_ms": 2.2593885657144512, "mean_action_processing_ms": 0.24558258414537018, "mean_env_wait_ms": 65.03244422633867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0674515962600708, "StateBufferConnector_ms": 0.006592770417531331, "ViewRequirementAgentConnector_ms": 0.1599376400311788}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.69918121660768, "num_env_steps_trained_throughput_per_sec": 211.69918121660768, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 18544.875, "sample_time_ms": 14846.422, "load_time_ms": 529.387, "load_throughput": 7555.911, "learn_time_ms": 3122.409, "learn_throughput": 1281.062, "synch_weights_time_ms": 43.472}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 48, "training_iteration": 15, "trial_id": "bec7c_00000", "date": "2025-04-27_08-41-32", "timestamp": 1745743292, "time_this_iter_s": 18.901799201965332, "time_total_s": 278.8464150428772, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 278.8464150428772, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 51.3, "ram_util_percent": 13.692592592592591}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3011697470540962, "policy_loss": -0.04898029683578399, "vf_loss": 0.00854830386955831, "vf_explained_var": 0.2454199981304907, "kl": 0.0151604937282466, "entropy": 26.37698587602185, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 4805.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.462897959183664, "episode_len_mean": 897.0204081632653, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4948207945663504, "mean_inference_ms": 2.259241216164348, "mean_action_processing_ms": 0.245558613693341, "mean_env_wait_ms": 65.04840486482878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06699659386459662, "StateBufferConnector_ms": 0.006590084153778699, "ViewRequirementAgentConnector_ms": 0.1597375285868742}}, "episode_reward_max": 19.004999999999917, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.462897959183664, "episode_len_mean": 897.0204081632653, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4948207945663504, "mean_inference_ms": 2.259241216164348, "mean_action_processing_ms": 0.245558613693341, "mean_env_wait_ms": 65.04840486482878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06699659386459662, "StateBufferConnector_ms": 0.006590084153778699, "ViewRequirementAgentConnector_ms": 0.1597375285868742}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.05602560116606, "num_env_steps_trained_throughput_per_sec": 218.05602560116606, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 18550.402, "sample_time_ms": 14864.579, "load_time_ms": 519.013, "load_throughput": 7706.935, "learn_time_ms": 3120.473, "learn_throughput": 1281.857, "synch_weights_time_ms": 43.146}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 49, "training_iteration": 16, "trial_id": "bec7c_00000", "date": "2025-04-27_08-41-51", "timestamp": 1745743311, "time_this_iter_s": 18.351114511489868, "time_total_s": 297.19752955436707, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 297.19752955436707, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 53.19615384615386, "ram_util_percent": 13.426923076923078}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.30379087716310976, "policy_loss": -0.051303869089291944, "vf_loss": 0.009520166365420605, "vf_explained_var": 0.4084019384076518, "kl": 0.011975340476407925, "entropy": 26.440224985922537, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.95398611111107, "episode_len_mean": 897.9722222222222, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4885623133401567, "mean_inference_ms": 2.2456033124530075, "mean_action_processing_ms": 0.2436551288116197, "mean_env_wait_ms": 65.11623440852713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06709429952833387, "StateBufferConnector_ms": 0.006591942575242784, "ViewRequirementAgentConnector_ms": 0.15883313284979927}}, "episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.95398611111107, "episode_len_mean": 897.9722222222222, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4885623133401567, "mean_inference_ms": 2.2456033124530075, "mean_action_processing_ms": 0.2436551288116197, "mean_env_wait_ms": 65.11623440852713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06709429952833387, "StateBufferConnector_ms": 0.006591942575242784, "ViewRequirementAgentConnector_ms": 0.15883313284979927}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.92729618191797, "num_env_steps_trained_throughput_per_sec": 220.92729618191797, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 18533.179, "sample_time_ms": 14842.645, "load_time_ms": 527.899, "load_throughput": 7577.212, "learn_time_ms": 3116.232, "learn_throughput": 1283.602, "synch_weights_time_ms": 43.223}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 72, "training_iteration": 17, "trial_id": "bec7c_00000", "date": "2025-04-27_08-42-09", "timestamp": 1745743329, "time_this_iter_s": 18.113832473754883, "time_total_s": 315.31136202812195, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 315.31136202812195, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 55.452, "ram_util_percent": 13.3}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.30477354170101123, "policy_loss": -0.06069213180171867, "vf_loss": 0.01764255834236352, "vf_explained_var": 0.16972107310448922, "kl": 0.010066190506181408, "entropy": 26.373721534975115, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 5425.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.95398611111107, "episode_len_mean": 897.9722222222222, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4885623133401567, "mean_inference_ms": 2.2456033124530075, "mean_action_processing_ms": 0.2436551288116197, "mean_env_wait_ms": 65.11623440852713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06709429952833387, "StateBufferConnector_ms": 0.006591942575242784, "ViewRequirementAgentConnector_ms": 0.15883313284979927}}, "episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.95398611111107, "episode_len_mean": 897.9722222222222, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4885623133401567, "mean_inference_ms": 2.2456033124530075, "mean_action_processing_ms": 0.2436551288116197, "mean_env_wait_ms": 65.11623440852713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06709429952833387, "StateBufferConnector_ms": 0.006591942575242784, "ViewRequirementAgentConnector_ms": 0.15883313284979927}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.70292672928827, "num_env_steps_trained_throughput_per_sec": 216.70292672928827, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 18533.425, "sample_time_ms": 14855.567, "load_time_ms": 526.963, "load_throughput": 7590.667, "learn_time_ms": 3104.498, "learn_throughput": 1288.453, "synch_weights_time_ms": 43.203}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 18, "trial_id": "bec7c_00000", "date": "2025-04-27_08-42-27", "timestamp": 1745743347, "time_this_iter_s": 18.46615171432495, "time_total_s": 333.7775137424469, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 333.7775137424469, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 56.31923076923077, "ram_util_percent": 13.415384615384614}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3230942131808749, "policy_loss": -0.07037589851196015, "vf_loss": 0.010512934699457424, "vf_explained_var": 0.2823845482641651, "kl": 0.008042473202699659, "entropy": 26.48397477672946, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 5735.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.95398611111107, "episode_len_mean": 897.9722222222222, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4885623133401567, "mean_inference_ms": 2.2456033124530075, "mean_action_processing_ms": 0.2436551288116197, "mean_env_wait_ms": 65.11623440852713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06709429952833387, "StateBufferConnector_ms": 0.006591942575242784, "ViewRequirementAgentConnector_ms": 0.15883313284979927}}, "episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.95398611111107, "episode_len_mean": 897.9722222222222, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4885623133401567, "mean_inference_ms": 2.2456033124530075, "mean_action_processing_ms": 0.2436551288116197, "mean_env_wait_ms": 65.11623440852713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06709429952833387, "StateBufferConnector_ms": 0.006591942575242784, "ViewRequirementAgentConnector_ms": 0.15883313284979927}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.71504809717715, "num_env_steps_trained_throughput_per_sec": 213.71504809717715, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 18586.056, "sample_time_ms": 14914.794, "load_time_ms": 526.093, "load_throughput": 7603.223, "learn_time_ms": 3098.007, "learn_throughput": 1291.153, "synch_weights_time_ms": 43.94}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 72, "training_iteration": 19, "trial_id": "bec7c_00000", "date": "2025-04-27_08-42-46", "timestamp": 1745743366, "time_this_iter_s": 18.72490930557251, "time_total_s": 352.5024230480194, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 352.5024230480194, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 54.41923076923077, "ram_util_percent": 13.553846153846154}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3043152849572981, "policy_loss": -0.06173808611929417, "vf_loss": 0.01975700357495131, "vf_explained_var": 0.2475658284079644, "kl": 0.00849163075974737, "entropy": 26.403253549145113, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.95398611111107, "episode_len_mean": 897.9722222222222, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4885623133401567, "mean_inference_ms": 2.2456033124530075, "mean_action_processing_ms": 0.2436551288116197, "mean_env_wait_ms": 65.11623440852713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06709429952833387, "StateBufferConnector_ms": 0.006591942575242784, "ViewRequirementAgentConnector_ms": 0.15883313284979927}}, "episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.95398611111107, "episode_len_mean": 897.9722222222222, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4885623133401567, "mean_inference_ms": 2.2456033124530075, "mean_action_processing_ms": 0.2436551288116197, "mean_env_wait_ms": 65.11623440852713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06709429952833387, "StateBufferConnector_ms": 0.006591942575242784, "ViewRequirementAgentConnector_ms": 0.15883313284979927}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.86069713942024, "num_env_steps_trained_throughput_per_sec": 213.86069713942024, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 18608.932, "sample_time_ms": 14951.33, "load_time_ms": 525.698, "load_throughput": 7608.934, "learn_time_ms": 3085.179, "learn_throughput": 1296.521, "synch_weights_time_ms": 43.562}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 72, "training_iteration": 20, "trial_id": "bec7c_00000", "date": "2025-04-27_08-43-05", "timestamp": 1745743385, "time_this_iter_s": 18.71222233772278, "time_total_s": 371.2146453857422, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 371.2146453857422, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 53.14999999999999, "ram_util_percent": 13.580769230769231}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.31825014461477796, "policy_loss": -0.0691055255912004, "vf_loss": 0.012487750597375129, "vf_explained_var": 0.41930629437969574, "kl": 0.008828607499245047, "entropy": 26.339809528473886, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 6355.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.020506849315026, "episode_len_mean": 898.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4884408002872417, "mean_inference_ms": 2.245442843941206, "mean_action_processing_ms": 0.2436389630086441, "mean_env_wait_ms": 65.14455332853119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06681925629916256, "StateBufferConnector_ms": 0.006592437012554848, "ViewRequirementAgentConnector_ms": 0.15887005688392952}}, "episode_reward_max": 36.15499999999937, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.020506849315026, "episode_len_mean": 898.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4884408002872417, "mean_inference_ms": 2.245442843941206, "mean_action_processing_ms": 0.2436389630086441, "mean_env_wait_ms": 65.14455332853119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06681925629916256, "StateBufferConnector_ms": 0.006592437012554848, "ViewRequirementAgentConnector_ms": 0.15887005688392952}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.92111068221615, "num_env_steps_trained_throughput_per_sec": 211.92111068221615, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 18616.437, "sample_time_ms": 14950.307, "load_time_ms": 525.595, "load_throughput": 7610.422, "learn_time_ms": 3093.589, "learn_throughput": 1292.996, "synch_weights_time_ms": 43.799}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 73, "training_iteration": 21, "trial_id": "bec7c_00000", "date": "2025-04-27_08-43-24", "timestamp": 1745743404, "time_this_iter_s": 18.88245153427124, "time_total_s": 390.0970969200134, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 390.0970969200134, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 52.24615384615385, "ram_util_percent": 13.538461538461538}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3136906175483619, "policy_loss": -0.06192131024755297, "vf_loss": 0.00964677410229342, "vf_explained_var": 0.6805734328685268, "kl": 0.00843135861211817, "entropy": 26.310235577244914, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 6665.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}}, "episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.71525536407844, "num_env_steps_trained_throughput_per_sec": 214.71525536407844, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 18658.858, "sample_time_ms": 14985.514, "load_time_ms": 515.668, "load_throughput": 7756.936, "learn_time_ms": 3109.843, "learn_throughput": 1286.239, "synch_weights_time_ms": 44.684}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 96, "training_iteration": 22, "trial_id": "bec7c_00000", "date": "2025-04-27_08-43-42", "timestamp": 1745743422, "time_this_iter_s": 18.638253688812256, "time_total_s": 408.7353506088257, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 408.7353506088257, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 55.27307692307692, "ram_util_percent": 13.415384615384616}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3209388728148394, "policy_loss": -0.07529152949010172, "vf_loss": 0.016000456863126133, "vf_explained_var": 0.3061950918166868, "kl": 0.007448053757317684, "entropy": 26.31374133940666, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}}, "episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.2191872510105, "num_env_steps_trained_throughput_per_sec": 186.2191872510105, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 18905.731, "sample_time_ms": 15234.37, "load_time_ms": 507.178, "load_throughput": 7886.773, "learn_time_ms": 3115.978, "learn_throughput": 1283.706, "synch_weights_time_ms": 45.071}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 96, "training_iteration": 23, "trial_id": "bec7c_00000", "date": "2025-04-27_08-44-04", "timestamp": 1745743444, "time_this_iter_s": 21.489803075790405, "time_total_s": 430.2251536846161, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 430.2251536846161, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 64.58, "ram_util_percent": 15.596666666666668}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3183633686967134, "policy_loss": -0.0718651267549684, "vf_loss": 0.014895137718016368, "vf_explained_var": 0.49047822260087537, "kl": 0.006943300586364433, "entropy": 26.278204314939437, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 7285.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}}, "episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.6095740143993, "num_env_steps_trained_throughput_per_sec": 206.6095740143993, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 18956.708, "sample_time_ms": 15293.639, "load_time_ms": 507.138, "load_throughput": 7887.407, "learn_time_ms": 3107.115, "learn_throughput": 1287.368, "synch_weights_time_ms": 45.689}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 24, "trial_id": "bec7c_00000", "date": "2025-04-27_08-44-23", "timestamp": 1745743463, "time_this_iter_s": 19.368667125701904, "time_total_s": 449.593820810318, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 449.593820810318, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 55.7962962962963, "ram_util_percent": 14.77777777777778}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3083687331835409, "policy_loss": -0.05986198844508298, "vf_loss": 0.012569031561953683, "vf_explained_var": 0.42231689787680105, "kl": 0.006631844806014992, "entropy": 26.24021488312752, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 7595.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}}, "episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.3057414933008, "num_env_steps_trained_throughput_per_sec": 214.3057414933008, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 18933.727, "sample_time_ms": 15266.357, "load_time_ms": 514.016, "load_throughput": 7781.861, "learn_time_ms": 3104.908, "learn_throughput": 1288.283, "synch_weights_time_ms": 45.349}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 96, "training_iteration": 25, "trial_id": "bec7c_00000", "date": "2025-04-27_08-44-42", "timestamp": 1745743482, "time_this_iter_s": 18.672972202301025, "time_total_s": 468.266793012619, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 468.266793012619, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 52.26153846153845, "ram_util_percent": 13.411538461538461}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3286127254659791, "policy_loss": -0.07828934003689116, "vf_loss": 0.010329923778713676, "vf_explained_var": 0.4586195853448683, "kl": 0.006235000731642011, "entropy": 26.19003135927262, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}}, "episode_reward_max": 41.519999999999236, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.084552083333264, "episode_len_mean": 898.4791666666666, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.825000000000124, 17.744999999999973, 17.539999999999992, 18.284999999999943, 17.834999999999987, 18.399999999999924, 18.129999999999967, 16.76000000000005, 18.3249999999999, 16.855000000000043, 18.48499999999993, 18.66499999999996, 17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4847227860291039, "mean_inference_ms": 2.238865923888003, "mean_action_processing_ms": 0.24254890597865186, "mean_env_wait_ms": 65.16923645033201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06690273682276408, "StateBufferConnector_ms": 0.006535400946935018, "ViewRequirementAgentConnector_ms": 0.1581492523352305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.40733822266102, "num_env_steps_trained_throughput_per_sec": 212.40733822266102, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 18982.511, "sample_time_ms": 15313.525, "load_time_ms": 513.724, "load_throughput": 7786.277, "learn_time_ms": 3106.326, "learn_throughput": 1287.695, "synch_weights_time_ms": 45.841}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 96, "training_iteration": 26, "trial_id": "bec7c_00000", "date": "2025-04-27_08-45-01", "timestamp": 1745743501, "time_this_iter_s": 18.84009623527527, "time_total_s": 487.1068892478943, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 487.1068892478943, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 52.51538461538461, "ram_util_percent": 13.534615384615384}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.317730315202742, "policy_loss": -0.07272495477790794, "vf_loss": 0.015274192489619788, "vf_explained_var": 0.5739920168153702, "kl": 0.006767157849613033, "entropy": 26.163299142160724, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 8215.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.095419999999912, "episode_len_mean": 898.54, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48078729818462823, "mean_inference_ms": 2.234848154507309, "mean_action_processing_ms": 0.2411487401820149, "mean_env_wait_ms": 65.22299652813663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06615471839904785, "StateBufferConnector_ms": 0.006422281265258789, "ViewRequirementAgentConnector_ms": 0.15607333183288574}}, "episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.095419999999912, "episode_len_mean": 898.54, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.98499999999997, 17.51500000000001, 15.57500000000003, 18.879999999999914, 17.08500000000001, 17.609999999999975, 17.954999999999973, 17.849999999999984, 17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.48078729818462823, "mean_inference_ms": 2.234848154507309, "mean_action_processing_ms": 0.2411487401820149, "mean_env_wait_ms": 65.22299652813663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06615471839904785, "StateBufferConnector_ms": 0.006422281265258789, "ViewRequirementAgentConnector_ms": 0.15607333183288574}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.39285373554378, "num_env_steps_trained_throughput_per_sec": 205.39285373554378, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 19119.448, "sample_time_ms": 15462.171, "load_time_ms": 503.825, "load_throughput": 7939.259, "learn_time_ms": 3104.568, "learn_throughput": 1288.424, "synch_weights_time_ms": 45.772}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 112, "training_iteration": 27, "trial_id": "bec7c_00000", "date": "2025-04-27_08-45-20", "timestamp": 1745743520, "time_this_iter_s": 19.483667850494385, "time_total_s": 506.5905570983887, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 506.5905570983887, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 52.277777777777786, "ram_util_percent": 13.585185185185184}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3115027856611226, "policy_loss": -0.0726958079263568, "vf_loss": 0.02235395123452397, "vf_explained_var": 0.5206049109658887, "kl": 0.006506373858311206, "entropy": 26.246221087055822, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 8525.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1683699999999, "episode_len_mean": 898.54, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826], "episode_lengths": [900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47802865758990365, "mean_inference_ms": 2.231045249002978, "mean_action_processing_ms": 0.2406756704618796, "mean_env_wait_ms": 65.34292159948639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06635689735412598, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.15590548515319824}}, "episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1683699999999, "episode_len_mean": 898.54, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826], "episode_lengths": [900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47802865758990365, "mean_inference_ms": 2.231045249002978, "mean_action_processing_ms": 0.2406756704618796, "mean_env_wait_ms": 65.34292159948639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06635689735412598, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.15590548515319824}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.9150431621512, "num_env_steps_trained_throughput_per_sec": 220.9150431621512, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 19084.254, "sample_time_ms": 15397.83, "load_time_ms": 511.283, "load_throughput": 7823.455, "learn_time_ms": 3118.62, "learn_throughput": 1282.619, "synch_weights_time_ms": 53.439}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 120, "training_iteration": 28, "trial_id": "bec7c_00000", "date": "2025-04-27_08-45-38", "timestamp": 1745743538, "time_this_iter_s": 18.116889476776123, "time_total_s": 524.7074465751648, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 524.7074465751648, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 56.10799999999999, "ram_util_percent": 13.68}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3160291105582033, "policy_loss": -0.07003738614580324, "vf_loss": 0.015489787721807877, "vf_explained_var": 0.5483977373569242, "kl": 0.006519382539960545, "entropy": 26.278539608370874, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1683699999999, "episode_len_mean": 898.54, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826], "episode_lengths": [900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47802865758990365, "mean_inference_ms": 2.231045249002978, "mean_action_processing_ms": 0.2406756704618796, "mean_env_wait_ms": 65.34292159948639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06635689735412598, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.15590548515319824}}, "episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1683699999999, "episode_len_mean": 898.54, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826], "episode_lengths": [900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47802865758990365, "mean_inference_ms": 2.231045249002978, "mean_action_processing_ms": 0.2406756704618796, "mean_env_wait_ms": 65.34292159948639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06635689735412598, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.15590548515319824}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.19093268870628, "num_env_steps_trained_throughput_per_sec": 208.19093268870628, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 19133.916, "sample_time_ms": 15457.256, "load_time_ms": 511.039, "load_throughput": 7827.195, "learn_time_ms": 3109.94, "learn_throughput": 1286.198, "synch_weights_time_ms": 52.626}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 120, "training_iteration": 29, "trial_id": "bec7c_00000", "date": "2025-04-27_08-45-58", "timestamp": 1745743558, "time_this_iter_s": 19.220818996429443, "time_total_s": 543.9282655715942, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 543.9282655715942, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 53.470370370370375, "ram_util_percent": 13.807407407407409}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.32080111740487477, "policy_loss": -0.07073169657509894, "vf_loss": 0.011446744946290216, "vf_explained_var": 0.5154113169639342, "kl": 0.0057240619523063, "entropy": 26.266098570054577, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 9145.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1683699999999, "episode_len_mean": 898.54, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826], "episode_lengths": [900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47802865758990365, "mean_inference_ms": 2.231045249002978, "mean_action_processing_ms": 0.2406756704618796, "mean_env_wait_ms": 65.34292159948639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06635689735412598, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.15590548515319824}}, "episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1683699999999, "episode_len_mean": 898.54, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826], "episode_lengths": [900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47802865758990365, "mean_inference_ms": 2.231045249002978, "mean_action_processing_ms": 0.2406756704618796, "mean_env_wait_ms": 65.34292159948639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06635689735412598, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.15590548515319824}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.10774456481965, "num_env_steps_trained_throughput_per_sec": 208.10774456481965, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 19185.621, "sample_time_ms": 15498.844, "load_time_ms": 510.844, "load_throughput": 7830.176, "learn_time_ms": 3120.447, "learn_throughput": 1281.868, "synch_weights_time_ms": 52.448}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 120, "training_iteration": 30, "trial_id": "bec7c_00000", "date": "2025-04-27_08-46-17", "timestamp": 1745743577, "time_this_iter_s": 19.229166746139526, "time_total_s": 563.1574323177338, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 563.1574323177338, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 52.51851851851852, "ram_util_percent": 13.755555555555555}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3204450184434292, "policy_loss": -0.06690207255343275, "vf_loss": 0.008009128315948586, "vf_explained_var": 0.6224626612278723, "kl": 0.006057240367250239, "entropy": 26.27635267319218, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 9455.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1683699999999, "episode_len_mean": 898.54, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826], "episode_lengths": [900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47802865758990365, "mean_inference_ms": 2.231045249002978, "mean_action_processing_ms": 0.2406756704618796, "mean_env_wait_ms": 65.34292159948639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06635689735412598, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.15590548515319824}}, "episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1683699999999, "episode_len_mean": 898.54, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.63999999999999, 16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826], "episode_lengths": [900, 900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47802865758990365, "mean_inference_ms": 2.231045249002978, "mean_action_processing_ms": 0.2406756704618796, "mean_env_wait_ms": 65.34292159948639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06635689735412598, "StateBufferConnector_ms": 0.00640869140625, "ViewRequirementAgentConnector_ms": 0.15590548515319824}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.6974193550688, "num_env_steps_trained_throughput_per_sec": 213.6974193550688, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 19169.932, "sample_time_ms": 15478.229, "load_time_ms": 511.573, "load_throughput": 7819.019, "learn_time_ms": 3124.599, "learn_throughput": 1280.164, "synch_weights_time_ms": 52.469}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 120, "training_iteration": 31, "trial_id": "bec7c_00000", "date": "2025-04-27_08-46-36", "timestamp": 1745743596, "time_this_iter_s": 18.725751638412476, "time_total_s": 581.8831839561462, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 581.8831839561462, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 53.23846153846155, "ram_util_percent": 13.734615384615385}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.19999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.320342760178591, "policy_loss": -0.06434931332666066, "vf_loss": 0.005315812483941925, "vf_explained_var": 0.6246575717003114, "kl": 0.004532918154285242, "entropy": 26.22158505839686, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1385699999999, "episode_len_mean": 898.54, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824], "episode_lengths": [900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47743131516737347, "mean_inference_ms": 2.2295364357973084, "mean_action_processing_ms": 0.24065292038748345, "mean_env_wait_ms": 65.32644902944683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06619763374328613, "StateBufferConnector_ms": 0.0064127445220947266, "ViewRequirementAgentConnector_ms": 0.15595364570617676}}, "episode_reward_max": 43.22500000000001, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.1385699999999, "episode_len_mean": 898.54, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.09000000000012, 17.304999999999986, 17.75999999999999, 17.157000000000103, 16.55500000000007, 17.989999999999966, 17.434999999999995, 17.045000000000027, 18.319999999999926, 18.76999999999994, 19.004999999999917, 18.034999999999965, 17.479999999999997, 16.185000000000013, 16.295000000000094, 16.775000000000045, 17.365, 17.45500000000002, 15.640000000000095, 18.464999999999947, 17.589999999999986, 17.959999999999983, 18.67999999999992, 16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824], "episode_lengths": [900, 900, 900, 754, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47743131516737347, "mean_inference_ms": 2.2295364357973084, "mean_action_processing_ms": 0.24065292038748345, "mean_env_wait_ms": 65.32644902944683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06619763374328613, "StateBufferConnector_ms": 0.0064127445220947266, "ViewRequirementAgentConnector_ms": 0.15595364570617676}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.27120437538952, "num_env_steps_trained_throughput_per_sec": 210.27120437538952, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 19209.305, "sample_time_ms": 15541.877, "load_time_ms": 511.656, "load_throughput": 7817.747, "learn_time_ms": 3101.192, "learn_throughput": 1289.827, "synch_weights_time_ms": 51.547}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 121, "training_iteration": 32, "trial_id": "bec7c_00000", "date": "2025-04-27_08-46-55", "timestamp": 1745743615, "time_this_iter_s": 19.03125309944153, "time_total_s": 600.9144370555878, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 600.9144370555878, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 52.92222222222223, "ram_util_percent": 13.548148148148151}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3061649106022331, "policy_loss": -0.07468345511043745, "vf_loss": 0.03129559774892949, "vf_explained_var": 0.8696117233845495, "kl": 0.008729508270566693, "entropy": 26.365000534057618, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 10075.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.10284999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47498069505468343, "mean_inference_ms": 2.231549348644899, "mean_action_processing_ms": 0.23995182396244552, "mean_env_wait_ms": 65.5804142506486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06629228591918945, "StateBufferConnector_ms": 0.0063915252685546875, "ViewRequirementAgentConnector_ms": 0.15455937385559082}}, "episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.10284999999984, "episode_len_mean": 900.0, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47498069505468343, "mean_inference_ms": 2.231549348644899, "mean_action_processing_ms": 0.23995182396244552, "mean_env_wait_ms": 65.5804142506486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06629228591918945, "StateBufferConnector_ms": 0.0063915252685546875, "ViewRequirementAgentConnector_ms": 0.15455937385559082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.32827322578007, "num_env_steps_trained_throughput_per_sec": 219.32827322578007, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 18885.048, "sample_time_ms": 15221.67, "load_time_ms": 511.276, "load_throughput": 7823.56, "learn_time_ms": 3098.372, "learn_throughput": 1291.001, "synch_weights_time_ms": 50.668}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 144, "training_iteration": 33, "trial_id": "bec7c_00000", "date": "2025-04-27_08-47-13", "timestamp": 1745743633, "time_this_iter_s": 18.24609875679016, "time_total_s": 619.1605358123779, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 619.1605358123779, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 54.00384615384616, "ram_util_percent": 13.480769230769228}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.26470548342725625, "policy_loss": -0.08185340400424695, "vf_loss": 0.0807585250631218, "vf_explained_var": 0.47844762282986797, "kl": 0.009949450293788686, "entropy": 26.4605560733426, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 10385.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.10284999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47498069505468343, "mean_inference_ms": 2.231549348644899, "mean_action_processing_ms": 0.23995182396244552, "mean_env_wait_ms": 65.5804142506486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06629228591918945, "StateBufferConnector_ms": 0.0063915252685546875, "ViewRequirementAgentConnector_ms": 0.15455937385559082}}, "episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.10284999999984, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47498069505468343, "mean_inference_ms": 2.231549348644899, "mean_action_processing_ms": 0.23995182396244552, "mean_env_wait_ms": 65.5804142506486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06629228591918945, "StateBufferConnector_ms": 0.0063915252685546875, "ViewRequirementAgentConnector_ms": 0.15455937385559082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.4676824827944, "num_env_steps_trained_throughput_per_sec": 208.4676824827944, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 18867.792, "sample_time_ms": 15188.645, "load_time_ms": 519.622, "load_throughput": 7697.907, "learn_time_ms": 3106.438, "learn_throughput": 1287.648, "synch_weights_time_ms": 50.025}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 144, "training_iteration": 34, "trial_id": "bec7c_00000", "date": "2025-04-27_08-47-32", "timestamp": 1745743652, "time_this_iter_s": 19.196255207061768, "time_total_s": 638.3567910194397, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 638.3567910194397, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 53.8962962962963, "ram_util_percent": 13.570370370370371}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.27474508901735045, "policy_loss": -0.07189080915864438, "vf_loss": 0.06281519880594127, "vf_explained_var": 0.44478139550455154, "kl": 0.007716450356266221, "entropy": 26.64411307304136, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.10284999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47498069505468343, "mean_inference_ms": 2.231549348644899, "mean_action_processing_ms": 0.23995182396244552, "mean_env_wait_ms": 65.5804142506486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06629228591918945, "StateBufferConnector_ms": 0.0063915252685546875, "ViewRequirementAgentConnector_ms": 0.15455937385559082}}, "episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.10284999999984, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47498069505468343, "mean_inference_ms": 2.231549348644899, "mean_action_processing_ms": 0.23995182396244552, "mean_env_wait_ms": 65.5804142506486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06629228591918945, "StateBufferConnector_ms": 0.0063915252685546875, "ViewRequirementAgentConnector_ms": 0.15455937385559082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.50411077583257, "num_env_steps_trained_throughput_per_sec": 199.50411077583257, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 19006.271, "sample_time_ms": 15313.758, "load_time_ms": 519.52, "load_throughput": 7699.421, "learn_time_ms": 3119.053, "learn_throughput": 1282.441, "synch_weights_time_ms": 50.842}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 144, "training_iteration": 35, "trial_id": "bec7c_00000", "date": "2025-04-27_08-47-52", "timestamp": 1745743672, "time_this_iter_s": 20.05789017677307, "time_total_s": 658.4146811962128, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 658.4146811962128, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 50.57142857142856, "ram_util_percent": 13.55}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3820905940307702, "policy_loss": -0.12093076448767416, "vf_loss": 0.0049836590973251485, "vf_explained_var": 0.584214497189368, "kl": 0.005025264556365249, "entropy": 26.664601965873473, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 11005.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.10284999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47498069505468343, "mean_inference_ms": 2.231549348644899, "mean_action_processing_ms": 0.23995182396244552, "mean_env_wait_ms": 65.5804142506486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06629228591918945, "StateBufferConnector_ms": 0.0063915252685546875, "ViewRequirementAgentConnector_ms": 0.15455937385559082}}, "episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.10284999999984, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.52500000000007, 17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47498069505468343, "mean_inference_ms": 2.231549348644899, "mean_action_processing_ms": 0.23995182396244552, "mean_env_wait_ms": 65.5804142506486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06629228591918945, "StateBufferConnector_ms": 0.0063915252685546875, "ViewRequirementAgentConnector_ms": 0.15455937385559082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.94485292069865, "num_env_steps_trained_throughput_per_sec": 210.94485292069865, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 19019.327, "sample_time_ms": 15329.424, "load_time_ms": 518.668, "load_throughput": 7712.065, "learn_time_ms": 3117.58, "learn_throughput": 1283.046, "synch_weights_time_ms": 50.556}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 36, "trial_id": "bec7c_00000", "date": "2025-04-27_08-48-11", "timestamp": 1745743691, "time_this_iter_s": 18.96996545791626, "time_total_s": 677.384646654129, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 677.384646654129, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 50.407407407407405, "ram_util_percent": 13.599999999999998}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.09999999999999999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4015215678320777, "policy_loss": -0.13866226687246272, "vf_loss": 0.004318371172197541, "vf_explained_var": 0.6582557159085427, "kl": 0.003102290494092402, "entropy": 26.74879040871897, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 11315.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.07789999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47467303002400746, "mean_inference_ms": 2.2307371719682343, "mean_action_processing_ms": 0.23996467446679204, "mean_env_wait_ms": 65.56673945490033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06613659858703613, "StateBufferConnector_ms": 0.00639796257019043, "ViewRequirementAgentConnector_ms": 0.15454578399658203}}, "episode_reward_max": 45.174999999999145, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.07789999999984, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.60999999999999, 13.94999999999983, 17.724999999999927, 17.569999999999993, 36.15499999999937, 17.19499999999999, 17.650000000000038, 18.11999999999997, 16.740000000000048, 18.71499999999988, 15.03, 18.34499999999995, 17.939999999999976, 17.275, 16.834999999999955, 14.464999999999792, 15.269999999999762, 20.689999999999838, 18.23499999999995, 16.195000000000107, 17.789999999999985, 18.264999999999954, 26.059999999999658, 18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47467303002400746, "mean_inference_ms": 2.2307371719682343, "mean_action_processing_ms": 0.23996467446679204, "mean_env_wait_ms": 65.56673945490033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06613659858703613, "StateBufferConnector_ms": 0.00639796257019043, "ViewRequirementAgentConnector_ms": 0.15454578399658203}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.52138281248446, "num_env_steps_trained_throughput_per_sec": 212.52138281248446, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 18954.003, "sample_time_ms": 15259.126, "load_time_ms": 518.269, "load_throughput": 7718.0, "learn_time_ms": 3122.918, "learn_throughput": 1280.854, "synch_weights_time_ms": 50.626}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 145, "training_iteration": 37, "trial_id": "bec7c_00000", "date": "2025-04-27_08-48-30", "timestamp": 1745743710, "time_this_iter_s": 18.829965591430664, "time_total_s": 696.2146122455597, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 696.2146122455597, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 51.98076923076923, "ram_util_percent": 13.692307692307692}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.049999999999999996, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.35214326062329837, "policy_loss": -0.08917285551827761, "vf_loss": 0.005175690490737437, "vf_explained_var": 0.7499045943060229, "kl": 0.003650832034562031, "entropy": 26.832864059940462, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.49362892541453, "num_env_steps_trained_throughput_per_sec": 213.49362892541453, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 19016.944, "sample_time_ms": 15347.53, "load_time_ms": 509.389, "load_throughput": 7852.539, "learn_time_ms": 3114.079, "learn_throughput": 1284.489, "synch_weights_time_ms": 42.866}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 168, "training_iteration": 38, "trial_id": "bec7c_00000", "date": "2025-04-27_08-48-49", "timestamp": 1745743729, "time_this_iter_s": 18.745412588119507, "time_total_s": 714.9600248336792, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 714.9600248336792, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 50.74074074074073, "ram_util_percent": 13.718518518518518}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3368733711841126, "policy_loss": -0.07826322452916253, "vf_loss": 0.009318575950237573, "vf_explained_var": 0.5636544956314948, "kl": 0.006140024248346773, "entropy": 26.808222942967568, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 11935.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.40029398416775, "num_env_steps_trained_throughput_per_sec": 214.40029398416775, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 18961.3, "sample_time_ms": 15278.449, "load_time_ms": 509.474, "load_throughput": 7851.231, "learn_time_ms": 3127.393, "learn_throughput": 1279.021, "synch_weights_time_ms": 42.891}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 168, "training_iteration": 39, "trial_id": "bec7c_00000", "date": "2025-04-27_08-49-08", "timestamp": 1745743748, "time_this_iter_s": 18.665040493011475, "time_total_s": 733.6250653266907, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 733.6250653266907, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 55.43461538461539, "ram_util_percent": 13.765384615384617}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.33350124401359577, "policy_loss": -0.07080794556006309, "vf_loss": 0.007254106663481986, "vf_explained_var": 0.5282413146188182, "kl": 0.005373718976331856, "entropy": 27.00817540076471, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 12245.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.02936893843682, "num_env_steps_trained_throughput_per_sec": 202.02936893843682, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 19019.129, "sample_time_ms": 15337.606, "load_time_ms": 508.374, "load_throughput": 7868.226, "learn_time_ms": 3127.14, "learn_throughput": 1279.124, "synch_weights_time_ms": 42.911}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 168, "training_iteration": 40, "trial_id": "bec7c_00000", "date": "2025-04-27_08-49-27", "timestamp": 1745743767, "time_this_iter_s": 19.807008504867554, "time_total_s": 753.4320738315582, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 753.4320738315582, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 51.574999999999996, "ram_util_percent": 13.778571428571427}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3156351600878782, "policy_loss": -0.047470033559347355, "vf_loss": 0.0029583260562973126, "vf_explained_var": 0.7286824116783758, "kl": 0.006583679528463812, "entropy": 27.128804951329386, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.73536407590487, "num_env_steps_trained_throughput_per_sec": 212.73536407590487, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 19027.594, "sample_time_ms": 15351.469, "load_time_ms": 506.75, "load_throughput": 7893.433, "learn_time_ms": 3123.508, "learn_throughput": 1280.611, "synch_weights_time_ms": 42.776}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 168, "training_iteration": 41, "trial_id": "bec7c_00000", "date": "2025-04-27_08-49-46", "timestamp": 1745743786, "time_this_iter_s": 18.811283349990845, "time_total_s": 772.2433571815491, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 772.2433571815491, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 49.492592592592594, "ram_util_percent": 13.577777777777783}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.32173955644736246, "policy_loss": -0.052909934474155304, "vf_loss": 0.0030291467910061446, "vf_explained_var": 0.6185393164234777, "kl": 0.006597079591297345, "entropy": 27.20237020677136, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 12865.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 18.026849999999826, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.144999999999957, 23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4734959747040254, "mean_inference_ms": 2.2354472946835697, "mean_action_processing_ms": 0.23980462986663612, "mean_env_wait_ms": 65.7386362218416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06608986854553223, "StateBufferConnector_ms": 0.006337642669677734, "ViewRequirementAgentConnector_ms": 0.15369820594787598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.72831707718706, "num_env_steps_trained_throughput_per_sec": 214.72831707718706, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 18988.107, "sample_time_ms": 15304.339, "load_time_ms": 506.714, "load_throughput": 7894.0, "learn_time_ms": 3131.076, "learn_throughput": 1277.516, "synch_weights_time_ms": 42.866}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 168, "training_iteration": 42, "trial_id": "bec7c_00000", "date": "2025-04-27_08-50-05", "timestamp": 1745743805, "time_this_iter_s": 18.636471033096313, "time_total_s": 790.8798282146454, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 790.8798282146454, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 49.51538461538462, "ram_util_percent": 13.384615384615387}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.36088945935217426, "policy_loss": -0.09132292400444708, "vf_loss": 0.0029584651115357936, "vf_explained_var": 0.4421366893476055, "kl": 0.005775321888755101, "entropy": 27.266938849418395, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 13175.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 17.988499999999824, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4732834162261689, "mean_inference_ms": 2.2348610386856023, "mean_action_processing_ms": 0.23982731587212766, "mean_env_wait_ms": 65.73137472301191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06586432456970215, "StateBufferConnector_ms": 0.006349325180053711, "ViewRequirementAgentConnector_ms": 0.1537632942199707}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 14.029999999999825, "episode_reward_mean": 17.988499999999824, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.61499999999972, 20.45999999999979, 17.814999999999987, 22.809999999999743, 14.7299999999998, 14.209999999999821, 18.13499999999991, 16.20499999999986, 14.209999999999827, 17.619999999999965, 17.79999999999999, 15.449999999999777, 20.254999999999757, 15.619999999999802, 17.969999999999814, 15.82000000000004, 16.449999999999736, 19.81999999999992, 41.519999999999236, 14.549999999999823, 14.28999999999982, 18.614999999999924, 27.759999999999565, 17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4732834162261689, "mean_inference_ms": 2.2348610386856023, "mean_action_processing_ms": 0.23982731587212766, "mean_env_wait_ms": 65.73137472301191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06586432456970215, "StateBufferConnector_ms": 0.006349325180053711, "ViewRequirementAgentConnector_ms": 0.1537632942199707}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.61983862645937, "num_env_steps_trained_throughput_per_sec": 204.61983862645937, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 19119.202, "sample_time_ms": 15449.987, "load_time_ms": 506.239, "load_throughput": 7901.412, "learn_time_ms": 3117.078, "learn_throughput": 1283.253, "synch_weights_time_ms": 42.822}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 169, "training_iteration": 43, "trial_id": "bec7c_00000", "date": "2025-04-27_08-50-24", "timestamp": 1745743824, "time_this_iter_s": 19.557161569595337, "time_total_s": 810.4369897842407, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 810.4369897842407, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 47.596428571428575, "ram_util_percent": 13.410714285714286}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.320726609868542, "policy_loss": -0.07825457716901456, "vf_loss": 0.03243175759644439, "vf_explained_var": 0.6843102793539724, "kl": 0.010415873020112133, "entropy": 27.516419312261768, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.26699999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4725825176613363, "mean_inference_ms": 2.2396993742257676, "mean_action_processing_ms": 0.23969815102583325, "mean_env_wait_ms": 65.8522626177749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06624722480773926, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.15430855751037598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.26699999999982, "episode_len_mean": 900.0, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4725825176613363, "mean_inference_ms": 2.2396993742257676, "mean_action_processing_ms": 0.23969815102583325, "mean_env_wait_ms": 65.8522626177749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06624722480773926, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.15430855751037598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.8674684204021, "num_env_steps_trained_throughput_per_sec": 217.8674684204021, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 19036.419, "sample_time_ms": 15375.051, "load_time_ms": 498.324, "load_throughput": 8026.904, "learn_time_ms": 3117.165, "learn_throughput": 1283.217, "synch_weights_time_ms": 42.775}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 192, "training_iteration": 44, "trial_id": "bec7c_00000", "date": "2025-04-27_08-50-43", "timestamp": 1745743843, "time_this_iter_s": 18.368188619613647, "time_total_s": 828.8051784038544, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 828.8051784038544, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 55.25599999999999, "ram_util_percent": 13.38}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3132607880780744, "policy_loss": -0.0938083425044052, "vf_loss": 0.057682916237213396, "vf_explained_var": 0.4140232411123091, "kl": 0.013159406449056171, "entropy": 27.746435110030635, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 13795.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.26699999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4725825176613363, "mean_inference_ms": 2.2396993742257676, "mean_action_processing_ms": 0.23969815102583325, "mean_env_wait_ms": 65.8522626177749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06624722480773926, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.15430855751037598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.26699999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4725825176613363, "mean_inference_ms": 2.2396993742257676, "mean_action_processing_ms": 0.23969815102583325, "mean_env_wait_ms": 65.8522626177749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06624722480773926, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.15430855751037598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.6913522071786, "num_env_steps_trained_throughput_per_sec": 215.6913522071786, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 18885.949, "sample_time_ms": 15234.314, "load_time_ms": 489.538, "load_throughput": 8170.963, "learn_time_ms": 3117.185, "learn_throughput": 1283.209, "synch_weights_time_ms": 41.805}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 192, "training_iteration": 45, "trial_id": "bec7c_00000", "date": "2025-04-27_08-51-01", "timestamp": 1745743861, "time_this_iter_s": 18.554138660430908, "time_total_s": 847.3593170642853, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 847.3593170642853, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 55.626923076923084, "ram_util_percent": 13.36923076923077}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.31478120627561434, "policy_loss": -0.06700109375580665, "vf_loss": 0.03212622011379872, "vf_explained_var": 0.3263069562373623, "kl": 0.008584912439267012, "entropy": 28.01209602355957, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 14105.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.26699999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4725825176613363, "mean_inference_ms": 2.2396993742257676, "mean_action_processing_ms": 0.23969815102583325, "mean_env_wait_ms": 65.8522626177749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06624722480773926, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.15430855751037598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.26699999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4725825176613363, "mean_inference_ms": 2.2396993742257676, "mean_action_processing_ms": 0.23969815102583325, "mean_env_wait_ms": 65.8522626177749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06624722480773926, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.15430855751037598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 197.3306866403164, "num_env_steps_trained_throughput_per_sec": 197.3306866403164, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 19016.771, "sample_time_ms": 15358.779, "load_time_ms": 498.311, "load_throughput": 8027.123, "learn_time_ms": 3114.735, "learn_throughput": 1284.218, "synch_weights_time_ms": 41.84}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 192, "training_iteration": 46, "trial_id": "bec7c_00000", "date": "2025-04-27_08-51-22", "timestamp": 1745743882, "time_this_iter_s": 20.279587268829346, "time_total_s": 867.6389043331146, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 867.6389043331146, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 50.89655172413793, "ram_util_percent": 13.427586206896553}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.024999999999999998, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3856574939984468, "policy_loss": -0.10846693745904391, "vf_loss": 0.003486569034782494, "vf_explained_var": 0.5360418915748596, "kl": 0.004245824247446073, "entropy": 28.078327701937766, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.26699999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4725825176613363, "mean_inference_ms": 2.2396993742257676, "mean_action_processing_ms": 0.23969815102583325, "mean_env_wait_ms": 65.8522626177749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06624722480773926, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.15430855751037598}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.26699999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.879999999999956, 17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4725825176613363, "mean_inference_ms": 2.2396993742257676, "mean_action_processing_ms": 0.23969815102583325, "mean_env_wait_ms": 65.8522626177749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06624722480773926, "StateBufferConnector_ms": 0.006344795227050781, "ViewRequirementAgentConnector_ms": 0.15430855751037598}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.59992447867177, "num_env_steps_trained_throughput_per_sec": 215.59992447867177, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 18989.894, "sample_time_ms": 15332.158, "load_time_ms": 497.771, "load_throughput": 8035.831, "learn_time_ms": 3115.14, "learn_throughput": 1284.052, "synch_weights_time_ms": 41.692}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 192, "training_iteration": 47, "trial_id": "bec7c_00000", "date": "2025-04-27_08-51-40", "timestamp": 1745743900, "time_this_iter_s": 18.560970306396484, "time_total_s": 886.1998746395111, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 886.1998746395111, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 54.93846153846153, "ram_util_percent": 13.380769230769234}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012499999999999999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.38445393154397606, "policy_loss": -0.10551224513159645, "vf_loss": 0.0025889754872262145, "vf_explained_var": 0.5175346968635436, "kl": 0.004609073153856556, "entropy": 28.15882787396831, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 14725.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.233699999999818, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47241804879207633, "mean_inference_ms": 2.239191863459794, "mean_action_processing_ms": 0.23970138221728593, "mean_env_wait_ms": 65.84503446852749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06597518920898438, "StateBufferConnector_ms": 0.0063457489013671875, "ViewRequirementAgentConnector_ms": 0.15420031547546387}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.233699999999818, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.409999999999997, 18.42999999999993, 15.86999999999997, 14.864999999999862, 14.269999999999817, 18.22999999999994, 14.659999999999824, 14.309999999999823, 14.909999999999902, 17.584999999999994, 14.469999999999823, 16.51499999999975, 43.22500000000001, 17.78499999999998, 14.659999999999783, 14.469999999999834, 16.170000000000094, 17.689999999999994, 22.459999999999464, 25.194999999999443, 16.699999999999747, 17.75000000000001, 21.09999999999977, 16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47241804879207633, "mean_inference_ms": 2.239191863459794, "mean_action_processing_ms": 0.23970138221728593, "mean_env_wait_ms": 65.84503446852749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06597518920898438, "StateBufferConnector_ms": 0.0063457489013671875, "ViewRequirementAgentConnector_ms": 0.15420031547546387}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.9360698494109, "num_env_steps_trained_throughput_per_sec": 203.9360698494109, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 19077.702, "sample_time_ms": 15408.977, "load_time_ms": 497.848, "load_throughput": 8034.586, "learn_time_ms": 3126.107, "learn_throughput": 1279.547, "synch_weights_time_ms": 41.666}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 193, "training_iteration": 48, "trial_id": "bec7c_00000", "date": "2025-04-27_08-52-00", "timestamp": 1745743920, "time_this_iter_s": 19.621857404708862, "time_total_s": 905.82173204422, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 905.82173204422, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 53.42962962962962, "ram_util_percent": 13.422222222222224}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0062499999999999995, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.34634239172540426, "policy_loss": -0.0662529834876618, "vf_loss": 0.0025958789334840876, "vf_explained_var": 0.849227540339193, "kl": 0.009249904160758653, "entropy": 28.27431059191304, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 15035.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.86829999999983, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711141920060383, "mean_inference_ms": 2.2386967194247855, "mean_action_processing_ms": 0.23921831345557146, "mean_env_wait_ms": 65.90372982606864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06623101234436035, "StateBufferConnector_ms": 0.006387233734130859, "ViewRequirementAgentConnector_ms": 0.15468144416809082}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.86829999999983, "episode_len_mean": 900.0, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711141920060383, "mean_inference_ms": 2.2386967194247855, "mean_action_processing_ms": 0.23921831345557146, "mean_env_wait_ms": 65.90372982606864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06623101234436035, "StateBufferConnector_ms": 0.006387233734130859, "ViewRequirementAgentConnector_ms": 0.15468144416809082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.9755786556679, "num_env_steps_trained_throughput_per_sec": 210.9755786556679, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 19107.987, "sample_time_ms": 15439.49, "load_time_ms": 497.096, "load_throughput": 8046.732, "learn_time_ms": 3126.595, "learn_throughput": 1279.347, "synch_weights_time_ms": 41.7}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 216, "training_iteration": 49, "trial_id": "bec7c_00000", "date": "2025-04-27_08-52-19", "timestamp": 1745743939, "time_this_iter_s": 18.968184232711792, "time_total_s": 924.7899162769318, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 924.7899162769318, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 53.27037037037036, "ram_util_percent": 13.51851851851852}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0062499999999999995, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3390022886982713, "policy_loss": -0.066246142254902, "vf_loss": 0.010014246942298468, "vf_explained_var": 0.5957567611048299, "kl": 0.014612850436336181, "entropy": 28.286173346734817, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.86829999999983, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711141920060383, "mean_inference_ms": 2.2386967194247855, "mean_action_processing_ms": 0.23921831345557146, "mean_env_wait_ms": 65.90372982606864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06623101234436035, "StateBufferConnector_ms": 0.006387233734130859, "ViewRequirementAgentConnector_ms": 0.15468144416809082}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.86829999999983, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711141920060383, "mean_inference_ms": 2.2386967194247855, "mean_action_processing_ms": 0.23921831345557146, "mean_env_wait_ms": 65.90372982606864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06623101234436035, "StateBufferConnector_ms": 0.006387233734130859, "ViewRequirementAgentConnector_ms": 0.15468144416809082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.54089481607272, "num_env_steps_trained_throughput_per_sec": 218.54089481607272, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 18958.397, "sample_time_ms": 15288.968, "load_time_ms": 497.065, "load_throughput": 8047.239, "learn_time_ms": 3127.56, "learn_throughput": 1278.952, "synch_weights_time_ms": 41.68}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 216, "training_iteration": 50, "trial_id": "bec7c_00000", "date": "2025-04-27_08-52-37", "timestamp": 1745743957, "time_this_iter_s": 18.313659191131592, "time_total_s": 943.1035754680634, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 943.1035754680634, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 55.31153846153847, "ram_util_percent": 13.58846153846154}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0062499999999999995, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3409763271740127, "policy_loss": -0.06691735563048672, "vf_loss": 0.010198528947488916, "vf_explained_var": 0.4925575650507404, "kl": 0.005781209095608398, "entropy": 28.42936414287936, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 15655.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.86829999999983, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711141920060383, "mean_inference_ms": 2.2386967194247855, "mean_action_processing_ms": 0.23921831345557146, "mean_env_wait_ms": 65.90372982606864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06623101234436035, "StateBufferConnector_ms": 0.006387233734130859, "ViewRequirementAgentConnector_ms": 0.15468144416809082}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.86829999999983, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711141920060383, "mean_inference_ms": 2.2386967194247855, "mean_action_processing_ms": 0.23921831345557146, "mean_env_wait_ms": 65.90372982606864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06623101234436035, "StateBufferConnector_ms": 0.006387233734130859, "ViewRequirementAgentConnector_ms": 0.15468144416809082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.55387194113615, "num_env_steps_trained_throughput_per_sec": 199.55387194113615, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 19082.598, "sample_time_ms": 15402.323, "load_time_ms": 506.483, "load_throughput": 7897.597, "learn_time_ms": 3129.109, "learn_throughput": 1278.319, "synch_weights_time_ms": 41.567}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 216, "training_iteration": 51, "trial_id": "bec7c_00000", "date": "2025-04-27_08-52-57", "timestamp": 1745743977, "time_this_iter_s": 20.053475856781006, "time_total_s": 963.1570513248444, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 963.1570513248444, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 52.04642857142858, "ram_util_percent": 13.65714285714286}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0062499999999999995, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.37375665687385107, "policy_loss": -0.09217480512395981, "vf_loss": 0.004269649783318821, "vf_explained_var": 0.6068612125612074, "kl": 0.004173471029327513, "entropy": 28.587758925653272, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 15965.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.86829999999983, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711141920060383, "mean_inference_ms": 2.2386967194247855, "mean_action_processing_ms": 0.23921831345557146, "mean_env_wait_ms": 65.90372982606864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06623101234436035, "StateBufferConnector_ms": 0.006387233734130859, "ViewRequirementAgentConnector_ms": 0.15468144416809082}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.86829999999983, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.229999999999805, 19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4711141920060383, "mean_inference_ms": 2.2386967194247855, "mean_action_processing_ms": 0.23921831345557146, "mean_env_wait_ms": 65.90372982606864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06623101234436035, "StateBufferConnector_ms": 0.006387233734130859, "ViewRequirementAgentConnector_ms": 0.15468144416809082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.9800135368776, "num_env_steps_trained_throughput_per_sec": 208.9800135368776, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 19133.839, "sample_time_ms": 15423.963, "load_time_ms": 505.37, "load_throughput": 7914.992, "learn_time_ms": 3159.405, "learn_throughput": 1266.061, "synch_weights_time_ms": 41.99}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 216, "training_iteration": 52, "trial_id": "bec7c_00000", "date": "2025-04-27_08-53-17", "timestamp": 1745743997, "time_this_iter_s": 19.14880681037903, "time_total_s": 982.3058581352234, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 982.3058581352234, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 50.65185185185186, "ram_util_percent": 13.755555555555556}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3034953400132156, "policy_loss": -0.039528523405803546, "vf_loss": 0.02156509954546627, "vf_explained_var": 0.5195720555320863, "kl": 0.008336841101998053, "entropy": 28.555797318489322, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.902904999999834, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47081502683248805, "mean_inference_ms": 2.2379615381003704, "mean_action_processing_ms": 0.23921931100647015, "mean_env_wait_ms": 65.89444238907753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06616330146789551, "StateBufferConnector_ms": 0.006376981735229492, "ViewRequirementAgentConnector_ms": 0.1543581485748291}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.902904999999834, "episode_len_mean": 897.91, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.814999999999984, 14.029999999999825, 16.929999999999826, 14.659999999999824, 15.089999999999819, 45.174999999999145, 16.989999999999753, 18.819999999999972, 14.54999999999981, 20.98499999999964, 15.594999999999892, 14.409999999999815, 16.249999999999776, 14.36999999999981, 14.20999999999982, 15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47081502683248805, "mean_inference_ms": 2.2379615381003704, "mean_action_processing_ms": 0.23921931100647015, "mean_env_wait_ms": 65.89444238907753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06616330146789551, "StateBufferConnector_ms": 0.006376981735229492, "ViewRequirementAgentConnector_ms": 0.1543581485748291}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.18220077246588, "num_env_steps_trained_throughput_per_sec": 207.18220077246588, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 19109.661, "sample_time_ms": 15388.176, "load_time_ms": 506.777, "load_throughput": 7893.017, "learn_time_ms": 3169.24, "learn_throughput": 1262.132, "synch_weights_time_ms": 42.362}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 217, "training_iteration": 53, "trial_id": "bec7c_00000", "date": "2025-04-27_08-53-36", "timestamp": 1745744016, "time_this_iter_s": 19.314663410186768, "time_total_s": 1001.6205215454102, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1001.6205215454102, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 49.162962962962965, "ram_util_percent": 13.4962962962963}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3454359135830835, "policy_loss": -0.06456401275861408, "vf_loss": 0.0075534457170438295, "vf_explained_var": 0.6490423175596421, "kl": 0.013723763858821082, "entropy": 28.846823919973065, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 16585.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.507754999999833, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47026460725888847, "mean_inference_ms": 2.237213114312921, "mean_action_processing_ms": 0.23890227541893494, "mean_env_wait_ms": 65.84529673376014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0660090446472168, "StateBufferConnector_ms": 0.006393909454345703, "ViewRequirementAgentConnector_ms": 0.15402889251708984}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.507754999999833, "episode_len_mean": 897.91, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.624999999999998, 14.389999999999823, 14.129999999999827, 15.514999999999803, 14.10999999999982, 14.209999999999816, 20.739999999999746, 15.079999999999794, 15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47026460725888847, "mean_inference_ms": 2.237213114312921, "mean_action_processing_ms": 0.23890227541893494, "mean_env_wait_ms": 65.84529673376014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0660090446472168, "StateBufferConnector_ms": 0.006393909454345703, "ViewRequirementAgentConnector_ms": 0.15402889251708984}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.15371509916662, "num_env_steps_trained_throughput_per_sec": 214.15371509916662, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 19141.5, "sample_time_ms": 15419.285, "load_time_ms": 505.231, "load_throughput": 7917.172, "learn_time_ms": 3171.789, "learn_throughput": 1261.118, "synch_weights_time_ms": 42.116}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 232, "training_iteration": 54, "trial_id": "bec7c_00000", "date": "2025-04-27_08-53-55", "timestamp": 1745744035, "time_this_iter_s": 18.687589168548584, "time_total_s": 1020.3081107139587, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1020.3081107139587, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 50.48461538461538, "ram_util_percent": 13.288461538461538}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3603141071581875, "policy_loss": -0.08654213777232554, "vf_loss": 0.016616898899672144, "vf_explained_var": 0.5943177859629354, "kl": 0.010624466254949203, "entropy": 29.042208007074173, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 16895.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.458704999999835, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698337069640066, "mean_inference_ms": 2.2369732523579793, "mean_action_processing_ms": 0.23877463305741872, "mean_env_wait_ms": 65.9190437981739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06585526466369629, "StateBufferConnector_ms": 0.006374359130859375, "ViewRequirementAgentConnector_ms": 0.15376853942871094}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.458704999999835, "episode_len_mean": 897.91, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698337069640066, "mean_inference_ms": 2.2369732523579793, "mean_action_processing_ms": 0.23877463305741872, "mean_env_wait_ms": 65.9190437981739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06585526466369629, "StateBufferConnector_ms": 0.006374359130859375, "ViewRequirementAgentConnector_ms": 0.15376853942871094}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.16361440384043, "num_env_steps_trained_throughput_per_sec": 213.16361440384043, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 19163.491, "sample_time_ms": 15442.477, "load_time_ms": 505.042, "load_throughput": 7920.136, "learn_time_ms": 3170.464, "learn_throughput": 1261.645, "synch_weights_time_ms": 42.424}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 240, "training_iteration": 55, "trial_id": "bec7c_00000", "date": "2025-04-27_08-54-13", "timestamp": 1745744053, "time_this_iter_s": 18.77400779724121, "time_total_s": 1039.0821185112, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1039.0821185112, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 53.76538461538462, "ram_util_percent": 13.338461538461537}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3424230348067208, "policy_loss": -0.060217746169937234, "vf_loss": 0.008364519182284693, "vf_explained_var": 0.34615064359480335, "kl": 0.007407407205204025, "entropy": 29.059295955781014, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.458704999999835, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698337069640066, "mean_inference_ms": 2.2369732523579793, "mean_action_processing_ms": 0.23877463305741872, "mean_env_wait_ms": 65.9190437981739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06585526466369629, "StateBufferConnector_ms": 0.006374359130859375, "ViewRequirementAgentConnector_ms": 0.15376853942871094}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.458704999999835, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698337069640066, "mean_inference_ms": 2.2369732523579793, "mean_action_processing_ms": 0.23877463305741872, "mean_env_wait_ms": 65.9190437981739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06585526466369629, "StateBufferConnector_ms": 0.006374359130859375, "ViewRequirementAgentConnector_ms": 0.15376853942871094}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.29655562901547, "num_env_steps_trained_throughput_per_sec": 204.29655562901547, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 19094.377, "sample_time_ms": 15375.094, "load_time_ms": 497.394, "load_throughput": 8041.91, "learn_time_ms": 3176.421, "learn_throughput": 1259.279, "synch_weights_time_ms": 42.354}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 240, "training_iteration": 56, "trial_id": "bec7c_00000", "date": "2025-04-27_08-54-33", "timestamp": 1745744073, "time_this_iter_s": 19.587301015853882, "time_total_s": 1058.6694195270538, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1058.6694195270538, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 53.1, "ram_util_percent": 13.424999999999999}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3817857914618329, "policy_loss": -0.09141916484842377, "vf_loss": 0.004115633314851889, "vf_explained_var": 0.2960622091447153, "kl": 0.0056465251239945155, "entropy": 29.449991189279864, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 17515.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.458704999999835, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698337069640066, "mean_inference_ms": 2.2369732523579793, "mean_action_processing_ms": 0.23877463305741872, "mean_env_wait_ms": 65.9190437981739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06585526466369629, "StateBufferConnector_ms": 0.006374359130859375, "ViewRequirementAgentConnector_ms": 0.15376853942871094}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.458704999999835, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698337069640066, "mean_inference_ms": 2.2369732523579793, "mean_action_processing_ms": 0.23877463305741872, "mean_env_wait_ms": 65.9190437981739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06585526466369629, "StateBufferConnector_ms": 0.006374359130859375, "ViewRequirementAgentConnector_ms": 0.15376853942871094}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.3411387774695, "num_env_steps_trained_throughput_per_sec": 207.3411387774695, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 19168.278, "sample_time_ms": 15451.404, "load_time_ms": 497.385, "load_throughput": 8042.063, "learn_time_ms": 3173.783, "learn_throughput": 1260.326, "synch_weights_time_ms": 42.573}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 240, "training_iteration": 57, "trial_id": "bec7c_00000", "date": "2025-04-27_08-54-52", "timestamp": 1745744092, "time_this_iter_s": 19.300985097885132, "time_total_s": 1077.970404624939, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1077.970404624939, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 53.38518518518518, "ram_util_percent": 13.14074074074074}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.41396968749411883, "policy_loss": -0.11824370400319176, "vf_loss": 0.0016227655381249684, "vf_explained_var": 0.30747036741625877, "kl": 0.008146253927478054, "entropy": 29.737421368014427, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 17825.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.458704999999835, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698337069640066, "mean_inference_ms": 2.2369732523579793, "mean_action_processing_ms": 0.23877463305741872, "mean_env_wait_ms": 65.9190437981739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06585526466369629, "StateBufferConnector_ms": 0.006374359130859375, "ViewRequirementAgentConnector_ms": 0.15376853942871094}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.458704999999835, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.009999999999804, 15.569999999999764, 14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698337069640066, "mean_inference_ms": 2.2369732523579793, "mean_action_processing_ms": 0.23877463305741872, "mean_env_wait_ms": 65.9190437981739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06585526466369629, "StateBufferConnector_ms": 0.006374359130859375, "ViewRequirementAgentConnector_ms": 0.15376853942871094}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.54561847568272, "num_env_steps_trained_throughput_per_sec": 213.54561847568272, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 19080.015, "sample_time_ms": 15370.661, "load_time_ms": 505.652, "load_throughput": 7910.584, "learn_time_ms": 3158.187, "learn_throughput": 1266.549, "synch_weights_time_ms": 42.357}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 240, "training_iteration": 58, "trial_id": "bec7c_00000", "date": "2025-04-27_08-55-11", "timestamp": 1745744111, "time_this_iter_s": 18.73950958251953, "time_total_s": 1096.7099142074585, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1096.7099142074585, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 51.44444444444444, "ram_util_percent": 13.311111111111112}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.417994541089396, "policy_loss": -0.12105049998048813, "vf_loss": 0.001335213008672825, "vf_explained_var": 0.467185624184147, "kl": 0.0068118473026849095, "entropy": 29.83005448618243, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.594104999999832, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696251857296764, "mean_inference_ms": 2.2364275065829804, "mean_action_processing_ms": 0.23875041962732307, "mean_env_wait_ms": 65.89193427262848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06560897827148438, "StateBufferConnector_ms": 0.006369829177856445, "ViewRequirementAgentConnector_ms": 0.1535937786102295}}, "episode_reward_max": 48.430000000001414, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.594104999999832, "episode_len_mean": 897.91, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999823, 22.64999999999969, 14.029999999999827, 14.759999999999788, 14.129999999999821, 15.269999999999811, 38.00999999999909, 48.430000000001414, 15.759999999999796, 15.28999999999979, 14.209999999999821, 16.54499999999981, 15.089999999999822, 14.46999999999982, 17.34499999999975, 14.829999999999815, 14.209999999999818, 14.689999999999786, 20.224999999999778, 15.104999999999825, 22.789999999999623, 14.389999999999821, 14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696251857296764, "mean_inference_ms": 2.2364275065829804, "mean_action_processing_ms": 0.23875041962732307, "mean_env_wait_ms": 65.89193427262848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06560897827148438, "StateBufferConnector_ms": 0.006369829177856445, "ViewRequirementAgentConnector_ms": 0.1535937786102295}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.87524427946417, "num_env_steps_trained_throughput_per_sec": 211.87524427946417, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 19071.964, "sample_time_ms": 15376.234, "load_time_ms": 506.888, "load_throughput": 7891.291, "learn_time_ms": 3143.323, "learn_throughput": 1272.538, "synch_weights_time_ms": 42.376}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 242, "training_iteration": 59, "trial_id": "bec7c_00000", "date": "2025-04-27_08-55-30", "timestamp": 1745744130, "time_this_iter_s": 18.887410163879395, "time_total_s": 1115.597324371338, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1115.597324371338, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 54.13846153846154, "ram_util_percent": 13.453846153846156}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3475602823745219, "policy_loss": -0.07251040078699589, "vf_loss": 0.024342337506635475, "vf_explained_var": 0.9143511112659208, "kl": 0.011462112808401034, "entropy": 29.942803991994552, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 18445.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.924854999999823, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46873856982510453, "mean_inference_ms": 2.235288721009095, "mean_action_processing_ms": 0.2383796488195631, "mean_env_wait_ms": 65.93139629775415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06089162826538086, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.1538243293762207}}, "episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.924854999999823, "episode_len_mean": 897.91, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46873856982510453, "mean_inference_ms": 2.235288721009095, "mean_action_processing_ms": 0.2383796488195631, "mean_env_wait_ms": 65.93139629775415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06089162826538086, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.1538243293762207}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.03800439809507, "num_env_steps_trained_throughput_per_sec": 221.03800439809507, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 19051.287, "sample_time_ms": 15356.32, "load_time_ms": 506.437, "load_throughput": 7898.319, "learn_time_ms": 3142.933, "learn_throughput": 1272.697, "synch_weights_time_ms": 42.453}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 264, "training_iteration": 60, "trial_id": "bec7c_00000", "date": "2025-04-27_08-55-48", "timestamp": 1745744148, "time_this_iter_s": 18.105377674102783, "time_total_s": 1133.7027020454407, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1133.7027020454407, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 55.216, "ram_util_percent": 13.320000000000002}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031249999999999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.33080520219500026, "policy_loss": -0.08272793831664228, "vf_loss": 0.052895101543465224, "vf_explained_var": 0.5025972233664605, "kl": 0.027059601662744348, "entropy": 30.105692814242456, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 18755.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.924854999999823, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46873856982510453, "mean_inference_ms": 2.235288721009095, "mean_action_processing_ms": 0.2383796488195631, "mean_env_wait_ms": 65.93139629775415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06089162826538086, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.1538243293762207}}, "episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.924854999999823, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46873856982510453, "mean_inference_ms": 2.235288721009095, "mean_action_processing_ms": 0.2383796488195631, "mean_env_wait_ms": 65.93139629775415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06089162826538086, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.1538243293762207}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.8752897667005, "num_env_steps_trained_throughput_per_sec": 211.8752897667005, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 18934.715, "sample_time_ms": 15235.347, "load_time_ms": 496.727, "load_throughput": 8052.719, "learn_time_ms": 3156.241, "learn_throughput": 1267.33, "synch_weights_time_ms": 43.226}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 264, "training_iteration": 61, "trial_id": "bec7c_00000", "date": "2025-04-27_08-56-07", "timestamp": 1745744167, "time_this_iter_s": 18.88910222053528, "time_total_s": 1152.591804265976, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1152.591804265976, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 53.61481481481483, "ram_util_percent": 13.562962962962965}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0046875, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3004171549718106, "policy_loss": -0.06444781416644071, "vf_loss": 0.06732613526378813, "vf_explained_var": 0.4855102500607891, "kl": 0.022527144814610496, "entropy": 30.340108268491683, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.924854999999823, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46873856982510453, "mean_inference_ms": 2.235288721009095, "mean_action_processing_ms": 0.2383796488195631, "mean_env_wait_ms": 65.93139629775415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06089162826538086, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.1538243293762207}}, "episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.924854999999823, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46873856982510453, "mean_inference_ms": 2.235288721009095, "mean_action_processing_ms": 0.2383796488195631, "mean_env_wait_ms": 65.93139629775415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06089162826538086, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.1538243293762207}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.26604251316604, "num_env_steps_trained_throughput_per_sec": 195.26604251316604, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 19069.143, "sample_time_ms": 15393.41, "load_time_ms": 506.566, "load_throughput": 7896.313, "learn_time_ms": 3123.003, "learn_throughput": 1280.818, "synch_weights_time_ms": 42.998}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 264, "training_iteration": 62, "trial_id": "bec7c_00000", "date": "2025-04-27_08-56-28", "timestamp": 1745744188, "time_this_iter_s": 20.493533849716187, "time_total_s": 1173.0853381156921, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1173.0853381156921, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 50.85862068965517, "ram_util_percent": 13.679310344827591}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4101776178580739, "policy_loss": -0.1111843412261336, "vf_loss": 0.006928416437562367, "vf_explained_var": 0.5156484434681554, "kl": 0.007074004044707474, "entropy": 30.597143271661572, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 19375.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.924854999999823, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46873856982510453, "mean_inference_ms": 2.235288721009095, "mean_action_processing_ms": 0.2383796488195631, "mean_env_wait_ms": 65.93139629775415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06089162826538086, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.1538243293762207}}, "episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.924854999999823, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 17.64499999999976, 17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46873856982510453, "mean_inference_ms": 2.235288721009095, "mean_action_processing_ms": 0.2383796488195631, "mean_env_wait_ms": 65.93139629775415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06089162826538086, "StateBufferConnector_ms": 0.006345987319946289, "ViewRequirementAgentConnector_ms": 0.1538243293762207}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.14767111101364, "num_env_steps_trained_throughput_per_sec": 208.14767111101364, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 19060.188, "sample_time_ms": 15382.116, "load_time_ms": 504.427, "load_throughput": 7929.785, "learn_time_ms": 3127.132, "learn_throughput": 1279.127, "synch_weights_time_ms": 43.327}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 264, "training_iteration": 63, "trial_id": "bec7c_00000", "date": "2025-04-27_08-56-47", "timestamp": 1745744207, "time_this_iter_s": 19.225900650024414, "time_total_s": 1192.3112387657166, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1192.3112387657166, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 51.48518518518518, "ram_util_percent": 13.822222222222225}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.40247775642201306, "policy_loss": -0.09923109868240933, "vf_loss": 0.005091761873066594, "vf_explained_var": 0.576481133122598, "kl": 0.008467904061316775, "entropy": 30.83979656465592, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 19685.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.91290499999982, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686241102500247, "mean_inference_ms": 2.235263611614167, "mean_action_processing_ms": 0.23839146649845339, "mean_env_wait_ms": 65.91515300582006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06090950965881348, "StateBufferConnector_ms": 0.006371498107910156, "ViewRequirementAgentConnector_ms": 0.1543140411376953}}, "episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.91290499999982, "episode_len_mean": 897.91, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.20499999999975, 14.289999999999814, 14.309999999999834, 14.309999999999825, 21.454999999999675, 18.904999999999756, 16.609999999999793, 14.389999999999823, 16.414999999999946, 14.129999999999832, 20.40999999999966, 13.94999999999983, 16.654999999999767, 14.5099999999998, 14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686241102500247, "mean_inference_ms": 2.235263611614167, "mean_action_processing_ms": 0.23839146649845339, "mean_env_wait_ms": 65.91515300582006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06090950965881348, "StateBufferConnector_ms": 0.006371498107910156, "ViewRequirementAgentConnector_ms": 0.1543140411376953}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.18783922427727, "num_env_steps_trained_throughput_per_sec": 185.18783922427727, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 19352.34, "sample_time_ms": 15667.427, "load_time_ms": 510.943, "load_throughput": 7828.668, "learn_time_ms": 3127.446, "learn_throughput": 1278.999, "synch_weights_time_ms": 43.35}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 266, "training_iteration": 64, "trial_id": "bec7c_00000", "date": "2025-04-27_08-57-08", "timestamp": 1745744228, "time_this_iter_s": 21.607664823532104, "time_total_s": 1213.9189035892487, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1213.9189035892487, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 60.58333333333333, "ram_util_percent": 15.086666666666666}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.42923554693378746, "policy_loss": -0.12140102936856208, "vf_loss": 0.00229006981054197, "vf_explained_var": 0.748413465484496, "kl": 0.005092588829199573, "entropy": 31.016040094437137, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.88525499999982, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46847456493901307, "mean_inference_ms": 2.2362433165014193, "mean_action_processing_ms": 0.23828190643356872, "mean_env_wait_ms": 65.91763802801034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05846095085144043, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.15586066246032715}}, "episode_reward_max": 39.55000000000134, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.88525499999982, "episode_len_mean": 897.91, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.469999999999807, 14.469999999999816, 17.524999999999842, 16.269999999999737, 14.569999999999808, 14.799999999999823, 14.10999999999982, 15.269999999999785, 14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46847456493901307, "mean_inference_ms": 2.2362433165014193, "mean_action_processing_ms": 0.23828190643356872, "mean_env_wait_ms": 65.91763802801034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05846095085144043, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.15586066246032715}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.57547475707923, "num_env_steps_trained_throughput_per_sec": 212.57547475707923, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 19357.531, "sample_time_ms": 15678.066, "load_time_ms": 509.443, "load_throughput": 7851.716, "learn_time_ms": 3123.075, "learn_throughput": 1280.789, "synch_weights_time_ms": 43.797}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 280, "training_iteration": 65, "trial_id": "bec7c_00000", "date": "2025-04-27_08-57-27", "timestamp": 1745744247, "time_this_iter_s": 18.826018810272217, "time_total_s": 1232.7449223995209, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1232.7449223995209, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 51.092592592592595, "ram_util_percent": 12.85925925925926}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.36311065696363876, "policy_loss": -0.05906377421061118, "vf_loss": 0.006735929228541922, "vf_explained_var": 0.5827908056397592, "kl": 0.01450968506629696, "entropy": 31.08848419189453, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 20305.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31010499999984, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46830659183029416, "mean_inference_ms": 2.237272613084887, "mean_action_processing_ms": 0.23832685843023735, "mean_env_wait_ms": 66.0277411962528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056925058364868164, "StateBufferConnector_ms": 0.00637507438659668, "ViewRequirementAgentConnector_ms": 0.15631890296936035}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31010499999984, "episode_len_mean": 897.91, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46830659183029416, "mean_inference_ms": 2.237272613084887, "mean_action_processing_ms": 0.23832685843023735, "mean_env_wait_ms": 66.0277411962528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056925058364868164, "StateBufferConnector_ms": 0.00637507438659668, "ViewRequirementAgentConnector_ms": 0.15631890296936035}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.4271152421949, "num_env_steps_trained_throughput_per_sec": 214.4271152421949, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 19265.029, "sample_time_ms": 15586.166, "load_time_ms": 508.878, "load_throughput": 7860.434, "learn_time_ms": 3122.765, "learn_throughput": 1280.916, "synch_weights_time_ms": 44.083}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 288, "training_iteration": 66, "trial_id": "bec7c_00000", "date": "2025-04-27_08-57-46", "timestamp": 1745744266, "time_this_iter_s": 18.662965774536133, "time_total_s": 1251.407888174057, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1251.407888174057, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 54.54230769230769, "ram_util_percent": 13.076923076923077}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3497368996715053, "policy_loss": -0.04955416004503927, "vf_loss": 0.010908862729716461, "vf_explained_var": 0.568615617675166, "kl": 0.010736114778896274, "entropy": 31.116709493821666, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 20615.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31010499999984, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46830659183029416, "mean_inference_ms": 2.237272613084887, "mean_action_processing_ms": 0.23832685843023735, "mean_env_wait_ms": 66.0277411962528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056925058364868164, "StateBufferConnector_ms": 0.00637507438659668, "ViewRequirementAgentConnector_ms": 0.15631890296936035}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31010499999984, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46830659183029416, "mean_inference_ms": 2.237272613084887, "mean_action_processing_ms": 0.23832685843023735, "mean_env_wait_ms": 66.0277411962528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056925058364868164, "StateBufferConnector_ms": 0.00637507438659668, "ViewRequirementAgentConnector_ms": 0.15631890296936035}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.4229052705277, "num_env_steps_trained_throughput_per_sec": 194.4229052705277, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 19393.212, "sample_time_ms": 15716.542, "load_time_ms": 508.673, "load_throughput": 7863.599, "learn_time_ms": 3120.839, "learn_throughput": 1281.707, "synch_weights_time_ms": 44.033}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 288, "training_iteration": 67, "trial_id": "bec7c_00000", "date": "2025-04-27_08-58-07", "timestamp": 1745744287, "time_this_iter_s": 20.58161950111389, "time_total_s": 1271.989507675171, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1271.989507675171, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 50.52068965517242, "ram_util_percent": 13.382758620689655}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4185062220222467, "policy_loss": -0.10574451035429393, "vf_loss": 0.002645736436076526, "vf_explained_var": 0.6679356534634867, "kl": 0.0055079790344325814, "entropy": 31.54461866194202, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31010499999984, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46830659183029416, "mean_inference_ms": 2.237272613084887, "mean_action_processing_ms": 0.23832685843023735, "mean_env_wait_ms": 66.0277411962528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056925058364868164, "StateBufferConnector_ms": 0.00637507438659668, "ViewRequirementAgentConnector_ms": 0.15631890296936035}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31010499999984, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.369999999999813, 14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46830659183029416, "mean_inference_ms": 2.237272613084887, "mean_action_processing_ms": 0.23832685843023735, "mean_env_wait_ms": 66.0277411962528, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056925058364868164, "StateBufferConnector_ms": 0.00637507438659668, "ViewRequirementAgentConnector_ms": 0.15631890296936035}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.4001597303436, "num_env_steps_trained_throughput_per_sec": 214.4001597303436, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 19385.746, "sample_time_ms": 15701.215, "load_time_ms": 499.666, "load_throughput": 8005.343, "learn_time_ms": 3137.509, "learn_throughput": 1274.897, "synch_weights_time_ms": 44.236}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 288, "training_iteration": 68, "trial_id": "bec7c_00000", "date": "2025-04-27_08-58-25", "timestamp": 1745744305, "time_this_iter_s": 18.664888858795166, "time_total_s": 1290.654396533966, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1290.654396533966, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 53.37692307692308, "ram_util_percent": 13.607692307692307}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.40563017256678113, "policy_loss": -0.09131622668956557, "vf_loss": 0.0027861238022817434, "vf_explained_var": 0.5943671637965787, "kl": 0.0055888450078782625, "entropy": 31.71393707644555, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 21235.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31450499999984, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46805625270007506, "mean_inference_ms": 2.236910366156295, "mean_action_processing_ms": 0.2383504823175674, "mean_env_wait_ms": 66.01273732584035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05692267417907715, "StateBufferConnector_ms": 0.006373167037963867, "ViewRequirementAgentConnector_ms": 0.1563248634338379}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31450499999984, "episode_len_mean": 897.91, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.469999999999816, 14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46805625270007506, "mean_inference_ms": 2.236910366156295, "mean_action_processing_ms": 0.2383504823175674, "mean_env_wait_ms": 66.01273732584035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05692267417907715, "StateBufferConnector_ms": 0.006373167037963867, "ViewRequirementAgentConnector_ms": 0.1563248634338379}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.8460336204154, "num_env_steps_trained_throughput_per_sec": 217.8460336204154, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 19334.001, "sample_time_ms": 15642.279, "load_time_ms": 498.932, "load_throughput": 8017.124, "learn_time_ms": 3145.326, "learn_throughput": 1271.728, "synch_weights_time_ms": 44.337}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 289, "training_iteration": 69, "trial_id": "bec7c_00000", "date": "2025-04-27_08-58-44", "timestamp": 1745744324, "time_this_iter_s": 18.370449542999268, "time_total_s": 1309.0248460769653, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1309.0248460769653, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 51.48461538461538, "ram_util_percent": 13.653846153846153}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3901393884075655, "policy_loss": -0.07784989344316624, "vf_loss": 0.004490102725802928, "vf_explained_var": 0.42330096287112084, "kl": 0.008053365851109476, "entropy": 31.683623104710733, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 21545.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31110499999984, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4682030343953336, "mean_inference_ms": 2.237445782037581, "mean_action_processing_ms": 0.23835224682753714, "mean_env_wait_ms": 66.00259576465768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05665874481201172, "StateBufferConnector_ms": 0.00636744499206543, "ViewRequirementAgentConnector_ms": 0.15613126754760742}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31110499999984, "episode_len_mean": 897.91, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.289999999999814, 17.22499999999973, 14.549999999999814, 14.469999999999807, 14.129999999999827, 14.129999999999821, 13.94999999999983, 14.389999999999807, 37.030000000000676, 14.289999999999818, 16.709999999999773, 14.289999999999832, 14.38999999999982, 14.02999999999983, 14.309999999999809, 14.749999999999817, 14.469999999999803, 14.129999999999827, 14.389999999999807, 14.12999999999982, 16.669999999999778, 39.55000000000134, 15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4682030343953336, "mean_inference_ms": 2.237445782037581, "mean_action_processing_ms": 0.23835224682753714, "mean_env_wait_ms": 66.00259576465768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05665874481201172, "StateBufferConnector_ms": 0.00636744499206543, "ViewRequirementAgentConnector_ms": 0.15613126754760742}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.0619042243678, "num_env_steps_trained_throughput_per_sec": 211.0619042243678, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 19419.537, "sample_time_ms": 15725.33, "load_time_ms": 498.868, "load_throughput": 8018.153, "learn_time_ms": 3147.758, "learn_throughput": 1270.746, "synch_weights_time_ms": 44.48}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 290, "training_iteration": 70, "trial_id": "bec7c_00000", "date": "2025-04-27_08-59-03", "timestamp": 1745744343, "time_this_iter_s": 18.9599711894989, "time_total_s": 1327.9848172664642, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1327.9848172664642, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 51.459259259259255, "ram_util_percent": 13.559259259259258}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.40848378807863955, "policy_loss": -0.09141990696831095, "vf_loss": 0.002604956041801826, "vf_explained_var": 0.8370555127820661, "kl": 0.008844135539613725, "entropy": 31.973102446525328, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.971604999999814, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815], "episode_lengths": [900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46810688631953185, "mean_inference_ms": 2.242164146835145, "mean_action_processing_ms": 0.23835081164562488, "mean_env_wait_ms": 66.04345137284646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267453193664551, "StateBufferConnector_ms": 0.006405830383300781, "ViewRequirementAgentConnector_ms": 0.15866422653198242}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.971604999999814, "episode_len_mean": 897.91, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815], "episode_lengths": [900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46810688631953185, "mean_inference_ms": 2.242164146835145, "mean_action_processing_ms": 0.23835081164562488, "mean_env_wait_ms": 66.04345137284646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267453193664551, "StateBufferConnector_ms": 0.006405830383300781, "ViewRequirementAgentConnector_ms": 0.15866422653198242}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.71429267574354, "num_env_steps_trained_throughput_per_sec": 215.71429267574354, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 19385.942, "sample_time_ms": 15654.737, "load_time_ms": 498.766, "load_throughput": 8019.791, "learn_time_ms": 3184.252, "learn_throughput": 1256.182, "synch_weights_time_ms": 45.118}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 312, "training_iteration": 71, "trial_id": "bec7c_00000", "date": "2025-04-27_08-59-21", "timestamp": 1745744361, "time_this_iter_s": 18.55378818511963, "time_total_s": 1346.5386054515839, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1346.5386054515839, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 60.0923076923077, "ram_util_percent": 13.73076923076923}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3923962742075204, "policy_loss": -0.0755580149906417, "vf_loss": 0.0032112617570683433, "vf_explained_var": 0.7078488765224333, "kl": 0.00810637543319219, "entropy": 32.01065244367046, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 22165.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.971604999999814, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815], "episode_lengths": [900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46810688631953185, "mean_inference_ms": 2.242164146835145, "mean_action_processing_ms": 0.23835081164562488, "mean_env_wait_ms": 66.04345137284646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267453193664551, "StateBufferConnector_ms": 0.006405830383300781, "ViewRequirementAgentConnector_ms": 0.15866422653198242}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.971604999999814, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815], "episode_lengths": [900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46810688631953185, "mean_inference_ms": 2.242164146835145, "mean_action_processing_ms": 0.23835081164562488, "mean_env_wait_ms": 66.04345137284646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267453193664551, "StateBufferConnector_ms": 0.006405830383300781, "ViewRequirementAgentConnector_ms": 0.15866422653198242}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.06578804931368, "num_env_steps_trained_throughput_per_sec": 193.06578804931368, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 19409.287, "sample_time_ms": 15696.581, "load_time_ms": 488.612, "load_throughput": 8186.452, "learn_time_ms": 3176.192, "learn_throughput": 1259.37, "synch_weights_time_ms": 44.804}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 312, "training_iteration": 72, "trial_id": "bec7c_00000", "date": "2025-04-27_08-59-42", "timestamp": 1745744382, "time_this_iter_s": 20.72597336769104, "time_total_s": 1367.264578819275, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1367.264578819275, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 60.179310344827584, "ram_util_percent": 14.637931034482763}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4140273155944963, "policy_loss": -0.09534242734793694, "vf_loss": 0.0027822553346448977, "vf_explained_var": 0.6730278155496043, "kl": 0.006619919368812031, "entropy": 32.15136980856619, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 22475.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.971604999999814, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815], "episode_lengths": [900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46810688631953185, "mean_inference_ms": 2.242164146835145, "mean_action_processing_ms": 0.23835081164562488, "mean_env_wait_ms": 66.04345137284646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267453193664551, "StateBufferConnector_ms": 0.006405830383300781, "ViewRequirementAgentConnector_ms": 0.15866422653198242}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.971604999999814, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815], "episode_lengths": [900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46810688631953185, "mean_inference_ms": 2.242164146835145, "mean_action_processing_ms": 0.23835081164562488, "mean_env_wait_ms": 66.04345137284646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267453193664551, "StateBufferConnector_ms": 0.006405830383300781, "ViewRequirementAgentConnector_ms": 0.15866422653198242}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.05804221677246, "num_env_steps_trained_throughput_per_sec": 205.05804221677246, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 19438.241, "sample_time_ms": 15723.662, "load_time_ms": 488.835, "load_throughput": 8182.728, "learn_time_ms": 3178.262, "learn_throughput": 1258.549, "synch_weights_time_ms": 44.392}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 312, "training_iteration": 73, "trial_id": "bec7c_00000", "date": "2025-04-27_09-00-02", "timestamp": 1745744402, "time_this_iter_s": 19.51570439338684, "time_total_s": 1386.7802832126617, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1386.7802832126617, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 49.3925925925926, "ram_util_percent": 13.43703703703704}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.39356202365785475, "policy_loss": -0.07357689857242569, "vf_loss": 0.003503265573395296, "vf_explained_var": 0.7064719430861934, "kl": 0.006802229955463836, "entropy": 32.353622288857736, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.971604999999814, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815], "episode_lengths": [900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46810688631953185, "mean_inference_ms": 2.242164146835145, "mean_action_processing_ms": 0.23835081164562488, "mean_env_wait_ms": 66.04345137284646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267453193664551, "StateBufferConnector_ms": 0.006405830383300781, "ViewRequirementAgentConnector_ms": 0.15866422653198242}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.971604999999814, "episode_len_mean": 897.91, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.089999999999785, 14.12999999999982, 14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815], "episode_lengths": [900, 900, 900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46810688631953185, "mean_inference_ms": 2.242164146835145, "mean_action_processing_ms": 0.23835081164562488, "mean_env_wait_ms": 66.04345137284646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05267453193664551, "StateBufferConnector_ms": 0.006405830383300781, "ViewRequirementAgentConnector_ms": 0.15866422653198242}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.805784397416, "num_env_steps_trained_throughput_per_sec": 216.805784397416, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 19123.242, "sample_time_ms": 15422.392, "load_time_ms": 481.655, "load_throughput": 8304.693, "learn_time_ms": 3171.622, "learn_throughput": 1261.184, "synch_weights_time_ms": 44.468}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 312, "training_iteration": 74, "trial_id": "bec7c_00000", "date": "2025-04-27_09-00-20", "timestamp": 1745744420, "time_this_iter_s": 18.457736492156982, "time_total_s": 1405.2380197048187, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1405.2380197048187, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 49.965384615384615, "ram_util_percent": 13.623076923076923}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.007031250000000001, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.441787050983816, "policy_loss": -0.11960343608572599, "vf_loss": 0.002257127804384049, "vf_explained_var": 0.6107459864308757, "kl": 0.004706126192509469, "entropy": 32.44738381293512, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 23095.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.984654999999814, "episode_len_mean": 897.91, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818], "episode_lengths": [900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.468059371678825, "mean_inference_ms": 2.2425695885557326, "mean_action_processing_ms": 0.23839697136382718, "mean_env_wait_ms": 65.98613208109445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052420854568481445, "StateBufferConnector_ms": 0.006376743316650391, "ViewRequirementAgentConnector_ms": 0.15835237503051758}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.984654999999814, "episode_len_mean": 897.91, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.809999999999809, 13.94999999999983, 19.69049999999975, 15.809999999999809, 14.784999999999819, 14.639999999999842, 14.4349999999998, 14.729999999999817, 15.629999999999745, 17.114999999999757, 14.749999999999806, 14.12999999999982, 25.469999999999587, 14.029999999999825, 14.38999999999982, 14.129999999999821, 14.029999999999825, 14.289999999999832, 13.94999999999983, 15.289999999999772, 14.56999999999982, 15.319999999999949, 14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818], "episode_lengths": [900, 900, 691, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.468059371678825, "mean_inference_ms": 2.2425695885557326, "mean_action_processing_ms": 0.23839697136382718, "mean_env_wait_ms": 65.98613208109445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052420854568481445, "StateBufferConnector_ms": 0.006376743316650391, "ViewRequirementAgentConnector_ms": 0.15835237503051758}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.1366190334338, "num_env_steps_trained_throughput_per_sec": 208.1366190334338, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 19163.372, "sample_time_ms": 15399.095, "load_time_ms": 491.487, "load_throughput": 8138.574, "learn_time_ms": 3223.703, "learn_throughput": 1240.809, "synch_weights_time_ms": 45.94}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 314, "training_iteration": 75, "trial_id": "bec7c_00000", "date": "2025-04-27_09-00-39", "timestamp": 1745744439, "time_this_iter_s": 19.2290461063385, "time_total_s": 1424.4670658111572, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1424.4670658111572, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 57.63333333333334, "ram_util_percent": 14.029629629629627}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0035156250000000005, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.41642422793985107, "policy_loss": -0.09383939312049938, "vf_loss": 0.0017871165279258652, "vf_explained_var": 0.7548607157122704, "kl": 0.004994585849541885, "entropy": 32.4389521691107, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 23405.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.829449999999817, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685762663028718, "mean_inference_ms": 2.2498671827033734, "mean_action_processing_ms": 0.23872641054640004, "mean_env_wait_ms": 66.03252467470332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04909515380859375, "StateBufferConnector_ms": 0.006460428237915039, "ViewRequirementAgentConnector_ms": 0.16962194442749023}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.829449999999817, "episode_len_mean": 900.0, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685762663028718, "mean_inference_ms": 2.2498671827033734, "mean_action_processing_ms": 0.23872641054640004, "mean_env_wait_ms": 66.03252467470332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04909515380859375, "StateBufferConnector_ms": 0.006460428237915039, "ViewRequirementAgentConnector_ms": 0.16962194442749023}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.40475924470363, "num_env_steps_trained_throughput_per_sec": 204.40475924470363, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 19254.837, "sample_time_ms": 15509.637, "load_time_ms": 489.955, "load_throughput": 8164.008, "learn_time_ms": 3206.154, "learn_throughput": 1247.601, "synch_weights_time_ms": 45.963}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 336, "training_iteration": 76, "trial_id": "bec7c_00000", "date": "2025-04-27_09-00-59", "timestamp": 1745744459, "time_this_iter_s": 19.577651977539062, "time_total_s": 1444.0447177886963, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1444.0447177886963, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 60.492592592592594, "ram_util_percent": 14.637037037037034}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.42299670175679266, "policy_loss": -0.10384644226681801, "vf_loss": 0.0038229703812600836, "vf_explained_var": 0.6285576535809425, "kl": 0.006003062739599103, "entropy": 32.29837882749496, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.829449999999817, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685762663028718, "mean_inference_ms": 2.2498671827033734, "mean_action_processing_ms": 0.23872641054640004, "mean_env_wait_ms": 66.03252467470332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04909515380859375, "StateBufferConnector_ms": 0.006460428237915039, "ViewRequirementAgentConnector_ms": 0.16962194442749023}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.829449999999817, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685762663028718, "mean_inference_ms": 2.2498671827033734, "mean_action_processing_ms": 0.23872641054640004, "mean_env_wait_ms": 66.03252467470332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04909515380859375, "StateBufferConnector_ms": 0.006460428237915039, "ViewRequirementAgentConnector_ms": 0.16962194442749023}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.1354793019243, "num_env_steps_trained_throughput_per_sec": 217.1354793019243, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 19039.634, "sample_time_ms": 15299.187, "load_time_ms": 499.687, "load_throughput": 8005.011, "learn_time_ms": 3191.468, "learn_throughput": 1253.342, "synch_weights_time_ms": 46.182}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 336, "training_iteration": 77, "trial_id": "bec7c_00000", "date": "2025-04-27_09-01-17", "timestamp": 1745744477, "time_this_iter_s": 18.4298312664032, "time_total_s": 1462.4745490550995, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1462.4745490550995, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 54.8, "ram_util_percent": 13.192307692307692}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3873462184202752, "policy_loss": -0.07174456276059632, "vf_loss": 0.008125911311236127, "vf_explained_var": 0.45317871166813756, "kl": 0.009535304542047845, "entropy": 32.37443320366644, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 24025.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.829449999999817, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685762663028718, "mean_inference_ms": 2.2498671827033734, "mean_action_processing_ms": 0.23872641054640004, "mean_env_wait_ms": 66.03252467470332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04909515380859375, "StateBufferConnector_ms": 0.006460428237915039, "ViewRequirementAgentConnector_ms": 0.16962194442749023}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.829449999999817, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685762663028718, "mean_inference_ms": 2.2498671827033734, "mean_action_processing_ms": 0.23872641054640004, "mean_env_wait_ms": 66.03252467470332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04909515380859375, "StateBufferConnector_ms": 0.006460428237915039, "ViewRequirementAgentConnector_ms": 0.16962194442749023}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.76122111295993, "num_env_steps_trained_throughput_per_sec": 210.76122111295993, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 19071.846, "sample_time_ms": 15330.716, "load_time_ms": 500.599, "load_throughput": 7990.433, "learn_time_ms": 3191.331, "learn_throughput": 1253.396, "synch_weights_time_ms": 46.073}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 336, "training_iteration": 78, "trial_id": "bec7c_00000", "date": "2025-04-27_09-01-36", "timestamp": 1745744496, "time_this_iter_s": 18.98703384399414, "time_total_s": 1481.4615828990936, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1481.4615828990936, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 53.71538461538462, "ram_util_percent": 13.430769230769227}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4359886131054091, "policy_loss": -0.11085202474627764, "vf_loss": 0.0022157483144251127, "vf_explained_var": 0.541466530869084, "kl": 0.005579792572004202, "entropy": 32.736215259182835, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 24335.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.829449999999817, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685762663028718, "mean_inference_ms": 2.2498671827033734, "mean_action_processing_ms": 0.23872641054640004, "mean_env_wait_ms": 66.03252467470332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04909515380859375, "StateBufferConnector_ms": 0.006460428237915039, "ViewRequirementAgentConnector_ms": 0.16962194442749023}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.829449999999817, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.95499999999981, 16.029999999999784, 14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685762663028718, "mean_inference_ms": 2.2498671827033734, "mean_action_processing_ms": 0.23872641054640004, "mean_env_wait_ms": 66.03252467470332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04909515380859375, "StateBufferConnector_ms": 0.006460428237915039, "ViewRequirementAgentConnector_ms": 0.16962194442749023}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.58466423527568, "num_env_steps_trained_throughput_per_sec": 211.58466423527568, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 19126.183, "sample_time_ms": 15342.78, "load_time_ms": 499.717, "load_throughput": 8004.53, "learn_time_ms": 3234.14, "learn_throughput": 1236.805, "synch_weights_time_ms": 46.408}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 336, "training_iteration": 79, "trial_id": "bec7c_00000", "date": "2025-04-27_09-01-55", "timestamp": 1745744515, "time_this_iter_s": 18.913681030273438, "time_total_s": 1500.375263929367, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1500.375263929367, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 57.67037037037038, "ram_util_percent": 13.877777777777778}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.43756013084428325, "policy_loss": -0.11096170017075153, "vf_loss": 0.0016329787628643728, "vf_explained_var": 0.6617224233765756, "kl": 0.0068961389512790655, "entropy": 32.82435394410164, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.823199999999817, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46854429285145394, "mean_inference_ms": 2.250389987574872, "mean_action_processing_ms": 0.2387885151706447, "mean_env_wait_ms": 65.98784051792994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048928260803222656, "StateBufferConnector_ms": 0.0064678192138671875, "ViewRequirementAgentConnector_ms": 0.16959190368652344}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.823199999999817, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.649999999999814, 14.129999999999825, 14.02999999999983, 30.08999999999963, 15.189999999999774, 14.209999999999818, 14.30999999999981, 14.469999999999821, 13.94999999999983, 14.389999999999821, 15.569999999999755, 15.48499999999981, 14.6099999999998, 24.149999999999597, 14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46854429285145394, "mean_inference_ms": 2.250389987574872, "mean_action_processing_ms": 0.2387885151706447, "mean_env_wait_ms": 65.98784051792994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048928260803222656, "StateBufferConnector_ms": 0.0064678192138671875, "ViewRequirementAgentConnector_ms": 0.16959190368652344}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.77066948646984, "num_env_steps_trained_throughput_per_sec": 188.77066948646984, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 19349.976, "sample_time_ms": 15569.528, "load_time_ms": 500.133, "load_throughput": 7997.868, "learn_time_ms": 3230.509, "learn_throughput": 1238.195, "synch_weights_time_ms": 46.651}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 338, "training_iteration": 80, "trial_id": "bec7c_00000", "date": "2025-04-27_09-02-17", "timestamp": 1745744537, "time_this_iter_s": 21.19778037071228, "time_total_s": 1521.5730443000793, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1521.5730443000793, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 57.25172413793104, "ram_util_percent": 14.644827586206894}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.41518106376526936, "policy_loss": -0.08834365078758809, "vf_loss": 0.0012128186050235413, "vf_explained_var": 0.6619522700386663, "kl": 0.007405568602013274, "entropy": 32.80632580172631, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 24955.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.566899999999816, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46904528086240505, "mean_inference_ms": 2.255526571102029, "mean_action_processing_ms": 0.23904473049831418, "mean_env_wait_ms": 65.9254975063777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04820442199707031, "StateBufferConnector_ms": 0.0064618587493896484, "ViewRequirementAgentConnector_ms": 0.16884398460388184}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.566899999999816, "episode_len_mean": 900.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.12999999999982, 14.674999999999798, 15.36999999999977, 16.724999999999774, 15.349999999999813, 14.10999999999982, 14.369999999999811, 14.4399999999998, 15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46904528086240505, "mean_inference_ms": 2.255526571102029, "mean_action_processing_ms": 0.23904473049831418, "mean_env_wait_ms": 65.9254975063777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04820442199707031, "StateBufferConnector_ms": 0.0064618587493896484, "ViewRequirementAgentConnector_ms": 0.16884398460388184}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.50321511745545, "num_env_steps_trained_throughput_per_sec": 208.50321511745545, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 19414.107, "sample_time_ms": 15684.302, "load_time_ms": 500.554, "load_throughput": 7991.153, "learn_time_ms": 3180.039, "learn_throughput": 1257.846, "synch_weights_time_ms": 46.056}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 352, "training_iteration": 81, "trial_id": "bec7c_00000", "date": "2025-04-27_09-02-36", "timestamp": 1745744556, "time_this_iter_s": 19.193581342697144, "time_total_s": 1540.7666256427765, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1540.7666256427765, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 49.87037037037036, "ram_util_percent": 13.070370370370368}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3885419029652351, "policy_loss": -0.07002064469721048, "vf_loss": 0.008910844585114965, "vf_explained_var": 0.7782689819412847, "kl": 0.017247234704829622, "entropy": 32.74624187715592, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 25265.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.57299999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46927271439088536, "mean_inference_ms": 2.2584929702884775, "mean_action_processing_ms": 0.23923852943342727, "mean_env_wait_ms": 66.00589124597069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04809069633483887, "StateBufferConnector_ms": 0.006458282470703125, "ViewRequirementAgentConnector_ms": 0.16875123977661133}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.57299999999982, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46927271439088536, "mean_inference_ms": 2.2584929702884775, "mean_action_processing_ms": 0.23923852943342727, "mean_env_wait_ms": 66.00589124597069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04809069633483887, "StateBufferConnector_ms": 0.006458282470703125, "ViewRequirementAgentConnector_ms": 0.16875123977661133}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.64717443391478, "num_env_steps_trained_throughput_per_sec": 217.64717443391478, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 19180.112, "sample_time_ms": 15433.712, "load_time_ms": 500.686, "load_throughput": 7989.041, "learn_time_ms": 3195.63, "learn_throughput": 1251.709, "synch_weights_time_ms": 46.949}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 360, "training_iteration": 82, "trial_id": "bec7c_00000", "date": "2025-04-27_09-02-54", "timestamp": 1745744574, "time_this_iter_s": 18.386826515197754, "time_total_s": 1559.1534521579742, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1559.1534521579742, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 53.353846153846156, "ram_util_percent": 13.203846153846156}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.39161933536768984, "policy_loss": -0.074225129355346, "vf_loss": 0.010142219400175588, "vf_explained_var": 0.690727162553418, "kl": 0.011011597633055757, "entropy": 32.75557890861265, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.57299999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46927271439088536, "mean_inference_ms": 2.2584929702884775, "mean_action_processing_ms": 0.23923852943342727, "mean_env_wait_ms": 66.00589124597069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04809069633483887, "StateBufferConnector_ms": 0.006458282470703125, "ViewRequirementAgentConnector_ms": 0.16875123977661133}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.57299999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46927271439088536, "mean_inference_ms": 2.2584929702884775, "mean_action_processing_ms": 0.23923852943342727, "mean_env_wait_ms": 66.00589124597069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04809069633483887, "StateBufferConnector_ms": 0.006458282470703125, "ViewRequirementAgentConnector_ms": 0.16875123977661133}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 190.1597210014126, "num_env_steps_trained_throughput_per_sec": 190.1597210014126, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 19332.939, "sample_time_ms": 15589.968, "load_time_ms": 500.687, "load_throughput": 7989.022, "learn_time_ms": 3192.289, "learn_throughput": 1253.019, "synch_weights_time_ms": 46.873}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 360, "training_iteration": 83, "trial_id": "bec7c_00000", "date": "2025-04-27_09-03-15", "timestamp": 1745744595, "time_this_iter_s": 21.042880535125732, "time_total_s": 1580.1963326931, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1580.1963326931, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 48.32000000000001, "ram_util_percent": 13.47333333333333}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4117758535494607, "policy_loss": -0.0899941771862007, "vf_loss": 0.005396662655708027, "vf_explained_var": 0.6147383224579596, "kl": 0.007129996696359388, "entropy": 32.71908784066477, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 25885.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.57299999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46927271439088536, "mean_inference_ms": 2.2584929702884775, "mean_action_processing_ms": 0.23923852943342727, "mean_env_wait_ms": 66.00589124597069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04809069633483887, "StateBufferConnector_ms": 0.006458282470703125, "ViewRequirementAgentConnector_ms": 0.16875123977661133}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.57299999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.009999999999772, 16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46927271439088536, "mean_inference_ms": 2.2584929702884775, "mean_action_processing_ms": 0.23923852943342727, "mean_env_wait_ms": 66.00589124597069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04809069633483887, "StateBufferConnector_ms": 0.006458282470703125, "ViewRequirementAgentConnector_ms": 0.16875123977661133}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.49970345105285, "num_env_steps_trained_throughput_per_sec": 210.49970345105285, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 19388.209, "sample_time_ms": 15654.103, "load_time_ms": 501.452, "load_throughput": 7976.838, "learn_time_ms": 3182.803, "learn_throughput": 1256.754, "synch_weights_time_ms": 46.73}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 360, "training_iteration": 84, "trial_id": "bec7c_00000", "date": "2025-04-27_09-03-34", "timestamp": 1745744614, "time_this_iter_s": 19.010318994522095, "time_total_s": 1599.206651687622, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1599.206651687622, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 51.12592592592593, "ram_util_percent": 13.65925925925926}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.43070908939886476, "policy_loss": -0.10332951932063987, "vf_loss": 0.002083163590900621, "vf_explained_var": 0.7661387818474923, "kl": 0.00782665850282419, "entropy": 32.94764968502906, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 26195.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.568199999999818, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46906626349943026, "mean_inference_ms": 2.2584706935482064, "mean_action_processing_ms": 0.23928574957412865, "mean_env_wait_ms": 65.97800882369141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0483860969543457, "StateBufferConnector_ms": 0.00647425651550293, "ViewRequirementAgentConnector_ms": 0.16900062561035156}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.568199999999818, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.289999999999747, 14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46906626349943026, "mean_inference_ms": 2.2584706935482064, "mean_action_processing_ms": 0.23928574957412865, "mean_env_wait_ms": 65.97800882369141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0483860969543457, "StateBufferConnector_ms": 0.00647425651550293, "ViewRequirementAgentConnector_ms": 0.16900062561035156}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.7057567344502, "num_env_steps_trained_throughput_per_sec": 210.7057567344502, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 19364.777, "sample_time_ms": 15671.979, "load_time_ms": 492.106, "load_throughput": 8128.326, "learn_time_ms": 3152.709, "learn_throughput": 1268.75, "synch_weights_time_ms": 44.901}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 361, "training_iteration": 85, "trial_id": "bec7c_00000", "date": "2025-04-27_09-03-53", "timestamp": 1745744633, "time_this_iter_s": 18.992716550827026, "time_total_s": 1618.199368238449, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1618.199368238449, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 52.38461538461539, "ram_util_percent": 13.607692307692306}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.44653412219091887, "policy_loss": -0.11576299481093884, "vf_loss": 0.0010042497721564536, "vf_explained_var": 0.4109423202853049, "kl": 0.005022670001163797, "entropy": 33.178421168173514, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.55039999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46927063488695325, "mean_inference_ms": 2.259193456157629, "mean_action_processing_ms": 0.23931177283066568, "mean_env_wait_ms": 65.9556195635071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04846954345703125, "StateBufferConnector_ms": 0.006486415863037109, "ViewRequirementAgentConnector_ms": 0.1690659523010254}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.55039999999982, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.379999999999809, 18.4299999999997, 15.429999999999792, 15.049999999999834, 14.489999999999812, 15.109999999999767, 14.20999999999982, 18.62999999999984, 14.389999999999823, 14.029999999999827, 14.309999999999828, 15.8299999999998, 16.049999999999777, 24.609999999999605, 16.289999999999758, 18.66999999999967, 13.94999999999983, 14.209999999999818, 14.469999999999816, 15.56999999999979, 14.309999999999823, 19.129999999999647, 13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46927063488695325, "mean_inference_ms": 2.259193456157629, "mean_action_processing_ms": 0.23931177283066568, "mean_env_wait_ms": 65.9556195635071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04846954345703125, "StateBufferConnector_ms": 0.006486415863037109, "ViewRequirementAgentConnector_ms": 0.1690659523010254}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.8597228539323, "num_env_steps_trained_throughput_per_sec": 210.8597228539323, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 19304.872, "sample_time_ms": 15600.757, "load_time_ms": 492.354, "load_throughput": 8124.238, "learn_time_ms": 3163.672, "learn_throughput": 1264.354, "synch_weights_time_ms": 45.009}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 362, "training_iteration": 86, "trial_id": "bec7c_00000", "date": "2025-04-27_09-04-12", "timestamp": 1745744652, "time_this_iter_s": 18.979024648666382, "time_total_s": 1637.1783928871155, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1637.1783928871155, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 51.3888888888889, "ram_util_percent": 13.62222222222222}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0017578125000000003, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3630518481480859, "policy_loss": -0.06803120255109764, "vf_loss": 0.039283168055502055, "vf_explained_var": 0.643088968530778, "kl": 0.04396841390645286, "entropy": 33.43811067150485, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 26815.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.50844999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964099998649894, "mean_inference_ms": 2.2646662213128876, "mean_action_processing_ms": 0.23960154291891606, "mean_env_wait_ms": 65.95946618554838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04777169227600098, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.16854381561279297}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.50844999999982, "episode_len_mean": 900.0, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964099998649894, "mean_inference_ms": 2.2646662213128876, "mean_action_processing_ms": 0.23960154291891606, "mean_env_wait_ms": 65.95946618554838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04777169227600098, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.16854381561279297}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.54101774628023, "num_env_steps_trained_throughput_per_sec": 222.54101774628023, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 19260.125, "sample_time_ms": 15551.06, "load_time_ms": 482.74, "load_throughput": 8286.038, "learn_time_ms": 3178.631, "learn_throughput": 1258.403, "synch_weights_time_ms": 44.632}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 384, "training_iteration": 87, "trial_id": "bec7c_00000", "date": "2025-04-27_09-04-30", "timestamp": 1745744670, "time_this_iter_s": 17.982654333114624, "time_total_s": 1655.16104722023, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1655.16104722023, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 54.87200000000001, "ram_util_percent": 13.584000000000001}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0026367187499999997, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.300332163312217, "policy_loss": -0.06784239147579478, "vf_loss": 0.10504814765211655, "vf_explained_var": 0.48465090297883556, "kl": 0.047924872262956345, "entropy": 33.76642893514325, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 27125.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.50844999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964099998649894, "mean_inference_ms": 2.2646662213128876, "mean_action_processing_ms": 0.23960154291891606, "mean_env_wait_ms": 65.95946618554838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04777169227600098, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.16854381561279297}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.50844999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964099998649894, "mean_inference_ms": 2.2646662213128876, "mean_action_processing_ms": 0.23960154291891606, "mean_env_wait_ms": 65.95946618554838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04777169227600098, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.16854381561279297}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.50578075540153, "num_env_steps_trained_throughput_per_sec": 212.50578075540153, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 19244.545, "sample_time_ms": 15537.653, "load_time_ms": 483.243, "load_throughput": 8277.417, "learn_time_ms": 3176.13, "learn_throughput": 1259.394, "synch_weights_time_ms": 44.461}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 384, "training_iteration": 88, "trial_id": "bec7c_00000", "date": "2025-04-27_09-04-49", "timestamp": 1745744689, "time_this_iter_s": 18.831095933914185, "time_total_s": 1673.9921431541443, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1673.9921431541443, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 53.892307692307696, "ram_util_percent": 13.61153846153846}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003955078125, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.32045970914224464, "policy_loss": -0.030660788525241397, "vf_loss": 0.05325935473400375, "vf_explained_var": 0.6970261010431474, "kl": 0.027417435910226027, "entropy": 34.31667144529281, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.50844999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964099998649894, "mean_inference_ms": 2.2646662213128876, "mean_action_processing_ms": 0.23960154291891606, "mean_env_wait_ms": 65.95946618554838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04777169227600098, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.16854381561279297}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.50844999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964099998649894, "mean_inference_ms": 2.2646662213128876, "mean_action_processing_ms": 0.23960154291891606, "mean_env_wait_ms": 65.95946618554838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04777169227600098, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.16854381561279297}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.46311964645793, "num_env_steps_trained_throughput_per_sec": 194.46311964645793, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 19410.994, "sample_time_ms": 15736.234, "load_time_ms": 492.268, "load_throughput": 8125.648, "learn_time_ms": 3135.372, "learn_throughput": 1275.766, "synch_weights_time_ms": 44.062}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 384, "training_iteration": 89, "trial_id": "bec7c_00000", "date": "2025-04-27_09-05-10", "timestamp": 1745744710, "time_this_iter_s": 20.577860116958618, "time_total_s": 1694.570003271103, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1694.570003271103, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 49.28620689655173, "ram_util_percent": 13.479310344827589}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.005932617187500002, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4808253406336711, "policy_loss": -0.13691976136047274, "vf_loss": 0.0027651668122299243, "vf_explained_var": 0.6045443805956071, "kl": 0.012642089951663788, "entropy": 34.67457506118282, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 27745.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.50844999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964099998649894, "mean_inference_ms": 2.2646662213128876, "mean_action_processing_ms": 0.23960154291891606, "mean_env_wait_ms": 65.95946618554838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04777169227600098, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.16854381561279297}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.50844999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 14.51499999999986, 54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46964099998649894, "mean_inference_ms": 2.2646662213128876, "mean_action_processing_ms": 0.23960154291891606, "mean_env_wait_ms": 65.95946618554838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04777169227600098, "StateBufferConnector_ms": 0.0065021514892578125, "ViewRequirementAgentConnector_ms": 0.16854381561279297}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.3117861860794, "num_env_steps_trained_throughput_per_sec": 210.3117861860794, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 19193.961, "sample_time_ms": 15527.256, "load_time_ms": 491.508, "load_throughput": 8138.223, "learn_time_ms": 3128.44, "learn_throughput": 1278.592, "synch_weights_time_ms": 43.709}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 384, "training_iteration": 90, "trial_id": "bec7c_00000", "date": "2025-04-27_09-05-29", "timestamp": 1745744729, "time_this_iter_s": 19.02718758583069, "time_total_s": 1713.5971908569336, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1713.5971908569336, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 51.07037037037038, "ram_util_percent": 13.555555555555557}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.005932617187500002, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4758062375706598, "policy_loss": -0.1281926286496943, "vf_loss": 0.0014985519390393165, "vf_explained_var": 0.763955347191903, "kl": 0.010496338372444547, "entropy": 34.917443392353675, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 28055.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.51144999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696526002664089, "mean_inference_ms": 2.265330018413002, "mean_action_processing_ms": 0.23960891732054726, "mean_env_wait_ms": 65.90081647647666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04797840118408203, "StateBufferConnector_ms": 0.006507158279418945, "ViewRequirementAgentConnector_ms": 0.16834068298339844}}, "episode_reward_max": 54.75000000000152, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.51144999999982, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [54.75000000000152, 17.274999999999782, 14.809999999999906, 14.129999999999821, 15.349999999999815, 14.389999999999805, 15.29499999999979, 15.189999999999786, 14.209999999999821, 14.109999999999824, 14.209999999999821, 14.469999999999816, 13.94999999999983, 15.38999999999975, 14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696526002664089, "mean_inference_ms": 2.265330018413002, "mean_action_processing_ms": 0.23960891732054726, "mean_env_wait_ms": 65.90081647647666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04797840118408203, "StateBufferConnector_ms": 0.006507158279418945, "ViewRequirementAgentConnector_ms": 0.16834068298339844}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.08231924240516, "num_env_steps_trained_throughput_per_sec": 219.08231924240516, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 19101.322, "sample_time_ms": 15450.221, "load_time_ms": 490.513, "load_throughput": 8154.727, "learn_time_ms": 3113.892, "learn_throughput": 1284.566, "synch_weights_time_ms": 43.65}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 386, "training_iteration": 91, "trial_id": "bec7c_00000", "date": "2025-04-27_09-05-47", "timestamp": 1745744747, "time_this_iter_s": 18.26586103439331, "time_total_s": 1731.863051891327, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1731.863051891327, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 50.94230769230769, "ram_util_percent": 13.626923076923076}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.005932617187500002, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.42318568929121314, "policy_loss": -0.0729883965405245, "vf_loss": 0.0032705999971738256, "vf_explained_var": 0.70050352600313, "kl": 0.01751573997470616, "entropy": 35.35718145062847, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.506149999999819, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698952996331075, "mean_inference_ms": 2.266971766958404, "mean_action_processing_ms": 0.23972846970449005, "mean_env_wait_ms": 65.82264291148822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04727005958557129, "StateBufferConnector_ms": 0.0064656734466552734, "ViewRequirementAgentConnector_ms": 0.16685152053833008}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.506149999999819, "episode_len_mean": 900.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.26999999999983, 14.849999999999778, 14.369999999999807, 17.1849999999998, 15.26999999999977, 14.38999999999983, 14.954999999999785, 14.129999999999821, 14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4698952996331075, "mean_inference_ms": 2.266971766958404, "mean_action_processing_ms": 0.23972846970449005, "mean_env_wait_ms": 65.82264291148822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04727005958557129, "StateBufferConnector_ms": 0.0064656734466552734, "ViewRequirementAgentConnector_ms": 0.16685152053833008}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.7968051878882, "num_env_steps_trained_throughput_per_sec": 211.7968051878882, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 19152.088, "sample_time_ms": 15518.17, "load_time_ms": 490.244, "load_throughput": 8159.198, "learn_time_ms": 3096.893, "learn_throughput": 1291.617, "synch_weights_time_ms": 43.746}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 400, "training_iteration": 92, "trial_id": "bec7c_00000", "date": "2025-04-27_09-06-06", "timestamp": 1745744766, "time_this_iter_s": 18.895216941833496, "time_total_s": 1750.7582688331604, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1750.7582688331604, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 51.57307692307692, "ram_util_percent": 13.665384615384614}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.005932617187500002, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3924934285125815, "policy_loss": -0.04617569261050272, "vf_loss": 0.008565729445918775, "vf_explained_var": 0.7010542296594189, "kl": 0.0490057540149381, "entropy": 35.51742045494818, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 28675.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.520249999999816, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47002222908460695, "mean_inference_ms": 2.2678680214016596, "mean_action_processing_ms": 0.2398501527899329, "mean_env_wait_ms": 65.90313091768323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04717421531677246, "StateBufferConnector_ms": 0.0064697265625, "ViewRequirementAgentConnector_ms": 0.16713786125183105}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.520249999999816, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47002222908460695, "mean_inference_ms": 2.2678680214016596, "mean_action_processing_ms": 0.2398501527899329, "mean_env_wait_ms": 65.90313091768323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04717421531677246, "StateBufferConnector_ms": 0.0064697265625, "ViewRequirementAgentConnector_ms": 0.16713786125183105}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.33100427166087, "num_env_steps_trained_throughput_per_sec": 224.33100427166087, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 18831.674, "sample_time_ms": 15199.399, "load_time_ms": 489.784, "load_throughput": 8166.872, "learn_time_ms": 3095.428, "learn_throughput": 1292.228, "synch_weights_time_ms": 44.008}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 408, "training_iteration": 93, "trial_id": "bec7c_00000", "date": "2025-04-27_09-06-24", "timestamp": 1745744784, "time_this_iter_s": 17.83980441093445, "time_total_s": 1768.5980732440948, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1768.5980732440948, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 55.584, "ram_util_percent": 13.62}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.008898925781249999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.40019348043903347, "policy_loss": -0.05254773292089662, "vf_loss": 0.00798233879777986, "vf_explained_var": 0.6148003247476393, "kl": 0.01560777918102186, "entropy": 35.57669854933216, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 28985.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.520249999999816, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47002222908460695, "mean_inference_ms": 2.2678680214016596, "mean_action_processing_ms": 0.2398501527899329, "mean_env_wait_ms": 65.90313091768323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04717421531677246, "StateBufferConnector_ms": 0.0064697265625, "ViewRequirementAgentConnector_ms": 0.16713786125183105}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.520249999999816, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47002222908460695, "mean_inference_ms": 2.2678680214016596, "mean_action_processing_ms": 0.2398501527899329, "mean_env_wait_ms": 65.90313091768323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04717421531677246, "StateBufferConnector_ms": 0.0064697265625, "ViewRequirementAgentConnector_ms": 0.16713786125183105}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 192.09865589120474, "num_env_steps_trained_throughput_per_sec": 192.09865589120474, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 19013.697, "sample_time_ms": 15374.086, "load_time_ms": 489.843, "load_throughput": 8165.875, "learn_time_ms": 3102.608, "learn_throughput": 1289.238, "synch_weights_time_ms": 44.095}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 408, "training_iteration": 94, "trial_id": "bec7c_00000", "date": "2025-04-27_09-06-45", "timestamp": 1745744805, "time_this_iter_s": 20.83095383644104, "time_total_s": 1789.429027080536, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1789.429027080536, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 48.20689655172412, "ram_util_percent": 13.482758620689658}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.008898925781249999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4717404511434236, "policy_loss": -0.11222482226308315, "vf_loss": 0.0020298657577035146, "vf_explained_var": 0.6743790626525878, "kl": 0.012560265998434907, "entropy": 36.16572766457835, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.520249999999816, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47002222908460695, "mean_inference_ms": 2.2678680214016596, "mean_action_processing_ms": 0.2398501527899329, "mean_env_wait_ms": 65.90313091768323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04717421531677246, "StateBufferConnector_ms": 0.0064697265625, "ViewRequirementAgentConnector_ms": 0.16713786125183105}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.520249999999816, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999826, 26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.47002222908460695, "mean_inference_ms": 2.2678680214016596, "mean_action_processing_ms": 0.2398501527899329, "mean_env_wait_ms": 65.90313091768323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04717421531677246, "StateBufferConnector_ms": 0.0064697265625, "ViewRequirementAgentConnector_ms": 0.16713786125183105}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.30897899097457, "num_env_steps_trained_throughput_per_sec": 208.30897899097457, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 19035.54, "sample_time_ms": 15416.802, "load_time_ms": 489.67, "load_throughput": 8168.76, "learn_time_ms": 3082.238, "learn_throughput": 1297.758, "synch_weights_time_ms": 43.736}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 408, "training_iteration": 95, "trial_id": "bec7c_00000", "date": "2025-04-27_09-07-04", "timestamp": 1745744824, "time_this_iter_s": 19.210509538650513, "time_total_s": 1808.6395366191864, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1808.6395366191864, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 50.27407407407408, "ram_util_percent": 13.255555555555558}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.008898925781249999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.48079147663928806, "policy_loss": -0.12099874869529759, "vf_loss": 0.0009970871605013776, "vf_explained_var": 0.608749400031182, "kl": 0.007981417806877288, "entropy": 36.086085054951326, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 29605.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.519249999999818, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46981444659049393, "mean_inference_ms": 2.267783367346187, "mean_action_processing_ms": 0.23990143362177968, "mean_env_wait_ms": 65.87629168322303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04743218421936035, "StateBufferConnector_ms": 0.006482124328613281, "ViewRequirementAgentConnector_ms": 0.167283296585083}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.519249999999818, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.989999999999586, 14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46981444659049393, "mean_inference_ms": 2.267783367346187, "mean_action_processing_ms": 0.23990143362177968, "mean_env_wait_ms": 65.87629168322303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04743218421936035, "StateBufferConnector_ms": 0.006482124328613281, "ViewRequirementAgentConnector_ms": 0.167283296585083}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.49172381131967, "num_env_steps_trained_throughput_per_sec": 216.49172381131967, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 18986.19, "sample_time_ms": 15368.101, "load_time_ms": 491.089, "load_throughput": 8145.156, "learn_time_ms": 3080.63, "learn_throughput": 1298.436, "synch_weights_time_ms": 43.25}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 409, "training_iteration": 96, "trial_id": "bec7c_00000", "date": "2025-04-27_09-07-22", "timestamp": 1745744842, "time_this_iter_s": 18.48454523086548, "time_total_s": 1827.1240818500519, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1827.1240818500519, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 53.607692307692304, "ram_util_percent": 13.011538461538464}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.008898925781249999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.45939903987811936, "policy_loss": -0.10008514484150276, "vf_loss": 0.0015292993020510392, "vf_explained_var": 0.5641802847385406, "kl": 0.010643140563033447, "entropy": 36.09379124795237, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 29915.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.388849999999819, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4700251016548269, "mean_inference_ms": 2.268275929748489, "mean_action_processing_ms": 0.23986151597140196, "mean_env_wait_ms": 65.85238897399216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04744076728820801, "StateBufferConnector_ms": 0.006494045257568359, "ViewRequirementAgentConnector_ms": 0.16735529899597168}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.388849999999819, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999832, 14.829999999999815, 16.334999999999795, 14.189999999999818, 14.469999999999834, 15.449999999999777, 14.919999999999781, 16.139999999999777, 13.94999999999983, 15.089999999999774, 14.109999999999824, 15.379999999999814, 14.269999999999825, 14.10999999999982, 14.30999999999982, 14.729999999999801, 14.30999999999981, 15.54999999999981, 14.389999999999823, 15.009999999999808, 14.389999999999823, 14.629999999999814, 15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4700251016548269, "mean_inference_ms": 2.268275929748489, "mean_action_processing_ms": 0.23986151597140196, "mean_env_wait_ms": 65.85238897399216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04744076728820801, "StateBufferConnector_ms": 0.006494045257568359, "ViewRequirementAgentConnector_ms": 0.16735529899597168}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.1890218406971, "num_env_steps_trained_throughput_per_sec": 213.1890218406971, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 19065.038, "sample_time_ms": 15443.766, "load_time_ms": 491.299, "load_throughput": 8141.678, "learn_time_ms": 3083.232, "learn_throughput": 1297.34, "synch_weights_time_ms": 43.603}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 410, "training_iteration": 97, "trial_id": "bec7c_00000", "date": "2025-04-27_09-07-41", "timestamp": 1745744861, "time_this_iter_s": 18.770639181137085, "time_total_s": 1845.894721031189, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1845.894721031189, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 52.36923076923077, "ram_util_percent": 12.996153846153845}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.008898925781249999, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.38417648345892946, "policy_loss": -0.07033489109918235, "vf_loss": 0.052505858522108026, "vf_explained_var": 0.6847739017778828, "kl": 0.051175419235768196, "entropy": 36.680286481303554, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.46589999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46998621244114025, "mean_inference_ms": 2.2678209170724655, "mean_action_processing_ms": 0.23983801489892137, "mean_env_wait_ms": 65.84662366337719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04629349708557129, "StateBufferConnector_ms": 0.006461620330810547, "ViewRequirementAgentConnector_ms": 0.15711164474487305}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.46589999999982, "episode_len_mean": 900.0, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46998621244114025, "mean_inference_ms": 2.2678209170724655, "mean_action_processing_ms": 0.23983801489892137, "mean_env_wait_ms": 65.84662366337719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04629349708557129, "StateBufferConnector_ms": 0.006461620330810547, "ViewRequirementAgentConnector_ms": 0.15711164474487305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.7861056343164, "num_env_steps_trained_throughput_per_sec": 221.7861056343164, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 18986.276, "sample_time_ms": 15368.123, "load_time_ms": 490.28, "load_throughput": 8158.603, "learn_time_ms": 3081.082, "learn_throughput": 1298.245, "synch_weights_time_ms": 43.654}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 432, "training_iteration": 98, "trial_id": "bec7c_00000", "date": "2025-04-27_09-07-59", "timestamp": 1745744879, "time_this_iter_s": 18.044270992279053, "time_total_s": 1863.938992023468, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1863.938992023468, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 53.3423076923077, "ram_util_percent": 12.503846153846153}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.013348388671875, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.28324494639021014, "policy_loss": -0.0749804231428331, "vf_loss": 0.16186689948062263, "vf_explained_var": 0.35680624708052605, "kl": 0.06800622441625173, "entropy": 37.10392094273721, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 30535.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.46589999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46998621244114025, "mean_inference_ms": 2.2678209170724655, "mean_action_processing_ms": 0.23983801489892137, "mean_env_wait_ms": 65.84662366337719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04629349708557129, "StateBufferConnector_ms": 0.006461620330810547, "ViewRequirementAgentConnector_ms": 0.15711164474487305}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.46589999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46998621244114025, "mean_inference_ms": 2.2678209170724655, "mean_action_processing_ms": 0.23983801489892137, "mean_env_wait_ms": 65.84662366337719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04629349708557129, "StateBufferConnector_ms": 0.006461620330810547, "ViewRequirementAgentConnector_ms": 0.15711164474487305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.38927315720161, "num_env_steps_trained_throughput_per_sec": 205.38927315720161, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 18876.852, "sample_time_ms": 15263.751, "load_time_ms": 483.314, "load_throughput": 8276.198, "learn_time_ms": 3082.91, "learn_throughput": 1297.475, "synch_weights_time_ms": 43.724}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 432, "training_iteration": 99, "trial_id": "bec7c_00000", "date": "2025-04-27_09-08-19", "timestamp": 1745744899, "time_this_iter_s": 19.483577728271484, "time_total_s": 1883.4225697517395, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1883.4225697517395, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 52.74074074074073, "ram_util_percent": 12.811111111111112}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0200225830078125, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.2953811438934457, "policy_loss": -0.03213131166994572, "vf_loss": 0.11907077715492755, "vf_explained_var": 0.6378150249681165, "kl": 0.09816033156127693, "entropy": 38.428604113671085, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 30845.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.46589999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46998621244114025, "mean_inference_ms": 2.2678209170724655, "mean_action_processing_ms": 0.23983801489892137, "mean_env_wait_ms": 65.84662366337719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04629349708557129, "StateBufferConnector_ms": 0.006461620330810547, "ViewRequirementAgentConnector_ms": 0.15711164474487305}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.46589999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46998621244114025, "mean_inference_ms": 2.2678209170724655, "mean_action_processing_ms": 0.23983801489892137, "mean_env_wait_ms": 65.84662366337719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04629349708557129, "StateBufferConnector_ms": 0.006461620330810547, "ViewRequirementAgentConnector_ms": 0.15711164474487305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.02305040288252, "num_env_steps_trained_throughput_per_sec": 187.02305040288252, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 19113.687, "sample_time_ms": 15494.004, "load_time_ms": 483.101, "load_throughput": 8279.839, "learn_time_ms": 3089.218, "learn_throughput": 1294.826, "synch_weights_time_ms": 44.219}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 432, "training_iteration": 100, "trial_id": "bec7c_00000", "date": "2025-04-27_09-08-40", "timestamp": 1745744920, "time_this_iter_s": 21.395402193069458, "time_total_s": 1904.817971944809, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1904.817971944809, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 46.89000000000001, "ram_util_percent": 12.920000000000003}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.030033874511718746, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5036464527609849, "policy_loss": -0.1207346857375195, "vf_loss": 0.005488014208892691, "vf_explained_var": 0.5985994623553368, "kl": 0.013155964113614192, "entropy": 38.879491781419325, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.46589999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46998621244114025, "mean_inference_ms": 2.2678209170724655, "mean_action_processing_ms": 0.23983801489892137, "mean_env_wait_ms": 65.84662366337719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04629349708557129, "StateBufferConnector_ms": 0.006461620330810547, "ViewRequirementAgentConnector_ms": 0.15711164474487305}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.46589999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.649999999999814, 15.08499999999982, 14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46998621244114025, "mean_inference_ms": 2.2678209170724655, "mean_action_processing_ms": 0.23983801489892137, "mean_env_wait_ms": 65.84662366337719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04629349708557129, "StateBufferConnector_ms": 0.006461620330810547, "ViewRequirementAgentConnector_ms": 0.15711164474487305}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.08383264138104, "num_env_steps_trained_throughput_per_sec": 219.08383264138104, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 19113.675, "sample_time_ms": 15471.862, "load_time_ms": 484.85, "load_throughput": 8249.98, "learn_time_ms": 3110.186, "learn_throughput": 1286.097, "synch_weights_time_ms": 43.627}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 432, "training_iteration": 101, "trial_id": "bec7c_00000", "date": "2025-04-27_09-08-59", "timestamp": 1745744939, "time_this_iter_s": 18.26615262031555, "time_total_s": 1923.0841245651245, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1923.0841245651245, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 52.49230769230769, "ram_util_percent": 12.996153846153845}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.030033874511718746, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5018217595264075, "policy_loss": -0.11684644451485046, "vf_loss": 0.003853892878466849, "vf_explained_var": 0.7298028659436011, "kl": 0.012597387087190591, "entropy": 38.920757416755926, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 31465.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.453599999999822, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4699192063346444, "mean_inference_ms": 2.2679523322376123, "mean_action_processing_ms": 0.23983917060574045, "mean_env_wait_ms": 65.79619522428496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04630398750305176, "StateBufferConnector_ms": 0.006433010101318359, "ViewRequirementAgentConnector_ms": 0.15630459785461426}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.453599999999822, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.369999999999827, 14.10999999999983, 15.529999999999783, 14.829999999999833, 13.94999999999983, 14.12999999999982, 14.18999999999982, 15.569999999999759, 14.129999999999832, 14.209999999999816, 15.094999999999837, 15.3699999999998, 15.289999999999779, 14.209999999999816, 14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4699192063346444, "mean_inference_ms": 2.2679523322376123, "mean_action_processing_ms": 0.23983917060574045, "mean_env_wait_ms": 65.79619522428496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04630398750305176, "StateBufferConnector_ms": 0.006433010101318359, "ViewRequirementAgentConnector_ms": 0.15630459785461426}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.22056321941352, "num_env_steps_trained_throughput_per_sec": 216.22056321941352, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 19075.035, "sample_time_ms": 15422.066, "load_time_ms": 484.903, "load_throughput": 8249.07, "learn_time_ms": 3121.522, "learn_throughput": 1281.426, "synch_weights_time_ms": 43.366}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 434, "training_iteration": 102, "trial_id": "bec7c_00000", "date": "2025-04-27_09-09-17", "timestamp": 1745744957, "time_this_iter_s": 18.507999181747437, "time_total_s": 1941.592123746872, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1941.592123746872, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 53.73461538461539, "ram_util_percent": 13.049999999999999}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.030033874511718746, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4559599217568194, "policy_loss": -0.0813557383394049, "vf_loss": 0.014330309007158164, "vf_explained_var": 0.7951211587075264, "kl": 0.013808557714189866, "entropy": 38.93492315969159, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 31775.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.559949999999821, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4697866618502766, "mean_inference_ms": 2.2665951111761085, "mean_action_processing_ms": 0.23965645399120405, "mean_env_wait_ms": 65.75054661724442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04679155349731445, "StateBufferConnector_ms": 0.0065157413482666016, "ViewRequirementAgentConnector_ms": 0.1592555046081543}}, "episode_reward_max": 58.19000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.559949999999821, "episode_len_mean": 900.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999818, 14.829999999999803, 14.209999999999818, 14.209999999999821, 15.009999999999804, 14.129999999999832, 14.469999999999809, 14.209999999999827, 14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4697866618502766, "mean_inference_ms": 2.2665951111761085, "mean_action_processing_ms": 0.23965645399120405, "mean_env_wait_ms": 65.75054661724442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04679155349731445, "StateBufferConnector_ms": 0.0065157413482666016, "ViewRequirementAgentConnector_ms": 0.1592555046081543}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.50540930577287, "num_env_steps_trained_throughput_per_sec": 212.50540930577287, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 19174.261, "sample_time_ms": 15521.19, "load_time_ms": 485.722, "load_throughput": 8235.167, "learn_time_ms": 3120.45, "learn_throughput": 1281.867, "synch_weights_time_ms": 43.727}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 448, "training_iteration": 103, "trial_id": "bec7c_00000", "date": "2025-04-27_09-09-36", "timestamp": 1745744976, "time_this_iter_s": 18.83292293548584, "time_total_s": 1960.4250466823578, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1960.4250466823578, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 51.47407407407406, "ram_util_percent": 13.092592592592595}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.030033874511718746, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4604702095365933, "policy_loss": -0.09438833737325283, "vf_loss": 0.0202075746672504, "vf_explained_var": 0.5499769003160538, "kl": 0.020649105217260863, "entropy": 38.690962489958736, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.148749999999836, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696581513231141, "mean_inference_ms": 2.2661572881791883, "mean_action_processing_ms": 0.23964023723796082, "mean_env_wait_ms": 65.79355212033666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047270774841308594, "StateBufferConnector_ms": 0.006543636322021484, "ViewRequirementAgentConnector_ms": 0.16064763069152832}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.148749999999836, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696581513231141, "mean_inference_ms": 2.2661572881791883, "mean_action_processing_ms": 0.23964023723796082, "mean_env_wait_ms": 65.79355212033666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047270774841308594, "StateBufferConnector_ms": 0.006543636322021484, "ViewRequirementAgentConnector_ms": 0.16064763069152832}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.90092657661336, "num_env_steps_trained_throughput_per_sec": 207.90092657661336, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 19015.99, "sample_time_ms": 15354.124, "load_time_ms": 485.005, "load_throughput": 8247.332, "learn_time_ms": 3129.18, "learn_throughput": 1278.29, "synch_weights_time_ms": 44.515}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 456, "training_iteration": 104, "trial_id": "bec7c_00000", "date": "2025-04-27_09-09-55", "timestamp": 1745744995, "time_this_iter_s": 19.24867033958435, "time_total_s": 1979.6737170219421, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1979.6737170219421, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 52.65925925925926, "ram_util_percent": 12.888888888888891}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.04505081176757813, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4439164362629996, "policy_loss": -0.0647967265265423, "vf_loss": 0.00934853834784125, "vf_explained_var": 0.6824278518076866, "kl": 0.02538902475963339, "entropy": 38.961205279442574, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 32395.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.148749999999836, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696581513231141, "mean_inference_ms": 2.2661572881791883, "mean_action_processing_ms": 0.23964023723796082, "mean_env_wait_ms": 65.79355212033666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047270774841308594, "StateBufferConnector_ms": 0.006543636322021484, "ViewRequirementAgentConnector_ms": 0.16064763069152832}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.148749999999836, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696581513231141, "mean_inference_ms": 2.2661572881791883, "mean_action_processing_ms": 0.23964023723796082, "mean_env_wait_ms": 65.79355212033666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047270774841308594, "StateBufferConnector_ms": 0.006543636322021484, "ViewRequirementAgentConnector_ms": 0.16064763069152832}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.01575083684395, "num_env_steps_trained_throughput_per_sec": 207.01575083684395, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 19027.986, "sample_time_ms": 15350.644, "load_time_ms": 494.172, "load_throughput": 8094.344, "learn_time_ms": 3135.471, "learn_throughput": 1275.725, "synch_weights_time_ms": 44.567}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 456, "training_iteration": 105, "trial_id": "bec7c_00000", "date": "2025-04-27_09-10-15", "timestamp": 1745745015, "time_this_iter_s": 19.330267190933228, "time_total_s": 1999.0039842128754, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1999.0039842128754, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 52.177777777777784, "ram_util_percent": 13.148148148148149}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.06757621765136719, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4865355957866526, "policy_loss": -0.09471169269133, "vf_loss": 0.002070608748087374, "vf_explained_var": 0.7003787640602358, "kl": 0.01043353614588869, "entropy": 39.459958390266664, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 32705.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.148749999999836, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696581513231141, "mean_inference_ms": 2.2661572881791883, "mean_action_processing_ms": 0.23964023723796082, "mean_env_wait_ms": 65.79355212033666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047270774841308594, "StateBufferConnector_ms": 0.006543636322021484, "ViewRequirementAgentConnector_ms": 0.16064763069152832}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.148749999999836, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.289999999999814, 19.429999999999655, 14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4696581513231141, "mean_inference_ms": 2.2661572881791883, "mean_action_processing_ms": 0.23964023723796082, "mean_env_wait_ms": 65.79355212033666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047270774841308594, "StateBufferConnector_ms": 0.006543636322021484, "ViewRequirementAgentConnector_ms": 0.16064763069152832}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.98381380591675, "num_env_steps_trained_throughput_per_sec": 220.98381380591675, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 18990.427, "sample_time_ms": 15315.097, "load_time_ms": 492.458, "load_throughput": 8122.513, "learn_time_ms": 3134.545, "learn_throughput": 1276.102, "synch_weights_time_ms": 45.204}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 456, "training_iteration": 106, "trial_id": "bec7c_00000", "date": "2025-04-27_09-10-33", "timestamp": 1745745033, "time_this_iter_s": 18.109187841415405, "time_total_s": 2017.1131720542908, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2017.1131720542908, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 51.94615384615385, "ram_util_percent": 13.296153846153848}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.06757621765136719, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4928921559226564, "policy_loss": -0.09966742494143546, "vf_loss": 0.0021486159858121086, "vf_explained_var": 0.6224335485889065, "kl": 0.013449131994443605, "entropy": 39.62821946913196, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.125149999999834, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4695749858577837, "mean_inference_ms": 2.266183860788968, "mean_action_processing_ms": 0.23964346925530614, "mean_env_wait_ms": 65.7519773065094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04737710952758789, "StateBufferConnector_ms": 0.006582975387573242, "ViewRequirementAgentConnector_ms": 0.16077947616577148}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.125149999999834, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.10999999999982, 14.129999999999821, 14.52999999999981, 14.509999999999833, 14.30999999999981, 16.604999999999787, 16.059999999999793, 15.684999999999771, 20.269999999999648, 13.94999999999983, 14.289999999999818, 14.674999999999786, 24.769999999999587, 14.129999999999827, 14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4695749858577837, "mean_inference_ms": 2.266183860788968, "mean_action_processing_ms": 0.23964346925530614, "mean_env_wait_ms": 65.7519773065094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04737710952758789, "StateBufferConnector_ms": 0.006582975387573242, "ViewRequirementAgentConnector_ms": 0.16077947616577148}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.61291221968682, "num_env_steps_trained_throughput_per_sec": 218.61291221968682, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 18943.876, "sample_time_ms": 15272.122, "load_time_ms": 491.548, "load_throughput": 8137.555, "learn_time_ms": 3131.888, "learn_throughput": 1277.185, "synch_weights_time_ms": 45.158}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 458, "training_iteration": 107, "trial_id": "bec7c_00000", "date": "2025-04-27_09-10-51", "timestamp": 1745745051, "time_this_iter_s": 18.305623531341553, "time_total_s": 2035.4187955856323, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2035.4187955856323, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 52.891999999999996, "ram_util_percent": 13.304}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.06757621765136719, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3851787748596361, "policy_loss": -0.040734864576088804, "vf_loss": 0.052093847892003046, "vf_explained_var": 0.5741355459536276, "kl": 0.04336075285236509, "entropy": 39.946791667322955, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 33325.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.220299999999842, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46949248910520613, "mean_inference_ms": 2.2653205708164426, "mean_action_processing_ms": 0.23950270008040558, "mean_env_wait_ms": 65.69854637767759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04730820655822754, "StateBufferConnector_ms": 0.006606101989746094, "ViewRequirementAgentConnector_ms": 0.16116762161254883}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.220299999999842, "episode_len_mean": 900.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.30999999999982, 14.469999999999805, 14.129999999999832, 15.709999999999745, 13.94999999999983, 14.214999999999819, 14.389999999999814, 14.28999999999981, 15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46949248910520613, "mean_inference_ms": 2.2653205708164426, "mean_action_processing_ms": 0.23950270008040558, "mean_env_wait_ms": 65.69854637767759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04730820655822754, "StateBufferConnector_ms": 0.006606101989746094, "ViewRequirementAgentConnector_ms": 0.16116762161254883}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.4650471975896, "num_env_steps_trained_throughput_per_sec": 219.4650471975896, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 18962.95, "sample_time_ms": 15284.461, "load_time_ms": 491.027, "load_throughput": 8146.191, "learn_time_ms": 3138.454, "learn_throughput": 1274.513, "synch_weights_time_ms": 45.861}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 472, "training_iteration": 108, "trial_id": "bec7c_00000", "date": "2025-04-27_09-11-09", "timestamp": 1745745069, "time_this_iter_s": 18.234796285629272, "time_total_s": 2053.6535918712616, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2053.6535918712616, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 53.076923076923066, "ram_util_percent": 13.292307692307695}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10136432647705076, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.26613947927365983, "policy_loss": -0.09404937596090378, "vf_loss": 0.22054389332000526, "vf_explained_var": 0.2402059697335766, "kl": 0.05412982356525214, "entropy": 39.81208434566375, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 33635.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.19884999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46934597250544113, "mean_inference_ms": 2.2646875275792286, "mean_action_processing_ms": 0.23947974019074994, "mean_env_wait_ms": 65.73666985268478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04714226722717285, "StateBufferConnector_ms": 0.006566524505615234, "ViewRequirementAgentConnector_ms": 0.1602015495300293}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.19884999999984, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46934597250544113, "mean_inference_ms": 2.2646875275792286, "mean_action_processing_ms": 0.23947974019074994, "mean_env_wait_ms": 65.73666985268478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04714226722717285, "StateBufferConnector_ms": 0.006566524505615234, "ViewRequirementAgentConnector_ms": 0.1602015495300293}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.4401195490508, "num_env_steps_trained_throughput_per_sec": 219.4401195490508, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 18838.249, "sample_time_ms": 15171.06, "load_time_ms": 489.406, "load_throughput": 8173.168, "learn_time_ms": 3128.958, "learn_throughput": 1278.381, "synch_weights_time_ms": 45.715}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 480, "training_iteration": 109, "trial_id": "bec7c_00000", "date": "2025-04-27_09-11-28", "timestamp": 1745745088, "time_this_iter_s": 18.23659920692444, "time_total_s": 2071.890191078186, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2071.890191078186, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 55.176, "ram_util_percent": 13.34}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1520464897155762, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.15584512208888848, "policy_loss": -0.06899573198489604, "vf_loss": 0.307540415251682, "vf_explained_var": 0.45725585664472274, "kl": 0.038161823059682874, "entropy": 40.01921874015562, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.19884999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46934597250544113, "mean_inference_ms": 2.2646875275792286, "mean_action_processing_ms": 0.23947974019074994, "mean_env_wait_ms": 65.73666985268478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04714226722717285, "StateBufferConnector_ms": 0.006566524505615234, "ViewRequirementAgentConnector_ms": 0.1602015495300293}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.19884999999984, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46934597250544113, "mean_inference_ms": 2.2646875275792286, "mean_action_processing_ms": 0.23947974019074994, "mean_env_wait_ms": 65.73666985268478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04714226722717285, "StateBufferConnector_ms": 0.006566524505615234, "ViewRequirementAgentConnector_ms": 0.1602015495300293}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.98142684567935, "num_env_steps_trained_throughput_per_sec": 191.98142684567935, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 18783.011, "sample_time_ms": 15117.28, "load_time_ms": 489.729, "load_throughput": 8167.785, "learn_time_ms": 3127.105, "learn_throughput": 1279.138, "synch_weights_time_ms": 45.751}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 480, "training_iteration": 110, "trial_id": "bec7c_00000", "date": "2025-04-27_09-11-48", "timestamp": 1745745108, "time_this_iter_s": 20.844040632247925, "time_total_s": 2092.734231710434, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2092.734231710434, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 50.65517241379311, "ram_util_percent": 13.26551724137931}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22806973457336427, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.49580528443949595, "policy_loss": -0.10877959470474913, "vf_loss": 0.015649307895387942, "vf_explained_var": 0.6782071428914224, "kl": 0.01162794235438454, "entropy": 40.53269841594081, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 34255.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.19884999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46934597250544113, "mean_inference_ms": 2.2646875275792286, "mean_action_processing_ms": 0.23947974019074994, "mean_env_wait_ms": 65.73666985268478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04714226722717285, "StateBufferConnector_ms": 0.006566524505615234, "ViewRequirementAgentConnector_ms": 0.1602015495300293}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.19884999999984, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.00999999999983, 19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46934597250544113, "mean_inference_ms": 2.2646875275792286, "mean_action_processing_ms": 0.23947974019074994, "mean_env_wait_ms": 65.73666985268478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04714226722717285, "StateBufferConnector_ms": 0.006566524505615234, "ViewRequirementAgentConnector_ms": 0.1602015495300293}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.08691202561974, "num_env_steps_trained_throughput_per_sec": 210.08691202561974, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 18861.2, "sample_time_ms": 15199.665, "load_time_ms": 489.256, "load_throughput": 8175.679, "learn_time_ms": 3123.276, "learn_throughput": 1280.707, "synch_weights_time_ms": 45.843}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 480, "training_iteration": 111, "trial_id": "bec7c_00000", "date": "2025-04-27_09-12-08", "timestamp": 1745745128, "time_this_iter_s": 19.0478036403656, "time_total_s": 2111.7820353507996, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2111.7820353507996, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 53.75555555555555, "ram_util_percent": 13.107407407407411}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22806973457336427, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5253196506009948, "policy_loss": -0.126743769951375, "vf_loss": 0.00551586713287003, "vf_explained_var": 0.7597181218285715, "kl": 0.007201008613652271, "entropy": 40.573408963603356, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 34565.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.21234999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4690866468669088, "mean_inference_ms": 2.2643870271585538, "mean_action_processing_ms": 0.2395173775321617, "mean_env_wait_ms": 65.70342118634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04715323448181152, "StateBufferConnector_ms": 0.0065691471099853516, "ViewRequirementAgentConnector_ms": 0.1601855754852295}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.21234999999984, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.274999999999714, 15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4690866468669088, "mean_inference_ms": 2.2643870271585538, "mean_action_processing_ms": 0.2395173775321617, "mean_env_wait_ms": 65.70342118634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04715323448181152, "StateBufferConnector_ms": 0.0065691471099853516, "ViewRequirementAgentConnector_ms": 0.1601855754852295}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.70199877268607, "num_env_steps_trained_throughput_per_sec": 219.70199877268607, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 18831.885, "sample_time_ms": 15170.865, "load_time_ms": 489.267, "load_throughput": 8175.503, "learn_time_ms": 3123.098, "learn_throughput": 1280.779, "synch_weights_time_ms": 45.526}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 481, "training_iteration": 112, "trial_id": "bec7c_00000", "date": "2025-04-27_09-12-26", "timestamp": 1745745146, "time_this_iter_s": 18.21474814414978, "time_total_s": 2129.9967834949493, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2129.9967834949493, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 54.00384615384617, "ram_util_percent": 12.899999999999999}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22806973457336427, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5219590586189541, "policy_loss": -0.11837910872793966, "vf_loss": 0.003228367199200523, "vf_explained_var": 0.6371507033225029, "kl": 0.006547044230213825, "entropy": 40.8301513671875, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.15989999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4692699473046544, "mean_inference_ms": 2.2647261375589163, "mean_action_processing_ms": 0.23948791007405515, "mean_env_wait_ms": 65.69045284732496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04715275764465332, "StateBufferConnector_ms": 0.006594657897949219, "ViewRequirementAgentConnector_ms": 0.16011643409729004}}, "episode_reward_max": 67.83000000000159, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.15989999999984, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.3499999999998, 17.50999999999967, 14.389999999999821, 14.374999999999844, 15.469999999999791, 14.109999999999825, 14.309999999999818, 14.209999999999821, 15.289999999999752, 14.189999999999825, 14.389999999999809, 58.19000000000157, 14.02999999999983, 14.30999999999982, 14.029999999999825, 14.829999999999801, 15.60999999999978, 14.02999999999983, 15.109999999999804, 14.209999999999818, 14.309999999999823, 14.209999999999818, 14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4692699473046544, "mean_inference_ms": 2.2647261375589163, "mean_action_processing_ms": 0.23948791007405515, "mean_env_wait_ms": 65.69045284732496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04715275764465332, "StateBufferConnector_ms": 0.006594657897949219, "ViewRequirementAgentConnector_ms": 0.16011643409729004}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.3017948400686, "num_env_steps_trained_throughput_per_sec": 212.3017948400686, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 18833.69, "sample_time_ms": 15169.333, "load_time_ms": 488.59, "load_throughput": 8186.818, "learn_time_ms": 3127.915, "learn_throughput": 1278.807, "synch_weights_time_ms": 44.721}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 482, "training_iteration": 113, "trial_id": "bec7c_00000", "date": "2025-04-27_09-12-45", "timestamp": 1745745165, "time_this_iter_s": 18.849634170532227, "time_total_s": 2148.8464176654816, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2148.8464176654816, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 55.95769230769231, "ram_util_percent": 13.023076923076921}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.22806973457336427, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.32559798948106267, "policy_loss": -0.0591986577116674, "vf_loss": 0.1341846216921582, "vf_explained_var": 0.7502174948492358, "kl": 0.03833318559581668, "entropy": 40.93266007208055, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 35185.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113499999999863, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46909183402269067, "mean_inference_ms": 2.2631300269216794, "mean_action_processing_ms": 0.23932952994140597, "mean_env_wait_ms": 65.71239529903735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046775102615356445, "StateBufferConnector_ms": 0.006595611572265625, "ViewRequirementAgentConnector_ms": 0.15981841087341309}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113499999999863, "episode_len_mean": 900.0, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46909183402269067, "mean_inference_ms": 2.2631300269216794, "mean_action_processing_ms": 0.23932952994140597, "mean_env_wait_ms": 65.71239529903735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046775102615356445, "StateBufferConnector_ms": 0.006595611572265625, "ViewRequirementAgentConnector_ms": 0.15981841087341309}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.42361912552477, "num_env_steps_trained_throughput_per_sec": 211.42361912552477, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 18801.633, "sample_time_ms": 15138.907, "load_time_ms": 488.41, "load_throughput": 8189.843, "learn_time_ms": 3127.123, "learn_throughput": 1279.131, "synch_weights_time_ms": 44.066}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 504, "training_iteration": 114, "trial_id": "bec7c_00000", "date": "2025-04-27_09-13-04", "timestamp": 1745745184, "time_this_iter_s": 18.928724765777588, "time_total_s": 2167.775142431259, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2167.775142431259, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 52.38148148148148, "ram_util_percent": 13.118518518518515}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.3421046018600464, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.2110873558888993, "policy_loss": -0.06768585810618054, "vf_loss": 0.2554087899639619, "vf_explained_var": 0.45863703508530895, "kl": 0.03074978673649903, "entropy": 40.93299398114604, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 35495.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113499999999863, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46909183402269067, "mean_inference_ms": 2.2631300269216794, "mean_action_processing_ms": 0.23932952994140597, "mean_env_wait_ms": 65.71239529903735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046775102615356445, "StateBufferConnector_ms": 0.006595611572265625, "ViewRequirementAgentConnector_ms": 0.15981841087341309}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113499999999863, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46909183402269067, "mean_inference_ms": 2.2631300269216794, "mean_action_processing_ms": 0.23932952994140597, "mean_env_wait_ms": 65.71239529903735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046775102615356445, "StateBufferConnector_ms": 0.006595611572265625, "ViewRequirementAgentConnector_ms": 0.15981841087341309}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.54001620112, "num_env_steps_trained_throughput_per_sec": 216.54001620112, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 18716.647, "sample_time_ms": 15066.688, "load_time_ms": 479.5, "load_throughput": 8342.019, "learn_time_ms": 3123.261, "learn_throughput": 1280.713, "synch_weights_time_ms": 44.049}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 504, "training_iteration": 115, "trial_id": "bec7c_00000", "date": "2025-04-27_09-13-22", "timestamp": 1745745202, "time_this_iter_s": 18.480482578277588, "time_total_s": 2186.2556250095367, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2186.2556250095367, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 55.18461538461539, "ram_util_percent": 13.2}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5131569027900696, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.44179278626557317, "policy_loss": -0.07364569294957383, "vf_loss": 0.040896377862959674, "vf_explained_var": 0.6090917556516586, "kl": 0.007520920068295269, "entropy": 41.29028923280777, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113499999999863, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46909183402269067, "mean_inference_ms": 2.2631300269216794, "mean_action_processing_ms": 0.23932952994140597, "mean_env_wait_ms": 65.71239529903735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046775102615356445, "StateBufferConnector_ms": 0.006595611572265625, "ViewRequirementAgentConnector_ms": 0.15981841087341309}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113499999999863, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46909183402269067, "mean_inference_ms": 2.2631300269216794, "mean_action_processing_ms": 0.23932952994140597, "mean_env_wait_ms": 65.71239529903735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046775102615356445, "StateBufferConnector_ms": 0.006595611572265625, "ViewRequirementAgentConnector_ms": 0.15981841087341309}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.1276701901633, "num_env_steps_trained_throughput_per_sec": 194.1276701901633, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 18967.059, "sample_time_ms": 15313.395, "load_time_ms": 479.819, "load_throughput": 8336.478, "learn_time_ms": 3126.736, "learn_throughput": 1279.289, "synch_weights_time_ms": 43.932}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 504, "training_iteration": 116, "trial_id": "bec7c_00000", "date": "2025-04-27_09-13-43", "timestamp": 1745745223, "time_this_iter_s": 20.6135151386261, "time_total_s": 2206.869140148163, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2206.869140148163, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 51.17931034482758, "ram_util_percent": 13.206896551724139}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5131569027900696, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5345058301643979, "policy_loss": -0.13208612987711546, "vf_loss": 0.00587518945126982, "vf_explained_var": 0.7302737645564541, "kl": 0.00569552362156232, "entropy": 41.12175974692068, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 36115.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113499999999863, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46909183402269067, "mean_inference_ms": 2.2631300269216794, "mean_action_processing_ms": 0.23932952994140597, "mean_env_wait_ms": 65.71239529903735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046775102615356445, "StateBufferConnector_ms": 0.006595611572265625, "ViewRequirementAgentConnector_ms": 0.15981841087341309}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113499999999863, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 19.089999999999687, 14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46909183402269067, "mean_inference_ms": 2.2631300269216794, "mean_action_processing_ms": 0.23932952994140597, "mean_env_wait_ms": 65.71239529903735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046775102615356445, "StateBufferConnector_ms": 0.006595611572265625, "ViewRequirementAgentConnector_ms": 0.15981841087341309}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.9457412199722, "num_env_steps_trained_throughput_per_sec": 216.9457412199722, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 18981.119, "sample_time_ms": 15330.631, "load_time_ms": 479.817, "load_throughput": 8336.516, "learn_time_ms": 3123.849, "learn_throughput": 1280.472, "synch_weights_time_ms": 43.68}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 504, "training_iteration": 117, "trial_id": "bec7c_00000", "date": "2025-04-27_09-14-01", "timestamp": 1745745241, "time_this_iter_s": 18.447120428085327, "time_total_s": 2225.316260576248, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2225.316260576248, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 54.67307692307691, "ram_util_percent": 13.25}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5131569027900696, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5458781918180325, "policy_loss": -0.13877603742744654, "vf_loss": 0.004679234830086165, "vf_explained_var": 0.8683617339980217, "kl": 0.006155579820446174, "entropy": 41.49401789019185, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 36425.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.062099999999862, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46902838134575847, "mean_inference_ms": 2.2632773844646614, "mean_action_processing_ms": 0.2393476054794562, "mean_env_wait_ms": 65.66565244211523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04682183265686035, "StateBufferConnector_ms": 0.006589412689208984, "ViewRequirementAgentConnector_ms": 0.15974783897399902}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.062099999999862, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.819999999999812, 14.949999999999822, 14.209999999999818, 13.94999999999983, 14.129999999999825, 14.469999999999828, 14.749999999999792, 14.994999999999857, 14.829999999999803, 15.18999999999979, 13.94999999999983, 14.209999999999818, 28.029999999999617, 13.94999999999983, 14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46902838134575847, "mean_inference_ms": 2.2632773844646614, "mean_action_processing_ms": 0.2393476054794562, "mean_env_wait_ms": 65.66565244211523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04682183265686035, "StateBufferConnector_ms": 0.006589412689208984, "ViewRequirementAgentConnector_ms": 0.15974783897399902}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.07991023706813, "num_env_steps_trained_throughput_per_sec": 213.07991023706813, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 19035.735, "sample_time_ms": 15354.914, "load_time_ms": 479.861, "load_throughput": 8335.742, "learn_time_ms": 3153.907, "learn_throughput": 1268.268, "synch_weights_time_ms": 43.913}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 506, "training_iteration": 118, "trial_id": "bec7c_00000", "date": "2025-04-27_09-14-20", "timestamp": 1745745260, "time_this_iter_s": 18.78128433227539, "time_total_s": 2244.0975449085236, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2244.0975449085236, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 52.9, "ram_util_percent": 13.266666666666666}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5131569027900696, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5479932882334857, "policy_loss": -0.14222239836329414, "vf_loss": 0.003819351917275438, "vf_explained_var": 0.760704880568289, "kl": 0.010501309381570243, "entropy": 41.49790765085528, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.60414999999988, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4690390294849886, "mean_inference_ms": 2.26261844536201, "mean_action_processing_ms": 0.23923379728426525, "mean_env_wait_ms": 65.68928400009862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04731154441833496, "StateBufferConnector_ms": 0.006665706634521484, "ViewRequirementAgentConnector_ms": 0.16141676902770996}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.60414999999988, "episode_len_mean": 900.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 14.749999999999806, 14.469999999999814, 14.209999999999818, 14.289999999999822, 14.129999999999821, 15.009999999999835, 14.02999999999983, 14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4690390294849886, "mean_inference_ms": 2.26261844536201, "mean_action_processing_ms": 0.23923379728426525, "mean_env_wait_ms": 65.68928400009862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04731154441833496, "StateBufferConnector_ms": 0.006665706634521484, "ViewRequirementAgentConnector_ms": 0.16141676902770996}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.59986032321723, "num_env_steps_trained_throughput_per_sec": 214.59986032321723, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 19076.848, "sample_time_ms": 15393.043, "load_time_ms": 479.067, "load_throughput": 8349.564, "learn_time_ms": 3157.567, "learn_throughput": 1266.798, "synch_weights_time_ms": 44.005}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 520, "training_iteration": 119, "trial_id": "bec7c_00000", "date": "2025-04-27_09-14-39", "timestamp": 1745745279, "time_this_iter_s": 18.64791226387024, "time_total_s": 2262.745457172394, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2262.745457172394, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 54.47692307692308, "ram_util_percent": 13.326923076923077}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5131569027900696, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5111845249099837, "policy_loss": -0.10548953736921952, "vf_loss": 0.0033214802281074825, "vf_explained_var": 0.7639246707962405, "kl": 0.011885138698233922, "entropy": 41.51154171113045, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 37045.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.816049999999876, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46882774417422957, "mean_inference_ms": 2.261844748718996, "mean_action_processing_ms": 0.23920396793554097, "mean_env_wait_ms": 65.72576925235018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047159433364868164, "StateBufferConnector_ms": 0.006550312042236328, "ViewRequirementAgentConnector_ms": 0.16135573387145996}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.816049999999876, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46882774417422957, "mean_inference_ms": 2.261844748718996, "mean_action_processing_ms": 0.23920396793554097, "mean_env_wait_ms": 65.72576925235018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047159433364868164, "StateBufferConnector_ms": 0.006550312042236328, "ViewRequirementAgentConnector_ms": 0.16135573387145996}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.26193925834409, "num_env_steps_trained_throughput_per_sec": 222.26193925834409, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 18792.992, "sample_time_ms": 15106.152, "load_time_ms": 478.685, "load_throughput": 8356.222, "learn_time_ms": 3161.331, "learn_throughput": 1265.29, "synch_weights_time_ms": 43.653}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 528, "training_iteration": 120, "trial_id": "bec7c_00000", "date": "2025-04-27_09-14-57", "timestamp": 1745745297, "time_this_iter_s": 18.00569462776184, "time_total_s": 2280.7511518001556, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2280.7511518001556, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 55.58, "ram_util_percent": 13.388000000000002}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5131569027900696, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5286219309260618, "policy_loss": -0.11768161833075987, "vf_loss": 0.0029781529311637108, "vf_explained_var": 0.6455760261704845, "kl": 0.0039500754910066814, "entropy": 41.594548699163624, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 37355.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.816049999999876, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46882774417422957, "mean_inference_ms": 2.261844748718996, "mean_action_processing_ms": 0.23920396793554097, "mean_env_wait_ms": 65.72576925235018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047159433364868164, "StateBufferConnector_ms": 0.006550312042236328, "ViewRequirementAgentConnector_ms": 0.16135573387145996}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.816049999999876, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46882774417422957, "mean_inference_ms": 2.261844748718996, "mean_action_processing_ms": 0.23920396793554097, "mean_env_wait_ms": 65.72576925235018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047159433364868164, "StateBufferConnector_ms": 0.006550312042236328, "ViewRequirementAgentConnector_ms": 0.16135573387145996}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.62075203371737, "num_env_steps_trained_throughput_per_sec": 219.62075203371737, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 18710.339, "sample_time_ms": 15037.865, "load_time_ms": 479.018, "load_throughput": 8350.419, "learn_time_ms": 3146.868, "learn_throughput": 1271.105, "synch_weights_time_ms": 43.428}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 528, "training_iteration": 121, "trial_id": "bec7c_00000", "date": "2025-04-27_09-15-15", "timestamp": 1745745315, "time_this_iter_s": 18.221864938735962, "time_total_s": 2298.9730167388916, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2298.9730167388916, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 53.66538461538461, "ram_util_percent": 13.36153846153846}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2565784513950348, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4977837861061186, "policy_loss": -0.08532919862848376, "vf_loss": 0.004495874374908688, "vf_explained_var": 0.5939634838411885, "kl": 0.006187740521319586, "entropy": 41.85381083334646, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.816049999999876, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46882774417422957, "mean_inference_ms": 2.261844748718996, "mean_action_processing_ms": 0.23920396793554097, "mean_env_wait_ms": 65.72576925235018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047159433364868164, "StateBufferConnector_ms": 0.006550312042236328, "ViewRequirementAgentConnector_ms": 0.16135573387145996}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.816049999999876, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.389999999999803, 15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46882774417422957, "mean_inference_ms": 2.261844748718996, "mean_action_processing_ms": 0.23920396793554097, "mean_env_wait_ms": 65.72576925235018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.047159433364868164, "StateBufferConnector_ms": 0.006550312042236328, "ViewRequirementAgentConnector_ms": 0.16135573387145996}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.8753427570925, "num_env_steps_trained_throughput_per_sec": 219.8753427570925, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 18708.904, "sample_time_ms": 15033.675, "load_time_ms": 478.738, "load_throughput": 8355.303, "learn_time_ms": 3150.269, "learn_throughput": 1269.733, "synch_weights_time_ms": 43.065}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 528, "training_iteration": 122, "trial_id": "bec7c_00000", "date": "2025-04-27_09-15-33", "timestamp": 1745745333, "time_this_iter_s": 18.20017910003662, "time_total_s": 2317.173195838928, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2317.173195838928, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 54.135999999999996, "ram_util_percent": 13.216}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2565784513950348, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.45590856245929196, "policy_loss": -0.04867150943966642, "vf_loss": 0.0054625308535657, "vf_explained_var": 0.6221953030555479, "kl": 0.011938962690856574, "entropy": 41.57628750954905, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 37975.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.815049999999875, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859240077318703, "mean_inference_ms": 2.2616926715705614, "mean_action_processing_ms": 0.23924645525148905, "mean_env_wait_ms": 65.7028000657737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04724407196044922, "StateBufferConnector_ms": 0.006574392318725586, "ViewRequirementAgentConnector_ms": 0.1616356372833252}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.815049999999875, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.109999999999816, 15.144999999999856, 14.30999999999981, 15.374999999999943, 14.129999999999821, 14.129999999999821, 13.94999999999983, 27.84999999999962, 14.129999999999832, 15.289999999999818, 13.94999999999983, 13.94999999999983, 16.169999999999742, 14.209999999999818, 14.209999999999832, 13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859240077318703, "mean_inference_ms": 2.2616926715705614, "mean_action_processing_ms": 0.23924645525148905, "mean_env_wait_ms": 65.7028000657737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04724407196044922, "StateBufferConnector_ms": 0.006574392318725586, "ViewRequirementAgentConnector_ms": 0.1616356372833252}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.56186927636026, "num_env_steps_trained_throughput_per_sec": 210.56186927636026, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 18724.473, "sample_time_ms": 15050.37, "load_time_ms": 478.548, "load_throughput": 8358.618, "learn_time_ms": 3148.795, "learn_throughput": 1270.327, "synch_weights_time_ms": 43.613}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 529, "training_iteration": 123, "trial_id": "bec7c_00000", "date": "2025-04-27_09-15-52", "timestamp": 1745745352, "time_this_iter_s": 19.00479769706726, "time_total_s": 2336.1779935359955, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2336.1779935359955, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 50.07037037037038, "ram_util_percent": 13.244444444444442}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2565784513950348, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5067327939259308, "policy_loss": -0.0939835162157373, "vf_loss": 0.0031537702108307124, "vf_explained_var": 0.6737076495924303, "kl": 0.008996074219141897, "entropy": 41.82112568270776, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 38285.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.657699999999878, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46881579864661227, "mean_inference_ms": 2.2615522316910917, "mean_action_processing_ms": 0.2391280534650537, "mean_env_wait_ms": 65.69667082713116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04721999168395996, "StateBufferConnector_ms": 0.0066258907318115234, "ViewRequirementAgentConnector_ms": 0.16234254837036133}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.657699999999878, "episode_len_mean": 900.0, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 15.669999999999765, 14.209999999999818, 67.83000000000159, 14.129999999999832, 15.154999999999818, 14.209999999999823, 18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46881579864661227, "mean_inference_ms": 2.2615522316910917, "mean_action_processing_ms": 0.2391280534650537, "mean_env_wait_ms": 65.69667082713116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04721999168395996, "StateBufferConnector_ms": 0.0066258907318115234, "ViewRequirementAgentConnector_ms": 0.16234254837036133}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.28477693467022, "num_env_steps_trained_throughput_per_sec": 217.28477693467022, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 18673.437, "sample_time_ms": 14993.428, "load_time_ms": 488.091, "load_throughput": 8195.199, "learn_time_ms": 3144.803, "learn_throughput": 1271.94, "synch_weights_time_ms": 43.957}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 544, "training_iteration": 124, "trial_id": "bec7c_00000", "date": "2025-04-27_09-16-11", "timestamp": 1745745371, "time_this_iter_s": 18.436384916305542, "time_total_s": 2354.614378452301, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2354.614378452301, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 52.65384615384615, "ram_util_percent": 13.196153846153846}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2565784513950348, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.46977789612231596, "policy_loss": -0.07607415219648711, "vf_loss": 0.021948691892635732, "vf_explained_var": 0.6507160692445694, "kl": 0.0228219194446108, "entropy": 42.15080588556105, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113649999999858, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859749860524275, "mean_inference_ms": 2.260615896633355, "mean_action_processing_ms": 0.23910210300260729, "mean_env_wait_ms": 65.73281311331137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046814680099487305, "StateBufferConnector_ms": 0.0065898895263671875, "ViewRequirementAgentConnector_ms": 0.1612865924835205}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113649999999858, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859749860524275, "mean_inference_ms": 2.260615896633355, "mean_action_processing_ms": 0.23910210300260729, "mean_env_wait_ms": 65.73281311331137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046814680099487305, "StateBufferConnector_ms": 0.0065898895263671875, "ViewRequirementAgentConnector_ms": 0.1612865924835205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.13996928218475, "num_env_steps_trained_throughput_per_sec": 226.13996928218475, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 18595.02, "sample_time_ms": 14918.322, "load_time_ms": 497.324, "load_throughput": 8043.038, "learn_time_ms": 3132.245, "learn_throughput": 1277.039, "synch_weights_time_ms": 43.981}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 552, "training_iteration": 125, "trial_id": "bec7c_00000", "date": "2025-04-27_09-16-28", "timestamp": 1745745388, "time_this_iter_s": 17.69657278060913, "time_total_s": 2372.31095123291, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2372.31095123291, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 55.36, "ram_util_percent": 13.303999999999998}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.38486767709255215, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.42379996562677047, "policy_loss": -0.08529717501613401, "vf_loss": 0.07112992387687442, "vf_explained_var": 0.4882182667332311, "kl": 0.02657701731293327, "entropy": 41.986136085756364, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 38905.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113649999999858, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859749860524275, "mean_inference_ms": 2.260615896633355, "mean_action_processing_ms": 0.23910210300260729, "mean_env_wait_ms": 65.73281311331137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046814680099487305, "StateBufferConnector_ms": 0.0065898895263671875, "ViewRequirementAgentConnector_ms": 0.1612865924835205}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113649999999858, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859749860524275, "mean_inference_ms": 2.260615896633355, "mean_action_processing_ms": 0.23910210300260729, "mean_env_wait_ms": 65.73281311331137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046814680099487305, "StateBufferConnector_ms": 0.0065898895263671875, "ViewRequirementAgentConnector_ms": 0.1612865924835205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.33539498520136, "num_env_steps_trained_throughput_per_sec": 213.33539498520136, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 18409.503, "sample_time_ms": 14733.331, "load_time_ms": 496.843, "load_throughput": 8050.835, "learn_time_ms": 3132.883, "learn_throughput": 1276.779, "synch_weights_time_ms": 43.343}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 552, "training_iteration": 126, "trial_id": "bec7c_00000", "date": "2025-04-27_09-16-47", "timestamp": 1745745407, "time_this_iter_s": 18.75867009162903, "time_total_s": 2391.069621324539, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2391.069621324539, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 55.70769230769231, "ram_util_percent": 13.357692307692306}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.5773015156388283, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3269848556528168, "policy_loss": -0.04853790302370344, "vf_loss": 0.12545737667941495, "vf_explained_var": 0.5549978094716226, "kl": 0.03295368734334554, "entropy": 42.29285557654596, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 39215.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113649999999858, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859749860524275, "mean_inference_ms": 2.260615896633355, "mean_action_processing_ms": 0.23910210300260729, "mean_env_wait_ms": 65.73281311331137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046814680099487305, "StateBufferConnector_ms": 0.0065898895263671875, "ViewRequirementAgentConnector_ms": 0.1612865924835205}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113649999999858, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859749860524275, "mean_inference_ms": 2.260615896633355, "mean_action_processing_ms": 0.23910210300260729, "mean_env_wait_ms": 65.73281311331137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046814680099487305, "StateBufferConnector_ms": 0.0065898895263671875, "ViewRequirementAgentConnector_ms": 0.1612865924835205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.49479580964115, "num_env_steps_trained_throughput_per_sec": 194.49479580964115, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 18622.334, "sample_time_ms": 14930.083, "load_time_ms": 506.368, "load_throughput": 7899.401, "learn_time_ms": 3139.415, "learn_throughput": 1274.123, "synch_weights_time_ms": 43.363}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 552, "training_iteration": 127, "trial_id": "bec7c_00000", "date": "2025-04-27_09-17-08", "timestamp": 1745745428, "time_this_iter_s": 20.57414484024048, "time_total_s": 2411.6437661647797, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2411.6437661647797, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 49.36206896551723, "ram_util_percent": 13.241379310344826}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.8659522734582428, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.45911615881768447, "policy_loss": -0.04858259459536883, "vf_loss": 0.009337055648892045, "vf_explained_var": 0.7338760489417661, "kl": 0.003812378756805218, "entropy": 42.317196987521264, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113649999999858, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859749860524275, "mean_inference_ms": 2.260615896633355, "mean_action_processing_ms": 0.23910210300260729, "mean_env_wait_ms": 65.73281311331137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046814680099487305, "StateBufferConnector_ms": 0.0065898895263671875, "ViewRequirementAgentConnector_ms": 0.1612865924835205}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.113649999999858, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.669999999999654, 14.209999999999821, 16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46859749860524275, "mean_inference_ms": 2.260615896633355, "mean_action_processing_ms": 0.23910210300260729, "mean_env_wait_ms": 65.73281311331137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046814680099487305, "StateBufferConnector_ms": 0.0065898895263671875, "ViewRequirementAgentConnector_ms": 0.1612865924835205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.44994163312765, "num_env_steps_trained_throughput_per_sec": 213.44994163312765, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 18619.079, "sample_time_ms": 14965.451, "load_time_ms": 506.331, "load_throughput": 7899.974, "learn_time_ms": 3101.148, "learn_throughput": 1289.845, "synch_weights_time_ms": 43.035}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 552, "training_iteration": 128, "trial_id": "bec7c_00000", "date": "2025-04-27_09-17-27", "timestamp": 1745745447, "time_this_iter_s": 18.74833035469055, "time_total_s": 2430.39209651947, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2430.39209651947, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 53.51153846153846, "ram_util_percent": 13.400000000000004}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4329761367291214, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5286802255939091, "policy_loss": -0.11188835931130715, "vf_loss": 0.0034885681195573263, "vf_explained_var": 0.5635526264867475, "kl": 0.006898071532972964, "entropy": 42.32671375889932, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 39835.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.065649999999863, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685532060095101, "mean_inference_ms": 2.2608616843168368, "mean_action_processing_ms": 0.2391332923971266, "mean_env_wait_ms": 65.69859232044074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046653032302856445, "StateBufferConnector_ms": 0.006575822830200195, "ViewRequirementAgentConnector_ms": 0.16051220893859863}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.065649999999863, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.004999999999843, 13.94999999999983, 13.94999999999983, 17.40999999999971, 13.94999999999983, 17.76999999999982, 14.029999999999825, 14.129999999999821, 14.189999999999825, 29.609999999999626, 14.26999999999983, 13.94999999999983, 14.129999999999832, 14.309999999999826, 13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4685532060095101, "mean_inference_ms": 2.2608616843168368, "mean_action_processing_ms": 0.2391332923971266, "mean_env_wait_ms": 65.69859232044074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046653032302856445, "StateBufferConnector_ms": 0.006575822830200195, "ViewRequirementAgentConnector_ms": 0.16051220893859863}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.02291136987404, "num_env_steps_trained_throughput_per_sec": 214.02291136987404, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 18624.104, "sample_time_ms": 14971.338, "load_time_ms": 506.057, "load_throughput": 7904.244, "learn_time_ms": 3100.521, "learn_throughput": 1290.106, "synch_weights_time_ms": 43.086}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 554, "training_iteration": 129, "trial_id": "bec7c_00000", "date": "2025-04-27_09-17-45", "timestamp": 1745745465, "time_this_iter_s": 18.697607278823853, "time_total_s": 2449.089703798294, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2449.089703798294, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 52.71923076923076, "ram_util_percent": 13.399999999999999}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4329761367291214, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5411600882487912, "policy_loss": -0.13056715823589793, "vf_loss": 0.005791925366229993, "vf_explained_var": 0.818866810106462, "kl": 0.007938871839277358, "entropy": 41.98222053281722, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 40145.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.01829999999986, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686373596546028, "mean_inference_ms": 2.2604262515623894, "mean_action_processing_ms": 0.23905275618190325, "mean_env_wait_ms": 65.69720699944442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04622626304626465, "StateBufferConnector_ms": 0.006511211395263672, "ViewRequirementAgentConnector_ms": 0.15953683853149414}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.01829999999986, "episode_len_mean": 900.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 26.8499999999996, 14.129999999999825, 16.269999999999747, 14.02999999999983, 14.209999999999825, 14.209999999999818, 14.209999999999821, 14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686373596546028, "mean_inference_ms": 2.2604262515623894, "mean_action_processing_ms": 0.23905275618190325, "mean_env_wait_ms": 65.69720699944442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04622626304626465, "StateBufferConnector_ms": 0.006511211395263672, "ViewRequirementAgentConnector_ms": 0.15953683853149414}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.98186565542807, "num_env_steps_trained_throughput_per_sec": 222.98186565542807, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 18618.293, "sample_time_ms": 14970.331, "load_time_ms": 506.712, "load_throughput": 7894.036, "learn_time_ms": 3095.249, "learn_throughput": 1292.303, "synch_weights_time_ms": 42.917}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 568, "training_iteration": 130, "trial_id": "bec7c_00000", "date": "2025-04-27_09-18-03", "timestamp": 1745745483, "time_this_iter_s": 17.947272300720215, "time_total_s": 2467.0369760990143, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2467.0369760990143, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 55.596000000000004, "ram_util_percent": 13.376000000000001}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.4329761367291214, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4417372417365832, "policy_loss": -0.06000352953222671, "vf_loss": 0.022644803611910902, "vf_explained_var": 0.7953805144756071, "kl": 0.02180961930478647, "entropy": 41.38215687659479, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.466899999999878, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684595258716733, "mean_inference_ms": 2.259627653630551, "mean_action_processing_ms": 0.2390351178794897, "mean_env_wait_ms": 65.74295323739165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046381235122680664, "StateBufferConnector_ms": 0.006520986557006836, "ViewRequirementAgentConnector_ms": 0.16045212745666504}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.466899999999878, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684595258716733, "mean_inference_ms": 2.259627653630551, "mean_action_processing_ms": 0.2390351178794897, "mean_env_wait_ms": 65.74295323739165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046381235122680664, "StateBufferConnector_ms": 0.006520986557006836, "ViewRequirementAgentConnector_ms": 0.16045212745666504}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.940662691444, "num_env_steps_trained_throughput_per_sec": 221.940662691444, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 18599.255, "sample_time_ms": 14941.093, "load_time_ms": 505.121, "load_throughput": 7918.899, "learn_time_ms": 3106.557, "learn_throughput": 1287.599, "synch_weights_time_ms": 43.376}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 576, "training_iteration": 131, "trial_id": "bec7c_00000", "date": "2025-04-27_09-18-21", "timestamp": 1745745501, "time_this_iter_s": 18.03102970123291, "time_total_s": 2485.068005800247, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2485.068005800247, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 56.327999999999996, "ram_util_percent": 13.171999999999999}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6494642050936817, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.43421565508169513, "policy_loss": -0.058702159565573016, "vf_loss": 0.0306844702367192, "vf_explained_var": 0.6960785717733444, "kl": 0.01722268964175225, "entropy": 41.73834944694273, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 40765.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.466899999999878, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684595258716733, "mean_inference_ms": 2.259627653630551, "mean_action_processing_ms": 0.2390351178794897, "mean_env_wait_ms": 65.74295323739165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046381235122680664, "StateBufferConnector_ms": 0.006520986557006836, "ViewRequirementAgentConnector_ms": 0.16045212745666504}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.466899999999878, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684595258716733, "mean_inference_ms": 2.259627653630551, "mean_action_processing_ms": 0.2390351178794897, "mean_env_wait_ms": 65.74295323739165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046381235122680664, "StateBufferConnector_ms": 0.006520986557006836, "ViewRequirementAgentConnector_ms": 0.16045212745666504}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.13325503858238, "num_env_steps_trained_throughput_per_sec": 200.13325503858238, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 18778.711, "sample_time_ms": 15134.058, "load_time_ms": 505.826, "load_throughput": 7907.855, "learn_time_ms": 3092.278, "learn_throughput": 1293.545, "synch_weights_time_ms": 43.435}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 576, "training_iteration": 132, "trial_id": "bec7c_00000", "date": "2025-04-27_09-18-41", "timestamp": 1745745521, "time_this_iter_s": 19.997838020324707, "time_total_s": 2505.065843820572, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2505.065843820572, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 52.75357142857143, "ram_util_percent": 13.235714285714291}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6494642050936817, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5392227501781177, "policy_loss": -0.13886329779221165, "vf_loss": 0.014675215607431093, "vf_explained_var": 0.8229510953349451, "kl": 0.006691319735264481, "entropy": 41.93804552631993, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 41075.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.466899999999878, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684595258716733, "mean_inference_ms": 2.259627653630551, "mean_action_processing_ms": 0.2390351178794897, "mean_env_wait_ms": 65.74295323739165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046381235122680664, "StateBufferConnector_ms": 0.006520986557006836, "ViewRequirementAgentConnector_ms": 0.16045212745666504}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.466899999999878, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.10999999999983, 13.94999999999983, 14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684595258716733, "mean_inference_ms": 2.259627653630551, "mean_action_processing_ms": 0.2390351178794897, "mean_env_wait_ms": 65.74295323739165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046381235122680664, "StateBufferConnector_ms": 0.006520986557006836, "ViewRequirementAgentConnector_ms": 0.16045212745666504}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.14526577053726, "num_env_steps_trained_throughput_per_sec": 211.14526577053726, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 18773.461, "sample_time_ms": 15142.96, "load_time_ms": 505.618, "load_throughput": 7911.109, "learn_time_ms": 3077.73, "learn_throughput": 1299.659, "synch_weights_time_ms": 44.044}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 576, "training_iteration": 133, "trial_id": "bec7c_00000", "date": "2025-04-27_09-19-00", "timestamp": 1745745540, "time_this_iter_s": 18.952948808670044, "time_total_s": 2524.018792629242, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2524.018792629242, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 52.318518518518516, "ram_util_percent": 13.303703703703706}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6494642050936817, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5191649048979725, "policy_loss": -0.10993790564487778, "vf_loss": 0.005981014410621531, "vf_explained_var": 0.750302952912546, "kl": 0.006734540436886046, "entropy": 41.95818657413606, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.46969999999988, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46843022736024914, "mean_inference_ms": 2.259973885180007, "mean_action_processing_ms": 0.2390699862200388, "mean_env_wait_ms": 65.7102675301294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046289682388305664, "StateBufferConnector_ms": 0.006519317626953125, "ViewRequirementAgentConnector_ms": 0.16011309623718262}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.46969999999988, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.48999999999981, 14.109999999999825, 16.359999999999758, 14.029999999999825, 28.709999999999614, 13.94999999999983, 13.94999999999983, 75.85000000000153, 14.129999999999832, 14.209999999999818, 14.129999999999827, 14.209999999999821, 13.94999999999983, 16.169999999999803, 14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46843022736024914, "mean_inference_ms": 2.259973885180007, "mean_action_processing_ms": 0.2390699862200388, "mean_env_wait_ms": 65.7102675301294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046289682388305664, "StateBufferConnector_ms": 0.006519317626953125, "ViewRequirementAgentConnector_ms": 0.16011309623718262}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.52654414932024, "num_env_steps_trained_throughput_per_sec": 220.52654414932024, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 18746.401, "sample_time_ms": 15121.55, "load_time_ms": 495.759, "load_throughput": 8068.44, "learn_time_ms": 3081.549, "learn_throughput": 1298.048, "synch_weights_time_ms": 44.437}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 578, "training_iteration": 134, "trial_id": "bec7c_00000", "date": "2025-04-27_09-19-18", "timestamp": 1745745558, "time_this_iter_s": 18.146757125854492, "time_total_s": 2542.1655497550964, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2542.1655497550964, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 54.96, "ram_util_percent": 13.312000000000001}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6494642050936817, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.507613601505516, "policy_loss": -0.10143874799532275, "vf_loss": 0.00932443594943071, "vf_explained_var": 0.8356674450059091, "kl": 0.009486367118317443, "entropy": 42.16603560909148, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 41695.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.730099999999865, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46850572915258293, "mean_inference_ms": 2.2596992558060425, "mean_action_processing_ms": 0.23899135450192582, "mean_env_wait_ms": 65.70933733430392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04651308059692383, "StateBufferConnector_ms": 0.006544589996337891, "ViewRequirementAgentConnector_ms": 0.16118359565734863}}, "episode_reward_max": 84.73000000000168, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.730099999999865, "episode_len_mean": 900.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999823, 13.94999999999983, 84.73000000000168, 14.454999999999828, 14.209999999999827, 15.709999999999834, 14.309999999999818, 14.02999999999983, 14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46850572915258293, "mean_inference_ms": 2.2596992558060425, "mean_action_processing_ms": 0.23899135450192582, "mean_env_wait_ms": 65.70933733430392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04651308059692383, "StateBufferConnector_ms": 0.006544589996337891, "ViewRequirementAgentConnector_ms": 0.16118359565734863}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.1779956869989, "num_env_steps_trained_throughput_per_sec": 221.1779956869989, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 18786.083, "sample_time_ms": 15158.81, "load_time_ms": 485.388, "load_throughput": 8240.827, "learn_time_ms": 3093.659, "learn_throughput": 1292.967, "synch_weights_time_ms": 45.135}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 592, "training_iteration": 135, "trial_id": "bec7c_00000", "date": "2025-04-27_09-19-37", "timestamp": 1745745577, "time_this_iter_s": 18.093985557556152, "time_total_s": 2560.2595353126526, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2560.2595353126526, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 53.876923076923084, "ram_util_percent": 13.303846153846154}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6494642050936817, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4509812999411576, "policy_loss": -0.07663179257163598, "vf_loss": 0.03835368523265765, "vf_explained_var": 0.6626695990562439, "kl": 0.01250312197824373, "entropy": 42.082353345809445, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 42005.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.33084999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683428407053929, "mean_inference_ms": 2.2591372823502853, "mean_action_processing_ms": 0.23898227252114007, "mean_env_wait_ms": 65.74471535598856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046854257583618164, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.1616528034210205}}, "episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.33084999999984, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683428407053929, "mean_inference_ms": 2.2591372823502853, "mean_action_processing_ms": 0.23898227252114007, "mean_env_wait_ms": 65.74471535598856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046854257583618164, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.1616528034210205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 223.63405201223603, "num_env_steps_trained_throughput_per_sec": 223.63405201223603, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 18699.737, "sample_time_ms": 15070.829, "load_time_ms": 485.713, "load_throughput": 8235.313, "learn_time_ms": 3094.875, "learn_throughput": 1292.459, "synch_weights_time_ms": 45.219}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 600, "training_iteration": 136, "trial_id": "bec7c_00000", "date": "2025-04-27_09-19-55", "timestamp": 1745745595, "time_this_iter_s": 17.894431352615356, "time_total_s": 2578.153966665268, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2578.153966665268, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 55.80799999999999, "ram_util_percent": 13.22}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.6494642050936817, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.28022299279128354, "policy_loss": -0.05895130594651545, "vf_loss": 0.1827915765388283, "vf_explained_var": 0.5225703514391377, "kl": 0.028364207690115547, "entropy": 42.248480790661226, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.33084999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683428407053929, "mean_inference_ms": 2.2591372823502853, "mean_action_processing_ms": 0.23898227252114007, "mean_env_wait_ms": 65.74471535598856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046854257583618164, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.1616528034210205}}, "episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.33084999999984, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683428407053929, "mean_inference_ms": 2.2591372823502853, "mean_action_processing_ms": 0.23898227252114007, "mean_env_wait_ms": 65.74471535598856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046854257583618164, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.1616528034210205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.33291420883927, "num_env_steps_trained_throughput_per_sec": 194.33291420883927, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 18701.451, "sample_time_ms": 15086.033, "load_time_ms": 475.915, "load_throughput": 8404.867, "learn_time_ms": 3090.79, "learn_throughput": 1294.168, "synch_weights_time_ms": 45.63}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 600, "training_iteration": 137, "trial_id": "bec7c_00000", "date": "2025-04-27_09-20-15", "timestamp": 1745745615, "time_this_iter_s": 20.59123945236206, "time_total_s": 2598.74520611763, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2598.74520611763, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 52.38965517241379, "ram_util_percent": 13.196551724137933}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9741963076405227, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.28567809198772715, "policy_loss": -0.02068271216966452, "vf_loss": 0.14498931020047637, "vf_explained_var": 0.5745884218523579, "kl": 0.012084811812007589, "entropy": 42.175768206196445, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 42625.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.33084999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683428407053929, "mean_inference_ms": 2.2591372823502853, "mean_action_processing_ms": 0.23898227252114007, "mean_env_wait_ms": 65.74471535598856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046854257583618164, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.1616528034210205}}, "episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.33084999999984, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683428407053929, "mean_inference_ms": 2.2591372823502853, "mean_action_processing_ms": 0.23898227252114007, "mean_env_wait_ms": 65.74471535598856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046854257583618164, "StateBufferConnector_ms": 0.006604194641113281, "ViewRequirementAgentConnector_ms": 0.1616528034210205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 192.4122097479631, "num_env_steps_trained_throughput_per_sec": 192.4122097479631, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 18906.346, "sample_time_ms": 15284.881, "load_time_ms": 475.523, "load_throughput": 8411.796, "learn_time_ms": 3097.579, "learn_throughput": 1291.331, "synch_weights_time_ms": 45.293}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 600, "training_iteration": 138, "trial_id": "bec7c_00000", "date": "2025-04-27_09-20-36", "timestamp": 1745745636, "time_this_iter_s": 20.799896955490112, "time_total_s": 2619.54510307312, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2619.54510307312, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 49.85517241379311, "ram_util_percent": 13.320689655172417}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.9741963076405227, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5545481334590624, "policy_loss": -0.14387800849733814, "vf_loss": 0.003937646389362447, "vf_explained_var": 0.6527504632549901, "kl": 0.004659160725731777, "entropy": 41.91467232242707, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 42935.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.32904999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46813972156203365, "mean_inference_ms": 2.259099562547219, "mean_action_processing_ms": 0.2390259116130185, "mean_env_wait_ms": 65.7278122782267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0468440055847168, "StateBufferConnector_ms": 0.0066034793853759766, "ViewRequirementAgentConnector_ms": 0.1614999771118164}}, "episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.32904999999984, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.389999999999816, 14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46813972156203365, "mean_inference_ms": 2.259099562547219, "mean_action_processing_ms": 0.2390259116130185, "mean_env_wait_ms": 65.7278122782267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0468440055847168, "StateBufferConnector_ms": 0.0066034793853759766, "ViewRequirementAgentConnector_ms": 0.1614999771118164}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.0909854979831, "num_env_steps_trained_throughput_per_sec": 211.0909854979831, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 18932.304, "sample_time_ms": 15303.64, "load_time_ms": 475.321, "load_throughput": 8415.367, "learn_time_ms": 3105.055, "learn_throughput": 1288.222, "synch_weights_time_ms": 45.202}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 601, "training_iteration": 139, "trial_id": "bec7c_00000", "date": "2025-04-27_09-20-55", "timestamp": 1745745655, "time_this_iter_s": 18.95729398727417, "time_total_s": 2638.5023970603943, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2638.5023970603943, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 51.99629629629629, "ram_util_percent": 13.374074074074075}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.48709815382026134, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5552486628414162, "policy_loss": -0.1408967993312305, "vf_loss": 0.002438180445695311, "vf_explained_var": 0.7041061028357475, "kl": 0.009733766099834024, "entropy": 42.15313521354429, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.324649999999842, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683339935092687, "mean_inference_ms": 2.259544994816739, "mean_action_processing_ms": 0.23902129473517766, "mean_env_wait_ms": 65.71685478698983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04703044891357422, "StateBufferConnector_ms": 0.006629228591918945, "ViewRequirementAgentConnector_ms": 0.16214823722839355}}, "episode_reward_max": 81.5500000000016, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.324649999999842, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999821, 14.129999999999832, 14.129999999999832, 13.94999999999983, 15.32999999999976, 14.129999999999832, 13.94999999999983, 14.129999999999827, 13.94999999999983, 13.94999999999983, 15.269999999999806, 81.5500000000016, 17.749999999999677, 14.30999999999981, 14.02999999999983, 14.389999999999823, 13.94999999999983, 13.94999999999983, 29.36999999999962, 14.129999999999832, 16.029999999999756, 17.649999999999668, 14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683339935092687, "mean_inference_ms": 2.259544994816739, "mean_action_processing_ms": 0.23902129473517766, "mean_env_wait_ms": 65.71685478698983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04703044891357422, "StateBufferConnector_ms": 0.006629228591918945, "ViewRequirementAgentConnector_ms": 0.16214823722839355}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.2372060548422, "num_env_steps_trained_throughput_per_sec": 216.2372060548422, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 18988.257, "sample_time_ms": 15367.311, "load_time_ms": 474.339, "load_throughput": 8432.783, "learn_time_ms": 3096.88, "learn_throughput": 1291.623, "synch_weights_time_ms": 46.624}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 602, "training_iteration": 140, "trial_id": "bec7c_00000", "date": "2025-04-27_09-21-13", "timestamp": 1745745673, "time_this_iter_s": 18.507073640823364, "time_total_s": 2657.0094707012177, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2657.0094707012177, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 55.45769230769231, "ram_util_percent": 13.419230769230769}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.48709815382026134, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.22406056949027603, "policy_loss": -0.060833946525329544, "vf_loss": 0.2502234319297713, "vf_explained_var": 0.6964178665991753, "kl": 0.022546690334703242, "entropy": 42.44325166517688, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 43555.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.187449999999846, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46833076091565223, "mean_inference_ms": 2.2588455116956574, "mean_action_processing_ms": 0.238938725279892, "mean_env_wait_ms": 65.73794721318585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621243476867676, "StateBufferConnector_ms": 0.006554603576660156, "ViewRequirementAgentConnector_ms": 0.1600658893585205}}, "episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.187449999999846, "episode_len_mean": 900.0, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46833076091565223, "mean_inference_ms": 2.2588455116956574, "mean_action_processing_ms": 0.238938725279892, "mean_env_wait_ms": 65.73794721318585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621243476867676, "StateBufferConnector_ms": 0.006554603576660156, "ViewRequirementAgentConnector_ms": 0.1600658893585205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.7471547942974, "num_env_steps_trained_throughput_per_sec": 219.7471547942974, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 19006.248, "sample_time_ms": 15382.368, "load_time_ms": 473.775, "load_throughput": 8442.832, "learn_time_ms": 3100.291, "learn_throughput": 1290.201, "synch_weights_time_ms": 46.731}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 624, "training_iteration": 141, "trial_id": "bec7c_00000", "date": "2025-04-27_09-21-32", "timestamp": 1745745692, "time_this_iter_s": 18.211254596710205, "time_total_s": 2675.220725297928, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2675.220725297928, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 56.092, "ram_util_percent": 13.372}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7306472307303922, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.19808056787587702, "policy_loss": -0.06064458163755555, "vf_loss": 0.27624555207472556, "vf_explained_var": 0.6536693428793261, "kl": 0.013688431066393312, "entropy": 42.36829605102539, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 43865.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.187449999999846, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46833076091565223, "mean_inference_ms": 2.2588455116956574, "mean_action_processing_ms": 0.238938725279892, "mean_env_wait_ms": 65.73794721318585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621243476867676, "StateBufferConnector_ms": 0.006554603576660156, "ViewRequirementAgentConnector_ms": 0.1600658893585205}}, "episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.187449999999846, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46833076091565223, "mean_inference_ms": 2.2588455116956574, "mean_action_processing_ms": 0.238938725279892, "mean_env_wait_ms": 65.73794721318585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621243476867676, "StateBufferConnector_ms": 0.006554603576660156, "ViewRequirementAgentConnector_ms": 0.1600658893585205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.83366623207604, "num_env_steps_trained_throughput_per_sec": 207.83366623207604, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 18932.196, "sample_time_ms": 15298.357, "load_time_ms": 474.222, "load_throughput": 8434.869, "learn_time_ms": 3109.855, "learn_throughput": 1286.233, "synch_weights_time_ms": 46.674}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 624, "training_iteration": 142, "trial_id": "bec7c_00000", "date": "2025-04-27_09-21-51", "timestamp": 1745745711, "time_this_iter_s": 19.25456714630127, "time_total_s": 2694.475292444229, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2694.475292444229, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 53.38148148148149, "ram_util_percent": 13.451851851851854}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7306472307303922, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4668065539471084, "policy_loss": -0.09296973198652267, "vf_loss": 0.046110972470177654, "vf_explained_var": 0.7625521369518772, "kl": 0.012426671183557076, "entropy": 42.90273163087906, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.187449999999846, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46833076091565223, "mean_inference_ms": 2.2588455116956574, "mean_action_processing_ms": 0.238938725279892, "mean_env_wait_ms": 65.73794721318585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621243476867676, "StateBufferConnector_ms": 0.006554603576660156, "ViewRequirementAgentConnector_ms": 0.1600658893585205}}, "episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.187449999999846, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46833076091565223, "mean_inference_ms": 2.2588455116956574, "mean_action_processing_ms": 0.238938725279892, "mean_env_wait_ms": 65.73794721318585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621243476867676, "StateBufferConnector_ms": 0.006554603576660156, "ViewRequirementAgentConnector_ms": 0.1600658893585205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.9567438853453, "num_env_steps_trained_throughput_per_sec": 195.9567438853453, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 19079.033, "sample_time_ms": 15435.241, "load_time_ms": 473.926, "load_throughput": 8440.143, "learn_time_ms": 3120.567, "learn_throughput": 1281.819, "synch_weights_time_ms": 46.206}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 624, "training_iteration": 143, "trial_id": "bec7c_00000", "date": "2025-04-27_09-22-11", "timestamp": 1745745731, "time_this_iter_s": 20.42138361930847, "time_total_s": 2714.8966760635376, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2714.8966760635376, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 51.33793103448276, "ram_util_percent": 13.275862068965518}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7306472307303922, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5349731446033524, "policy_loss": -0.12235878505593827, "vf_loss": 0.012920749575348436, "vf_explained_var": 0.562304594632118, "kl": 0.00909460240205319, "entropy": 43.218006453975555, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 44485.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.187449999999846, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46833076091565223, "mean_inference_ms": 2.2588455116956574, "mean_action_processing_ms": 0.238938725279892, "mean_env_wait_ms": 65.73794721318585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621243476867676, "StateBufferConnector_ms": 0.006554603576660156, "ViewRequirementAgentConnector_ms": 0.1600658893585205}}, "episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.187449999999846, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999821, 16.459999999999745, 14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.46833076091565223, "mean_inference_ms": 2.2588455116956574, "mean_action_processing_ms": 0.238938725279892, "mean_env_wait_ms": 65.73794721318585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621243476867676, "StateBufferConnector_ms": 0.006554603576660156, "ViewRequirementAgentConnector_ms": 0.1600658893585205}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.21006604629144, "num_env_steps_trained_throughput_per_sec": 218.21006604629144, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 19098.284, "sample_time_ms": 15411.505, "load_time_ms": 474.224, "load_throughput": 8434.837, "learn_time_ms": 3163.675, "learn_throughput": 1264.352, "synch_weights_time_ms": 45.777}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 624, "training_iteration": 144, "trial_id": "bec7c_00000", "date": "2025-04-27_09-22-30", "timestamp": 1745745750, "time_this_iter_s": 18.342879056930542, "time_total_s": 2733.239555120468, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2733.239555120468, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 64.70384615384616, "ram_util_percent": 13.611538461538462}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7306472307303922, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.5615324684268524, "policy_loss": -0.13757019219619612, "vf_loss": 0.006711767059318992, "vf_explained_var": 0.710513118197841, "kl": 0.006948675280040586, "entropy": 43.57510832509687, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 44795.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.176849999999842, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683459401992993, "mean_inference_ms": 2.2593656713194434, "mean_action_processing_ms": 0.23898874075299845, "mean_env_wait_ms": 65.7132424062704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04638409614562988, "StateBufferConnector_ms": 0.006578922271728516, "ViewRequirementAgentConnector_ms": 0.16080021858215332}}, "episode_reward_max": 75.19000000000153, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.176849999999842, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.30999999999981, 14.129999999999827, 14.289999999999832, 13.94999999999983, 13.94999999999983, 15.00999999999983, 14.494999999999903, 14.129999999999827, 15.229999999999787, 13.94999999999983, 14.8299999999998, 13.94999999999983, 14.834999999999823, 15.624999999999782, 14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4683459401992993, "mean_inference_ms": 2.2593656713194434, "mean_action_processing_ms": 0.23898874075299845, "mean_env_wait_ms": 65.7132424062704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04638409614562988, "StateBufferConnector_ms": 0.006578922271728516, "ViewRequirementAgentConnector_ms": 0.16080021858215332}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.06448495166694, "num_env_steps_trained_throughput_per_sec": 174.06448495166694, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 19587.785, "sample_time_ms": 15904.368, "load_time_ms": 474.285, "load_throughput": 8433.752, "learn_time_ms": 3160.895, "learn_throughput": 1265.464, "synch_weights_time_ms": 45.107}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 626, "training_iteration": 145, "trial_id": "bec7c_00000", "date": "2025-04-27_09-22-53", "timestamp": 1745745773, "time_this_iter_s": 22.988874673843384, "time_total_s": 2756.2284297943115, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2756.2284297943115, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 74.3, "ram_util_percent": 15.184375000000003}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7306472307303922, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.3990325209594542, "policy_loss": -0.054842921101578304, "vf_loss": 0.07888649135711603, "vf_explained_var": 0.9121764982900312, "kl": 0.017007320692244966, "entropy": 43.550245494227255, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.95954999999987, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686166113975902, "mean_inference_ms": 2.260107114049015, "mean_action_processing_ms": 0.2389900096460565, "mean_env_wait_ms": 65.73150867631016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046762704849243164, "StateBufferConnector_ms": 0.006567716598510742, "ViewRequirementAgentConnector_ms": 0.1614394187927246}}, "episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.95954999999987, "episode_len_mean": 900.0, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.10999999999982, 13.94999999999983, 14.02999999999983, 14.129999999999821, 13.94999999999983, 14.02999999999983, 13.94999999999983, 14.129999999999821, 14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686166113975902, "mean_inference_ms": 2.260107114049015, "mean_action_processing_ms": 0.2389900096460565, "mean_env_wait_ms": 65.73150867631016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.046762704849243164, "StateBufferConnector_ms": 0.006567716598510742, "ViewRequirementAgentConnector_ms": 0.1614394187927246}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.68661330121205, "num_env_steps_trained_throughput_per_sec": 215.68661330121205, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 19653.692, "sample_time_ms": 15965.567, "load_time_ms": 474.642, "load_throughput": 8427.396, "learn_time_ms": 3165.159, "learn_throughput": 1263.759, "synch_weights_time_ms": 45.171}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 640, "training_iteration": 146, "trial_id": "bec7c_00000", "date": "2025-04-27_09-23-11", "timestamp": 1745745791, "time_this_iter_s": 18.553536653518677, "time_total_s": 2774.78196644783, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2774.78196644783, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 54.72692307692308, "ram_util_percent": 12.965384615384615}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.7306472307303922, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.32781317086529826, "policy_loss": -0.06808874046940717, "vf_loss": 0.15552684717014575, "vf_explained_var": 0.7447241160177416, "kl": 0.02370684648059039, "entropy": 43.25726248218167, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 45415.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.16089999999986, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668, 15.369999999999825, 14.129999999999827, 14.129999999999825, 14.309999999999823, 14.02999999999983, 15.064999999999811, 14.129999999999821, 31.249999999999645], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605517953554, "mean_inference_ms": 2.2604799517974468, "mean_action_processing_ms": 0.23905610512956024, "mean_env_wait_ms": 65.769778565068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04643058776855469, "StateBufferConnector_ms": 0.006522655487060547, "ViewRequirementAgentConnector_ms": 0.16027188301086426}}, "episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.16089999999986, "episode_len_mean": 900.0, "episodes_this_iter": 8, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668, 15.369999999999825, 14.129999999999827, 14.129999999999825, 14.309999999999823, 14.02999999999983, 15.064999999999811, 14.129999999999821, 31.249999999999645], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605517953554, "mean_inference_ms": 2.2604799517974468, "mean_action_processing_ms": 0.23905610512956024, "mean_env_wait_ms": 65.769778565068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04643058776855469, "StateBufferConnector_ms": 0.006522655487060547, "ViewRequirementAgentConnector_ms": 0.16027188301086426}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.74018038507393, "num_env_steps_trained_throughput_per_sec": 199.74018038507393, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 19597.969, "sample_time_ms": 15879.515, "load_time_ms": 484.691, "load_throughput": 8252.681, "learn_time_ms": 3184.313, "learn_throughput": 1256.158, "synch_weights_time_ms": 46.23}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 648, "training_iteration": 147, "trial_id": "bec7c_00000", "date": "2025-04-27_09-23-31", "timestamp": 1745745811, "time_this_iter_s": 20.03804612159729, "time_total_s": 2794.8200125694275, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2794.8200125694275, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 64.92222222222223, "ram_util_percent": 13.874074074074073}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.095970846095588, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.31087813832376515, "policy_loss": -0.01788424532484984, "vf_loss": 0.1300243606689037, "vf_explained_var": 0.596450589933703, "kl": 0.006972930660647821, "entropy": 43.066039005402594, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 45725.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.16089999999986, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668, 15.369999999999825, 14.129999999999827, 14.129999999999825, 14.309999999999823, 14.02999999999983, 15.064999999999811, 14.129999999999821, 31.249999999999645], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605517953554, "mean_inference_ms": 2.2604799517974468, "mean_action_processing_ms": 0.23905610512956024, "mean_env_wait_ms": 65.769778565068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04643058776855469, "StateBufferConnector_ms": 0.006522655487060547, "ViewRequirementAgentConnector_ms": 0.16027188301086426}}, "episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.16089999999986, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668, 15.369999999999825, 14.129999999999827, 14.129999999999825, 14.309999999999823, 14.02999999999983, 15.064999999999811, 14.129999999999821, 31.249999999999645], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605517953554, "mean_inference_ms": 2.2604799517974468, "mean_action_processing_ms": 0.23905610512956024, "mean_env_wait_ms": 65.769778565068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04643058776855469, "StateBufferConnector_ms": 0.006522655487060547, "ViewRequirementAgentConnector_ms": 0.16027188301086426}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.9959502441149, "num_env_steps_trained_throughput_per_sec": 153.9959502441149, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 20116.57, "sample_time_ms": 16367.422, "load_time_ms": 484.948, "load_throughput": 8248.299, "learn_time_ms": 3214.826, "learn_throughput": 1244.235, "synch_weights_time_ms": 46.142}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 648, "training_iteration": 148, "trial_id": "bec7c_00000", "date": "2025-04-27_09-23-57", "timestamp": 1745745837, "time_this_iter_s": 25.984251022338867, "time_total_s": 2820.8042635917664, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2820.8042635917664, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 78.02432432432434, "ram_util_percent": 16.01621621621622}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.095970846095588, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.48106359700942714, "policy_loss": -0.0619278124368359, "vf_loss": 0.0070893792429893845, "vf_explained_var": 0.7892323982331061, "kl": 0.007622045843891101, "entropy": 43.45787130786527, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.16089999999986, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668, 15.369999999999825, 14.129999999999827, 14.129999999999825, 14.309999999999823, 14.02999999999983, 15.064999999999811, 14.129999999999821, 31.249999999999645], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605517953554, "mean_inference_ms": 2.2604799517974468, "mean_action_processing_ms": 0.23905610512956024, "mean_env_wait_ms": 65.769778565068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04643058776855469, "StateBufferConnector_ms": 0.006522655487060547, "ViewRequirementAgentConnector_ms": 0.16027188301086426}}, "episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.16089999999986, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.02999999999983, 14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668, 15.369999999999825, 14.129999999999827, 14.129999999999825, 14.309999999999823, 14.02999999999983, 15.064999999999811, 14.129999999999821, 31.249999999999645], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4686605517953554, "mean_inference_ms": 2.2604799517974468, "mean_action_processing_ms": 0.23905610512956024, "mean_env_wait_ms": 65.769778565068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04643058776855469, "StateBufferConnector_ms": 0.006522655487060547, "ViewRequirementAgentConnector_ms": 0.16027188301086426}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.042372501527, "num_env_steps_trained_throughput_per_sec": 210.042372501527, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 20126.03, "sample_time_ms": 16362.927, "load_time_ms": 485.113, "load_throughput": 8245.497, "learn_time_ms": 3228.585, "learn_throughput": 1238.933, "synch_weights_time_ms": 46.167}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 648, "training_iteration": 149, "trial_id": "bec7c_00000", "date": "2025-04-27_09-24-17", "timestamp": 1745745857, "time_this_iter_s": 19.05205798149109, "time_total_s": 2839.8563215732574, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2839.8563215732574, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 57.29259259259259, "ram_util_percent": 14.288888888888888}}
{"custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.095970846095588, "cur_lr": 3.0000000000000004e-05, "total_loss": -0.4874720123386191, "policy_loss": -0.06427400319746905, "vf_loss": 0.006469760689416885, "vf_explained_var": 0.744716364529825, "kl": 0.005092184778168889, "entropy": 43.524865439630325, "entropy_coeff": 0.01}, "model": {}, "num_grad_updates_lifetime": 46345.5, "diff_num_grad_updates_vs_sampler_policy": 154.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.162699999999862, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"engage_action_count_mean": 0.0, "engage_action_count_min": 0, "engage_action_count_max": 0}, "hist_stats": {"episode_reward": [14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668, 15.369999999999825, 14.129999999999827, 14.129999999999825, 14.309999999999823, 14.02999999999983, 15.064999999999811, 14.129999999999821, 31.249999999999645, 14.209999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684942769126962, "mean_inference_ms": 2.2606212821495713, "mean_action_processing_ms": 0.2391079872683763, "mean_env_wait_ms": 65.75262702921722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04666638374328613, "StateBufferConnector_ms": 0.0065577030181884766, "ViewRequirementAgentConnector_ms": 0.16110515594482422}}, "episode_reward_max": 90.41000000000172, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.162699999999862, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999827, 14.129999999999832, 16.349999999999763, 14.129999999999821, 13.94999999999983, 13.94999999999983, 14.029999999999825, 14.02999999999983, 14.029999999999827, 14.949999999999807, 13.94999999999983, 14.12999999999982, 13.94999999999983, 14.229999999999832, 13.94999999999983, 17.80999999999973, 13.94999999999983, 13.94999999999983, 30.009999999999604, 13.94999999999983, 13.94999999999983, 70.61000000000155, 14.129999999999832, 13.94999999999983, 13.94999999999983, 18.22999999999966, 13.94999999999983, 14.309999999999823, 14.02999999999983, 13.94999999999983, 15.799999999999798, 16.069999999999805, 14.129999999999821, 16.529999999999752, 13.94999999999983, 14.209999999999818, 14.34999999999982, 14.82999999999982, 14.12999999999982, 14.309999999999828, 13.94999999999983, 13.94999999999983, 14.12999999999982, 27.329999999999593, 14.189999999999827, 13.94999999999983, 15.109999999999797, 13.94999999999983, 14.12999999999982, 31.88999999999966, 15.229999999999803, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 14.209999999999821, 14.20999999999982, 14.02999999999983, 13.94999999999983, 13.94999999999983, 31.20999999999965, 14.384999999999842, 13.94999999999983, 14.30999999999981, 14.129999999999832, 14.389999999999805, 13.94999999999983, 14.109999999999827, 75.19000000000153, 14.129999999999825, 15.289999999999813, 14.12999999999982, 15.194999999999805, 13.94999999999983, 15.499999999999778, 14.02999999999983, 90.41000000000172, 14.129999999999827, 13.94999999999983, 13.94999999999983, 14.924999999999983, 14.829999999999783, 13.94999999999983, 13.94999999999983, 14.589999999999813, 14.82999999999981, 13.94999999999983, 15.109999999999816, 14.729999999999798, 17.649999999999668, 15.369999999999825, 14.129999999999827, 14.129999999999825, 14.309999999999823, 14.02999999999983, 15.064999999999811, 14.129999999999821, 31.249999999999645, 14.209999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4684942769126962, "mean_inference_ms": 2.2606212821495713, "mean_action_processing_ms": 0.2391079872683763, "mean_env_wait_ms": 65.75262702921722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04666638374328613, "StateBufferConnector_ms": 0.0065577030181884766, "ViewRequirementAgentConnector_ms": 0.16110515594482422}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 192.34030889774624, "num_env_steps_trained_throughput_per_sec": 192.34030889774624, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 20355.856, "sample_time_ms": 16568.358, "load_time_ms": 485.851, "load_throughput": 8232.971, "learn_time_ms": 3251.814, "learn_throughput": 1230.083, "synch_weights_time_ms": 46.549}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": true, "episodes_total": 649, "training_iteration": 150, "trial_id": "bec7c_00000", "date": "2025-04-27_09-24-37", "timestamp": 1745745877, "time_this_iter_s": 20.806870460510254, "time_total_s": 2860.6631920337677, "pid": 930341, "hostname": "150-136-94-220", "node_ip": "10.19.89.17", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {"use_curiosity": true, "feature_dim": 288, "forward_net_hiddens": [256, 256], "inverse_net_hiddens": [256, 256], "curiosity_lr": 0.0005, "curiosity_weight": 0.05, "forward_loss_weight": 0.2}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x71ec7f846dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomMetricsCallback'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2860.6631920337677, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 79.07586206896552, "ram_util_percent": 15.258620689655174}}
