{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47472118937200114, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.2646135983891004, "policy_loss": -0.018991321634929326, "vf_loss": 0.009846298377458644, "vf_explained_var": 0.051411176112390336, "kl": 0.011136193367757551, "entropy": 25.76958189318257, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 310.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.80078230029662, "num_env_steps_trained_throughput_per_sec": 200.80078230029662, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 19920.203, "sample_time_ms": 10231.211, "load_time_ms": 0.271, "load_throughput": 14742720.562, "learn_time_ms": 9647.628, "learn_throughput": 414.61, "synch_weights_time_ms": 40.531}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "74231_00000", "date": "2025-04-22_13-52-12", "timestamp": 1745344332, "time_this_iter_s": 19.925379037857056, "time_total_s": 19.925379037857056, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 19.925379037857056, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.724137931034484, "ram_util_percent": 6.468965517241381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4998246537581567, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.26458842562391394, "policy_loss": -0.02250631249870264, "vf_loss": 0.015101526800924235, "vf_explained_var": 0.01868709393085972, "kl": 0.009546517650432502, "entropy": 25.90929479291362, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 930.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.67608522907915, "num_env_steps_trained_throughput_per_sec": 211.67608522907915, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 19408.485, "sample_time_ms": 10430.003, "load_time_ms": 165.752, "load_throughput": 24132.414, "learn_time_ms": 8779.871, "learn_throughput": 455.588, "synch_weights_time_ms": 32.334}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "74231_00000", "date": "2025-04-22_13-52-31", "timestamp": 1745344351, "time_this_iter_s": 18.90248203277588, "time_total_s": 38.827861070632935, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009965, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 38.827861070632935, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.41923076923077, "ram_util_percent": 7.319230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.2742196171033767, "policy_loss": -0.02749628414580178, "vf_loss": 0.011669960437129409, "vf_explained_var": 0.05242303071483489, "kl": 0.007244069278432665, "entropy": 25.984211174134284, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1550.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.52112077864183, "num_env_steps_trained_throughput_per_sec": 215.52112077864183, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 19125.537, "sample_time_ms": 10374.647, "load_time_ms": 221.53, "load_throughput": 18056.223, "learn_time_ms": 8500.468, "learn_throughput": 470.562, "synch_weights_time_ms": 28.387}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "74231_00000", "date": "2025-04-22_13-52-49", "timestamp": 1745344369, "time_this_iter_s": 18.565147876739502, "time_total_s": 57.39300894737244, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00993, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 57.39300894737244, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.203703703703702, "ram_util_percent": 7.5703703703703695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4987604212376379, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.2779872538193294, "policy_loss": -0.032306994201855795, "vf_loss": 0.01226468413822717, "vf_explained_var": 0.12470242188822839, "kl": 0.010569066978314367, "entropy": 26.005876187355287, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2170.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.94957395656053, "num_env_steps_trained_throughput_per_sec": 212.94957395656053, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 19040.093, "sample_time_ms": 10413.018, "load_time_ms": 246.533, "load_throughput": 16225.018, "learn_time_ms": 8353.349, "learn_throughput": 478.85, "synch_weights_time_ms": 26.691}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "74231_00000", "date": "2025-04-22_13-53-08", "timestamp": 1745344388, "time_this_iter_s": 18.78852367401123, "time_total_s": 76.18153262138367, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009895000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 76.18153262138367, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.584615384615383, "ram_util_percent": 7.665384615384614}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49432278787416795, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.28499074810590114, "policy_loss": -0.03592730706347333, "vf_loss": 0.009067742957303117, "vf_explained_var": 0.1111979700865284, "kl": 0.008999437281420322, "entropy": 25.993107817249914, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2790.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.79653343364993, "num_env_steps_trained_throughput_per_sec": 203.79653343364993, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 19157.552, "sample_time_ms": 10608.537, "load_time_ms": 261.324, "load_throughput": 15306.673, "learn_time_ms": 8261.686, "learn_throughput": 484.163, "synch_weights_time_ms": 25.475}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "74231_00000", "date": "2025-04-22_13-53-28", "timestamp": 1745344408, "time_this_iter_s": 19.63260793685913, "time_total_s": 95.8141405582428, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00986, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 95.8141405582428, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.314814814814817, "ram_util_percent": 7.751851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.2891165473089073, "policy_loss": -0.03728749591992387, "vf_loss": 0.007707026401429527, "vf_explained_var": 0.14521650123980737, "kl": 0.008235363424814846, "entropy": 26.118315536745133, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3410.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.29091095525084, "num_env_steps_trained_throughput_per_sec": 221.29091095525084, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 18977.247, "sample_time_ms": 10493.533, "load_time_ms": 270.617, "load_throughput": 14781.022, "learn_time_ms": 8187.777, "learn_throughput": 488.533, "synch_weights_time_ms": 24.797}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 24, "training_iteration": 6, "trial_id": "74231_00000", "date": "2025-04-22_13-53-46", "timestamp": 1745344426, "time_this_iter_s": 18.081406116485596, "time_total_s": 113.8955466747284, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009825, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 113.8955466747284, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.157692307692308, "ram_util_percent": 7.750000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.29526438477492306, "policy_loss": -0.04166654590892816, "vf_loss": 0.006697784355492331, "vf_explained_var": 0.23119271061112803, "kl": 0.006498510440193176, "entropy": 26.15953338684574, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4030.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.41797247751364, "num_env_steps_trained_throughput_per_sec": 213.41797247751364, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 18943.717, "sample_time_ms": 10476.392, "load_time_ms": 278.359, "load_throughput": 14369.955, "learn_time_ms": 8164.327, "learn_throughput": 489.936, "synch_weights_time_ms": 24.124}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 24, "training_iteration": 7, "trial_id": "74231_00000", "date": "2025-04-22_13-54-04", "timestamp": 1745344444, "time_this_iter_s": 18.747430562973022, "time_total_s": 132.64297723770142, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00979, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 132.64297723770142, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.634615384615383, "ram_util_percent": 7.8076923076923075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4998642503253875, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.31691334348532463, "policy_loss": -0.06298811928098721, "vf_loss": 0.0057787773356399305, "vf_explained_var": 0.21796200486921494, "kl": 0.007562303430958925, "entropy": 26.12164691494357, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4650.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.8111075156787, "num_env_steps_trained_throughput_per_sec": 214.8111075156787, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 18903.375, "sample_time_ms": 10462.171, "load_time_ms": 295.945, "load_throughput": 13516.01, "learn_time_ms": 8120.851, "learn_throughput": 492.559, "synch_weights_time_ms": 23.895}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 24, "training_iteration": 8, "trial_id": "74231_00000", "date": "2025-04-22_13-54-23", "timestamp": 1745344463, "time_this_iter_s": 18.626753330230713, "time_total_s": 151.26973056793213, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009755, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 151.26973056793213, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.415384615384617, "ram_util_percent": 7.826923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3038427189180267, "policy_loss": -0.04887517435145715, "vf_loss": 0.00487995789423416, "vf_explained_var": 0.37405066720901, "kl": 0.00663242286886558, "entropy": 26.11739909571986, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5270.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.18742981069633, "num_env_steps_trained_throughput_per_sec": 211.18742981069633, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 18907.499, "sample_time_ms": 10490.276, "load_time_ms": 298.067, "load_throughput": 13419.806, "learn_time_ms": 8095.034, "learn_throughput": 494.13, "synch_weights_time_ms": 23.6}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 24, "training_iteration": 9, "trial_id": "74231_00000", "date": "2025-04-22_13-54-42", "timestamp": 1745344482, "time_this_iter_s": 18.946098566055298, "time_total_s": 170.21582913398743, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00972, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 170.21582913398743, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.755555555555553, "ram_util_percent": 7.870370370370371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.30620984291214676, "policy_loss": -0.04994552117779911, "vf_loss": 0.003918632477530815, "vf_explained_var": 0.40120624409567923, "kl": 0.0062576695478011035, "entropy": 26.14344937416815, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5890.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.19395833333326, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3901388532118575, "mean_inference_ms": 1.7026569916067782, "mean_action_processing_ms": 0.185686189999731, "mean_env_wait_ms": 44.617645836995116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055439273516337075, "StateBufferConnector_ms": 0.00516672929128011, "ViewRequirementAgentConnector_ms": 0.1312802235285441}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.5639040968962, "num_env_steps_trained_throughput_per_sec": 215.5639040968962, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 18872.345, "sample_time_ms": 10479.027, "load_time_ms": 299.845, "load_throughput": 13340.211, "learn_time_ms": 8069.718, "learn_throughput": 495.68, "synch_weights_time_ms": 23.23}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 24, "training_iteration": 10, "trial_id": "74231_00000", "date": "2025-04-22_13-55-01", "timestamp": 1745344501, "time_this_iter_s": 18.56104063987732, "time_total_s": 188.77686977386475, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009685000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 188.77686977386475, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.384615384615383, "ram_util_percent": 7.949999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3147281966157137, "policy_loss": -0.05855688285983859, "vf_loss": 0.00411795464970055, "vf_explained_var": 0.48530265362032, "kl": 0.0071190274342188276, "entropy": 26.1713080006261, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6510.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.050833333333248, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417548441085975, "mean_inference_ms": 1.7059286221734737, "mean_action_processing_ms": 0.184724421823555, "mean_env_wait_ms": 44.86471650076887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449006954828898, "StateBufferConnector_ms": 0.004972517490386963, "ViewRequirementAgentConnector_ms": 0.1290281613667806}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.050833333333248, "episode_len_mean": 900.0, "episodes_this_iter": 24, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417548441085975, "mean_inference_ms": 1.7059286221734737, "mean_action_processing_ms": 0.184724421823555, "mean_env_wait_ms": 44.86471650076887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449006954828898, "StateBufferConnector_ms": 0.004972517490386963, "ViewRequirementAgentConnector_ms": 0.1290281613667806}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.75563556679774, "num_env_steps_trained_throughput_per_sec": 214.75563556679774, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 18742.904, "sample_time_ms": 10494.246, "load_time_ms": 330.996, "load_throughput": 12084.728, "learn_time_ms": 7895.938, "learn_throughput": 506.59, "synch_weights_time_ms": 21.208}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 48, "training_iteration": 11, "trial_id": "74231_00000", "date": "2025-04-22_13-55-19", "timestamp": 1745344519, "time_this_iter_s": 18.631540060043335, "time_total_s": 207.40840983390808, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00965, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 207.40840983390808, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.434615384615388, "ram_util_percent": 7.961538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3021860731258658, "policy_loss": -0.04707362170766799, "vf_loss": 0.004105732333442985, "vf_explained_var": 0.3929525679157626, "kl": 0.009445107974522304, "entropy": 26.110720852882633, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7130.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.050833333333248, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417548441085975, "mean_inference_ms": 1.7059286221734737, "mean_action_processing_ms": 0.184724421823555, "mean_env_wait_ms": 44.86471650076887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449006954828898, "StateBufferConnector_ms": 0.004972517490386963, "ViewRequirementAgentConnector_ms": 0.1290281613667806}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.050833333333248, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417548441085975, "mean_inference_ms": 1.7059286221734737, "mean_action_processing_ms": 0.184724421823555, "mean_env_wait_ms": 44.86471650076887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449006954828898, "StateBufferConnector_ms": 0.004972517490386963, "ViewRequirementAgentConnector_ms": 0.1290281613667806}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.34847953930296, "num_env_steps_trained_throughput_per_sec": 216.34847953930296, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 18702.094, "sample_time_ms": 10458.617, "load_time_ms": 329.939, "load_throughput": 12123.46, "learn_time_ms": 7892.154, "learn_throughput": 506.833, "synch_weights_time_ms": 20.868}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 48, "training_iteration": 12, "trial_id": "74231_00000", "date": "2025-04-22_13-55-38", "timestamp": 1745344538, "time_this_iter_s": 18.493877410888672, "time_total_s": 225.90228724479675, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009615, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 225.90228724479675, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.653846153846153, "ram_util_percent": 7.973076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49995463961555114, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3176754681119365, "policy_loss": -0.061944548075928564, "vf_loss": 0.003906324906963545, "vf_explained_var": 0.4713158376755253, "kl": 0.007063482186757967, "entropy": 26.104994700031895, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7750.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.050833333333248, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417548441085975, "mean_inference_ms": 1.7059286221734737, "mean_action_processing_ms": 0.184724421823555, "mean_env_wait_ms": 44.86471650076887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449006954828898, "StateBufferConnector_ms": 0.004972517490386963, "ViewRequirementAgentConnector_ms": 0.1290281613667806}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.050833333333248, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417548441085975, "mean_inference_ms": 1.7059286221734737, "mean_action_processing_ms": 0.184724421823555, "mean_env_wait_ms": 44.86471650076887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449006954828898, "StateBufferConnector_ms": 0.004972517490386963, "ViewRequirementAgentConnector_ms": 0.1290281613667806}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.34634214038448, "num_env_steps_trained_throughput_per_sec": 204.34634214038448, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 18803.588, "sample_time_ms": 10561.39, "load_time_ms": 334.917, "load_throughput": 11943.244, "learn_time_ms": 7885.97, "learn_throughput": 507.23, "synch_weights_time_ms": 20.788}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 48, "training_iteration": 13, "trial_id": "74231_00000", "date": "2025-04-22_13-55-57", "timestamp": 1745344557, "time_this_iter_s": 19.57982563972473, "time_total_s": 245.48211288452148, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00958, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 245.48211288452148, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.855555555555554, "ram_util_percent": 8.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4992327606005053, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3209135669912587, "policy_loss": -0.06478098110416003, "vf_loss": 0.004051600703091789, "vf_explained_var": 0.5265274656395759, "kl": 0.005736560735186363, "entropy": 26.133150983625843, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8370.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.050833333333248, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417548441085975, "mean_inference_ms": 1.7059286221734737, "mean_action_processing_ms": 0.184724421823555, "mean_env_wait_ms": 44.86471650076887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449006954828898, "StateBufferConnector_ms": 0.004972517490386963, "ViewRequirementAgentConnector_ms": 0.1290281613667806}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 18.050833333333248, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38417548441085975, "mean_inference_ms": 1.7059286221734737, "mean_action_processing_ms": 0.184724421823555, "mean_env_wait_ms": 44.86471650076887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449006954828898, "StateBufferConnector_ms": 0.004972517490386963, "ViewRequirementAgentConnector_ms": 0.1290281613667806}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.1808631735878, "num_env_steps_trained_throughput_per_sec": 209.1808631735878, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 18837.43, "sample_time_ms": 10587.353, "load_time_ms": 334.876, "load_throughput": 11944.703, "learn_time_ms": 7893.873, "learn_throughput": 506.722, "synch_weights_time_ms": 20.792}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 48, "training_iteration": 14, "trial_id": "74231_00000", "date": "2025-04-22_13-56-17", "timestamp": 1745344577, "time_this_iter_s": 19.127298831939697, "time_total_s": 264.6094117164612, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009545, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 264.6094117164612, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.314814814814813, "ram_util_percent": 7.903703703703705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4978366920544255, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.29123664875064165, "policy_loss": -0.0397045841921241, "vf_loss": 0.008724641379104293, "vf_explained_var": 0.4964813777515965, "kl": 0.0077950121433640294, "entropy": 26.181571495917535, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8990.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.99557142857135, "episode_len_mean": 895.8367346938776, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838287159517435, "mean_inference_ms": 1.7060466350234296, "mean_action_processing_ms": 0.18468338057262412, "mean_env_wait_ms": 44.84436476191941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05407430687729193, "StateBufferConnector_ms": 0.00496640497324418, "ViewRequirementAgentConnector_ms": 0.12875089840013154}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.99557142857135, "episode_len_mean": 895.8367346938776, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838287159517435, "mean_inference_ms": 1.7060466350234296, "mean_action_processing_ms": 0.18468338057262412, "mean_env_wait_ms": 44.84436476191941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05407430687729193, "StateBufferConnector_ms": 0.00496640497324418, "ViewRequirementAgentConnector_ms": 0.12875089840013154}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.07101566043795, "num_env_steps_trained_throughput_per_sec": 210.07101566043795, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 18778.806, "sample_time_ms": 10527.536, "load_time_ms": 334.319, "load_throughput": 11964.605, "learn_time_ms": 7895.723, "learn_throughput": 506.603, "synch_weights_time_ms": 20.707}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 49, "training_iteration": 15, "trial_id": "74231_00000", "date": "2025-04-22_13-56-36", "timestamp": 1745344596, "time_this_iter_s": 19.046435356140137, "time_total_s": 283.6558470726013, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00951, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 283.6558470726013, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.40740740740741, "ram_util_percent": 7.851851851851853}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4993560364650142, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3324278998939741, "policy_loss": -0.07359213260821097, "vf_loss": 0.0019448585479538802, "vf_explained_var": 0.5641384380479013, "kl": 0.006512741385027297, "entropy": 26.20831810735887, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9610.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.99557142857135, "episode_len_mean": 895.8367346938776, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838287159517435, "mean_inference_ms": 1.7060466350234296, "mean_action_processing_ms": 0.18468338057262412, "mean_env_wait_ms": 44.84436476191941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05407430687729193, "StateBufferConnector_ms": 0.00496640497324418, "ViewRequirementAgentConnector_ms": 0.12875089840013154}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.99557142857135, "episode_len_mean": 895.8367346938776, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838287159517435, "mean_inference_ms": 1.7060466350234296, "mean_action_processing_ms": 0.18468338057262412, "mean_env_wait_ms": 44.84436476191941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05407430687729193, "StateBufferConnector_ms": 0.00496640497324418, "ViewRequirementAgentConnector_ms": 0.12875089840013154}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.9970864239328, "num_env_steps_trained_throughput_per_sec": 210.9970864239328, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 18866.993, "sample_time_ms": 10604.018, "load_time_ms": 334.355, "load_throughput": 11963.323, "learn_time_ms": 7907.297, "learn_throughput": 505.862, "synch_weights_time_ms": 20.798}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 49, "training_iteration": 16, "trial_id": "74231_00000", "date": "2025-04-22_13-56-55", "timestamp": 1745344615, "time_this_iter_s": 18.962854862213135, "time_total_s": 302.61870193481445, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009475, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 302.61870193481445, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.303703703703704, "ram_util_percent": 7.800000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49971711765373905, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3086187270800433, "policy_loss": -0.05257355066376829, "vf_loss": 0.004110811635318016, "vf_explained_var": 0.7923021833742818, "kl": 0.010391592750567079, "entropy": 26.22343110730571, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10230.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.860597222222136, "episode_len_mean": 897.1666666666666, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813845371289919, "mean_inference_ms": 1.707187100502721, "mean_action_processing_ms": 0.18413261979025483, "mean_env_wait_ms": 44.93699045835305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0542547967698839, "StateBufferConnector_ms": 0.004909435907999675, "ViewRequirementAgentConnector_ms": 0.12806521521674263}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.860597222222136, "episode_len_mean": 897.1666666666666, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813845371289919, "mean_inference_ms": 1.707187100502721, "mean_action_processing_ms": 0.18413261979025483, "mean_env_wait_ms": 44.93699045835305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0542547967698839, "StateBufferConnector_ms": 0.004909435907999675, "ViewRequirementAgentConnector_ms": 0.12806521521674263}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.77919595999856, "num_env_steps_trained_throughput_per_sec": 213.77919595999856, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 18863.826, "sample_time_ms": 10611.075, "load_time_ms": 331.434, "load_throughput": 12068.777, "learn_time_ms": 7899.813, "learn_throughput": 506.341, "synch_weights_time_ms": 20.962}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 72, "training_iteration": 17, "trial_id": "74231_00000", "date": "2025-04-22_13-57-13", "timestamp": 1745344633, "time_this_iter_s": 18.717204809188843, "time_total_s": 321.3359067440033, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00944, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 321.3359067440033, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.49230769230769, "ram_util_percent": 7.726923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4999570016418734, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.30255050716861603, "policy_loss": -0.04392901475451166, "vf_loss": 0.0034195366713344897, "vf_explained_var": 0.39371368365903053, "kl": 0.007284784223824597, "entropy": 26.34979953765869, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10850.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.860597222222136, "episode_len_mean": 897.1666666666666, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813845371289919, "mean_inference_ms": 1.707187100502721, "mean_action_processing_ms": 0.18413261979025483, "mean_env_wait_ms": 44.93699045835305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0542547967698839, "StateBufferConnector_ms": 0.004909435907999675, "ViewRequirementAgentConnector_ms": 0.12806521521674263}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.860597222222136, "episode_len_mean": 897.1666666666666, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813845371289919, "mean_inference_ms": 1.707187100502721, "mean_action_processing_ms": 0.18413261979025483, "mean_env_wait_ms": 44.93699045835305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0542547967698839, "StateBufferConnector_ms": 0.004909435907999675, "ViewRequirementAgentConnector_ms": 0.12806521521674263}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.3910855085241, "num_env_steps_trained_throughput_per_sec": 213.3910855085241, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 18876.217, "sample_time_ms": 10620.868, "load_time_ms": 320.428, "load_throughput": 12483.298, "learn_time_ms": 7913.597, "learn_throughput": 505.459, "synch_weights_time_ms": 20.777}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 72, "training_iteration": 18, "trial_id": "74231_00000", "date": "2025-04-22_13-57-32", "timestamp": 1745344652, "time_this_iter_s": 18.750295400619507, "time_total_s": 340.0862021446228, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009405, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 340.0862021446228, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.934615384615384, "ram_util_percent": 7.8730769230769235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3116351589220651, "policy_loss": -0.05661301406160478, "vf_loss": 0.00704303467062991, "vf_explained_var": 0.3910647936405674, "kl": 0.007650133138153904, "entropy": 26.359520942934097, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11470.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.860597222222136, "episode_len_mean": 897.1666666666666, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813845371289919, "mean_inference_ms": 1.707187100502721, "mean_action_processing_ms": 0.18413261979025483, "mean_env_wait_ms": 44.93699045835305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0542547967698839, "StateBufferConnector_ms": 0.004909435907999675, "ViewRequirementAgentConnector_ms": 0.12806521521674263}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.860597222222136, "episode_len_mean": 897.1666666666666, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813845371289919, "mean_inference_ms": 1.707187100502721, "mean_action_processing_ms": 0.18413261979025483, "mean_env_wait_ms": 44.93699045835305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0542547967698839, "StateBufferConnector_ms": 0.004909435907999675, "ViewRequirementAgentConnector_ms": 0.12806521521674263}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.3386808319222, "num_env_steps_trained_throughput_per_sec": 209.3386808319222, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 18892.945, "sample_time_ms": 10633.706, "load_time_ms": 321.318, "load_throughput": 12448.736, "learn_time_ms": 7916.65, "learn_throughput": 505.264, "synch_weights_time_ms": 20.724}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 72, "training_iteration": 19, "trial_id": "74231_00000", "date": "2025-04-22_13-57-51", "timestamp": 1745344671, "time_this_iter_s": 19.11302137374878, "time_total_s": 359.1992235183716, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00937, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 359.1992235183716, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.610714285714284, "ram_util_percent": 7.907142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4998471681148775, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3208053667518881, "policy_loss": -0.06391539383424266, "vf_loss": 0.005129315635091306, "vf_explained_var": 0.4970989348426942, "kl": 0.007631462877966001, "entropy": 26.354558572461528, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12090.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.860597222222136, "episode_len_mean": 897.1666666666666, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813845371289919, "mean_inference_ms": 1.707187100502721, "mean_action_processing_ms": 0.18413261979025483, "mean_env_wait_ms": 44.93699045835305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0542547967698839, "StateBufferConnector_ms": 0.004909435907999675, "ViewRequirementAgentConnector_ms": 0.12806521521674263}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.860597222222136, "episode_len_mean": 897.1666666666666, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813845371289919, "mean_inference_ms": 1.707187100502721, "mean_action_processing_ms": 0.18413261979025483, "mean_env_wait_ms": 44.93699045835305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0542547967698839, "StateBufferConnector_ms": 0.004909435907999675, "ViewRequirementAgentConnector_ms": 0.12806521521674263}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.6953220334162, "num_env_steps_trained_throughput_per_sec": 205.6953220334162, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 18981.97, "sample_time_ms": 10696.2, "load_time_ms": 321.463, "load_throughput": 12443.119, "learn_time_ms": 7942.923, "learn_throughput": 503.593, "synch_weights_time_ms": 20.84}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 72, "training_iteration": 20, "trial_id": "74231_00000", "date": "2025-04-22_13-58-11", "timestamp": 1745344691, "time_this_iter_s": 19.45212697982788, "time_total_s": 378.65135049819946, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009335, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 378.65135049819946, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.68148148148148, "ram_util_percent": 7.807407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4983132871889299, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.33050037560394907, "policy_loss": -0.07338506084183351, "vf_loss": 0.004529974445200247, "vf_explained_var": 0.5836460224082393, "kl": 0.006739650222927242, "entropy": 26.29932274664602, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12710.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.84702739726019, "episode_len_mean": 897.2054794520548, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38113936722812675, "mean_inference_ms": 1.7072121741066342, "mean_action_processing_ms": 0.18410733326524098, "mean_env_wait_ms": 44.92519732537744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053970781091141375, "StateBufferConnector_ms": 0.004896725693794146, "ViewRequirementAgentConnector_ms": 0.12785702535550889}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.84702739726019, "episode_len_mean": 897.2054794520548, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38113936722812675, "mean_inference_ms": 1.7072121741066342, "mean_action_processing_ms": 0.18410733326524098, "mean_env_wait_ms": 44.92519732537744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053970781091141375, "StateBufferConnector_ms": 0.004896725693794146, "ViewRequirementAgentConnector_ms": 0.12785702535550889}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.58496913980076, "num_env_steps_trained_throughput_per_sec": 209.58496913980076, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 19027.922, "sample_time_ms": 10744.621, "load_time_ms": 321.509, "load_throughput": 12441.34, "learn_time_ms": 7940.375, "learn_throughput": 503.755, "synch_weights_time_ms": 20.863}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 73, "training_iteration": 21, "trial_id": "74231_00000", "date": "2025-04-22_13-58-30", "timestamp": 1745344710, "time_this_iter_s": 19.090359926223755, "time_total_s": 397.7417104244232, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0093, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 397.7417104244232, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.814814814814813, "ram_util_percent": 7.829629629629631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3474486438887975, "policy_loss": -0.08877161601408114, "vf_loss": 0.001861911029399996, "vf_explained_var": 0.924192070672589, "kl": 0.007781956910302172, "entropy": 26.209533596038817, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13330.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.803937499999904, "episode_len_mean": 897.875, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794439253665649, "mean_inference_ms": 1.7083697810475806, "mean_action_processing_ms": 0.18376670318459162, "mean_env_wait_ms": 45.018213188187666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053932766119639076, "StateBufferConnector_ms": 0.004864980777104695, "ViewRequirementAgentConnector_ms": 0.1273381213347117}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.803937499999904, "episode_len_mean": 897.875, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794439253665649, "mean_inference_ms": 1.7083697810475806, "mean_action_processing_ms": 0.18376670318459162, "mean_env_wait_ms": 45.018213188187666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053932766119639076, "StateBufferConnector_ms": 0.004864980777104695, "ViewRequirementAgentConnector_ms": 0.1273381213347117}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.14664131116808, "num_env_steps_trained_throughput_per_sec": 218.14664131116808, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 19012.682, "sample_time_ms": 10733.306, "load_time_ms": 319.697, "load_throughput": 12511.845, "learn_time_ms": 7938.287, "learn_throughput": 503.887, "synch_weights_time_ms": 20.838}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 96, "training_iteration": 22, "trial_id": "74231_00000", "date": "2025-04-22_13-58-48", "timestamp": 1745344728, "time_this_iter_s": 18.342408418655396, "time_total_s": 416.0841188430786, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009265, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 416.0841188430786, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.176923076923075, "ram_util_percent": 7.796153846153848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4997676909450562, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3196718408958986, "policy_loss": -0.06132448032580977, "vf_loss": 0.0016994662251172779, "vf_explained_var": 0.6378736811299478, "kl": 0.006308184710499021, "entropy": 26.130846558847736, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13950.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.803937499999904, "episode_len_mean": 897.875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794439253665649, "mean_inference_ms": 1.7083697810475806, "mean_action_processing_ms": 0.18376670318459162, "mean_env_wait_ms": 45.018213188187666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053932766119639076, "StateBufferConnector_ms": 0.004864980777104695, "ViewRequirementAgentConnector_ms": 0.1273381213347117}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.803937499999904, "episode_len_mean": 897.875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794439253665649, "mean_inference_ms": 1.7083697810475806, "mean_action_processing_ms": 0.18376670318459162, "mean_env_wait_ms": 45.018213188187666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053932766119639076, "StateBufferConnector_ms": 0.004864980777104695, "ViewRequirementAgentConnector_ms": 0.1273381213347117}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.9840958773325, "num_env_steps_trained_throughput_per_sec": 212.9840958773325, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 18933.296, "sample_time_ms": 10656.872, "load_time_ms": 312.462, "load_throughput": 12801.567, "learn_time_ms": 7942.517, "learn_throughput": 503.619, "synch_weights_time_ms": 20.892}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 96, "training_iteration": 23, "trial_id": "74231_00000", "date": "2025-04-22_13-59-07", "timestamp": 1745344747, "time_this_iter_s": 18.786730766296387, "time_total_s": 434.870849609375, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00923, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 434.870849609375, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.107692307692307, "ram_util_percent": 7.776923076923079}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49945300793455494, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.34768205181256145, "policy_loss": -0.0888579688320357, "vf_loss": 0.0022508230176548926, "vf_explained_var": 0.7461334031435751, "kl": 0.007213214702993255, "entropy": 26.251754966858893, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14570.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.803937499999904, "episode_len_mean": 897.875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794439253665649, "mean_inference_ms": 1.7083697810475806, "mean_action_processing_ms": 0.18376670318459162, "mean_env_wait_ms": 45.018213188187666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053932766119639076, "StateBufferConnector_ms": 0.004864980777104695, "ViewRequirementAgentConnector_ms": 0.1273381213347117}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.803937499999904, "episode_len_mean": 897.875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794439253665649, "mean_inference_ms": 1.7083697810475806, "mean_action_processing_ms": 0.18376670318459162, "mean_env_wait_ms": 45.018213188187666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053932766119639076, "StateBufferConnector_ms": 0.004864980777104695, "ViewRequirementAgentConnector_ms": 0.1273381213347117}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.54377068297222, "num_env_steps_trained_throughput_per_sec": 203.54377068297222, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 18986.255, "sample_time_ms": 10719.334, "load_time_ms": 312.187, "load_throughput": 12812.82, "learn_time_ms": 7933.512, "learn_throughput": 504.19, "synch_weights_time_ms": 20.668}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 96, "training_iteration": 24, "trial_id": "74231_00000", "date": "2025-04-22_13-59-27", "timestamp": 1745344767, "time_this_iter_s": 19.65717387199402, "time_total_s": 454.528023481369, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009195, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 454.528023481369, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.557142857142857, "ram_util_percent": 7.8500000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4999446185846483, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3461748199973015, "policy_loss": -0.08657135581898112, "vf_loss": 0.001995328785501589, "vf_explained_var": 0.6495577473794261, "kl": 0.006723237840343509, "entropy": 26.294344077571747, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15190.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.803937499999904, "episode_len_mean": 897.875, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794439253665649, "mean_inference_ms": 1.7083697810475806, "mean_action_processing_ms": 0.18376670318459162, "mean_env_wait_ms": 45.018213188187666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053932766119639076, "StateBufferConnector_ms": 0.004864980777104695, "ViewRequirementAgentConnector_ms": 0.1273381213347117}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.803937499999904, "episode_len_mean": 897.875, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3794439253665649, "mean_inference_ms": 1.7083697810475806, "mean_action_processing_ms": 0.18376670318459162, "mean_env_wait_ms": 45.018213188187666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053932766119639076, "StateBufferConnector_ms": 0.004864980777104695, "ViewRequirementAgentConnector_ms": 0.1273381213347117}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.40781553429377, "num_env_steps_trained_throughput_per_sec": 211.40781553429377, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 18974.214, "sample_time_ms": 10711.692, "load_time_ms": 311.454, "load_throughput": 12842.986, "learn_time_ms": 7929.875, "learn_throughput": 504.422, "synch_weights_time_ms": 20.641}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 96, "training_iteration": 25, "trial_id": "74231_00000", "date": "2025-04-22_13-59-46", "timestamp": 1745344786, "time_this_iter_s": 18.94134759902954, "time_total_s": 473.46937108039856, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00916, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 473.46937108039856, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.57777777777778, "ram_util_percent": 7.837037037037038}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4988861150799259, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3241334830241789, "policy_loss": -0.06471923008681305, "vf_loss": 0.002107268587250503, "vf_explained_var": 0.6457703100096794, "kl": 0.006417495173368243, "entropy": 26.28050258390365, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15810.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.797402061855575, "episode_len_mean": 897.8969072164948, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793174267551724, "mean_inference_ms": 1.7084572630660604, "mean_action_processing_ms": 0.18375174343738482, "mean_env_wait_ms": 45.01183222570833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053905949150164105, "StateBufferConnector_ms": 0.004863001636623107, "ViewRequirementAgentConnector_ms": 0.12728332244243817}}, "episode_reward_max": 32.6249999999994, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.797402061855575, "episode_len_mean": 897.8969072164948, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.12999999999983, 16.91000000000003, 17.999999999999968, 24.219999999999676, 16.824999999999843, 32.6249999999994, 19.484999999999886, 18.09999999999996, 15.965000000000117, 16.92000000000003, 18.134999999999955, 16.675000000000026, 17.954999999999973, 19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793174267551724, "mean_inference_ms": 1.7084572630660604, "mean_action_processing_ms": 0.18375174343738482, "mean_env_wait_ms": 45.01183222570833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.053905949150164105, "StateBufferConnector_ms": 0.004863001636623107, "ViewRequirementAgentConnector_ms": 0.12728332244243817}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.55810658975835, "num_env_steps_trained_throughput_per_sec": 208.55810658975835, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 18996.383, "sample_time_ms": 10734.988, "load_time_ms": 312.248, "load_throughput": 12810.339, "learn_time_ms": 7928.178, "learn_throughput": 504.53, "synch_weights_time_ms": 20.415}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 97, "training_iteration": 26, "trial_id": "74231_00000", "date": "2025-04-22_14-00-05", "timestamp": 1745344805, "time_this_iter_s": 19.184590339660645, "time_total_s": 492.6539614200592, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009125, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 492.6539614200592, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.54814814814815, "ram_util_percent": 7.855555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48853706852082285, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.29170384874507305, "policy_loss": -0.03984252087952148, "vf_loss": 0.010564071259916326, "vf_explained_var": 0.8653316603552911, "kl": 0.007998761395438416, "entropy": 26.4025160174216, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16430.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.428774999999902, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772256030333033, "mean_inference_ms": 1.7100447713569813, "mean_action_processing_ms": 0.18329015315672148, "mean_env_wait_ms": 45.23777788776741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05339670181274414, "StateBufferConnector_ms": 0.00479888916015625, "ViewRequirementAgentConnector_ms": 0.12611174583435059}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.428774999999902, "episode_len_mean": 896.75, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.019999999999914, 17.77999999999999, 17.539999999999978, 16.169999999999888, 18.19499999999996, 17.404999999999998, 13.94999999999983, 17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772256030333033, "mean_inference_ms": 1.7100447713569813, "mean_action_processing_ms": 0.18329015315672148, "mean_env_wait_ms": 45.23777788776741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05339670181274414, "StateBufferConnector_ms": 0.00479888916015625, "ViewRequirementAgentConnector_ms": 0.12611174583435059}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.1331523851797, "num_env_steps_trained_throughput_per_sec": 216.1331523851797, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 18976.005, "sample_time_ms": 10725.268, "load_time_ms": 314.259, "load_throughput": 12728.375, "learn_time_ms": 7915.62, "learn_throughput": 505.33, "synch_weights_time_ms": 20.32}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 113, "training_iteration": 27, "trial_id": "74231_00000", "date": "2025-04-22_14-00-23", "timestamp": 1745344823, "time_this_iter_s": 18.51276206970215, "time_total_s": 511.16672348976135, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00909, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 511.16672348976135, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.296153846153842, "ram_util_percent": 7.826923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49880206503214375, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.31892967205738737, "policy_loss": -0.0589544283932135, "vf_loss": 0.0029509407424513716, "vf_explained_var": 0.5884580640062209, "kl": 0.007908733425339902, "entropy": 26.45079385695919, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17050.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.294824999999896, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37571948611653305, "mean_inference_ms": 1.7104635523847787, "mean_action_processing_ms": 0.18303579366817624, "mean_env_wait_ms": 45.209640337243755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05318164825439453, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.12530851364135742}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.294824999999896, "episode_len_mean": 896.75, "episodes_this_iter": 7, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37571948611653305, "mean_inference_ms": 1.7104635523847787, "mean_action_processing_ms": 0.18303579366817624, "mean_env_wait_ms": 45.209640337243755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05318164825439453, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.12530851364135742}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.11219464726406, "num_env_steps_trained_throughput_per_sec": 214.11219464726406, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 18969.692, "sample_time_ms": 10716.542, "load_time_ms": 314.435, "load_throughput": 12721.239, "learn_time_ms": 7917.781, "learn_throughput": 505.192, "synch_weights_time_ms": 20.388}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 120, "training_iteration": 28, "trial_id": "74231_00000", "date": "2025-04-22_14-00-42", "timestamp": 1745344842, "time_this_iter_s": 18.6874418258667, "time_total_s": 529.854165315628, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.009055, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 529.854165315628, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 18.807692307692307, "ram_util_percent": 7.834615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49986979716247126, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3340549881656414, "policy_loss": -0.07270598559182197, "vf_loss": 0.0028701955347412056, "vf_explained_var": 0.5109133888636866, "kl": 0.008247241794038752, "entropy": 26.586864631406723, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17670.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.294824999999896, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37571948611653305, "mean_inference_ms": 1.7104635523847787, "mean_action_processing_ms": 0.18303579366817624, "mean_env_wait_ms": 45.209640337243755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05318164825439453, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.12530851364135742}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.294824999999896, "episode_len_mean": 896.75, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37571948611653305, "mean_inference_ms": 1.7104635523847787, "mean_action_processing_ms": 0.18303579366817624, "mean_env_wait_ms": 45.209640337243755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05318164825439453, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.12530851364135742}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.21583570875174, "num_env_steps_trained_throughput_per_sec": 211.21583570875174, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 18952.71, "sample_time_ms": 10698.823, "load_time_ms": 311.119, "load_throughput": 12856.832, "learn_time_ms": 7921.915, "learn_throughput": 504.928, "synch_weights_time_ms": 20.302}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 120, "training_iteration": 29, "trial_id": "74231_00000", "date": "2025-04-22_14-01-01", "timestamp": 1745344861, "time_this_iter_s": 18.94426679611206, "time_total_s": 548.7984321117401, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00902, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 548.7984321117401, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.599999999999998, "ram_util_percent": 7.896296296296297}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49924513538998944, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.32222518892705276, "policy_loss": -0.05880608630456751, "vf_loss": 0.0025853804585817524, "vf_explained_var": 0.5894814755647413, "kl": 0.006754403422614183, "entropy": 26.735537205972978, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18290.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.294824999999896, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37571948611653305, "mean_inference_ms": 1.7104635523847787, "mean_action_processing_ms": 0.18303579366817624, "mean_env_wait_ms": 45.209640337243755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05318164825439453, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.12530851364135742}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.294824999999896, "episode_len_mean": 896.75, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37571948611653305, "mean_inference_ms": 1.7104635523847787, "mean_action_processing_ms": 0.18303579366817624, "mean_env_wait_ms": 45.209640337243755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05318164825439453, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.12530851364135742}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.7413360038702, "num_env_steps_trained_throughput_per_sec": 213.7413360038702, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 18879.507, "sample_time_ms": 10656.298, "load_time_ms": 310.234, "load_throughput": 12893.49, "learn_time_ms": 7892.122, "learn_throughput": 506.835, "synch_weights_time_ms": 20.3}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 120, "training_iteration": 30, "trial_id": "74231_00000", "date": "2025-04-22_14-01-20", "timestamp": 1745344880, "time_this_iter_s": 18.719517707824707, "time_total_s": 567.5179498195648, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008985, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 567.5179498195648, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 18.569230769230767, "ram_util_percent": 7.884615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4952087551115021, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3587107783664138, "policy_loss": -0.09308718668236848, "vf_loss": 0.0010474268748478814, "vf_explained_var": 0.6218573553908255, "kl": 0.008655512756599966, "entropy": 26.840213000389838, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18910.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.294824999999896, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37571948611653305, "mean_inference_ms": 1.7104635523847787, "mean_action_processing_ms": 0.18303579366817624, "mean_env_wait_ms": 45.209640337243755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05318164825439453, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.12530851364135742}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.294824999999896, "episode_len_mean": 896.75, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.555000000000064, 18.089999999999964, 15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37571948611653305, "mean_inference_ms": 1.7104635523847787, "mean_action_processing_ms": 0.18303579366817624, "mean_env_wait_ms": 45.209640337243755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05318164825439453, "StateBufferConnector_ms": 0.004744291305541992, "ViewRequirementAgentConnector_ms": 0.12530851364135742}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.85089181837964, "num_env_steps_trained_throughput_per_sec": 207.85089181837964, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 18895.429, "sample_time_ms": 10621.244, "load_time_ms": 309.253, "load_throughput": 12934.411, "learn_time_ms": 7944.001, "learn_throughput": 503.525, "synch_weights_time_ms": 20.378}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 120, "training_iteration": 31, "trial_id": "74231_00000", "date": "2025-04-22_14-01-39", "timestamp": 1745344899, "time_this_iter_s": 19.250008583068848, "time_total_s": 586.7679584026337, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00895, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 586.7679584026337, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.52962962962963, "ram_util_percent": 7.966666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49618178980965766, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3473318391652297, "policy_loss": -0.08189716604125176, "vf_loss": 0.0021142234800509544, "vf_explained_var": 0.7251775160912545, "kl": 0.006580702514850512, "entropy": 26.886504151744226, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19530.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.2583249999999, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37538522039407524, "mean_inference_ms": 1.710958056619415, "mean_action_processing_ms": 0.18301334973199954, "mean_env_wait_ms": 45.21082947397308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05295062065124512, "StateBufferConnector_ms": 0.004732608795166016, "ViewRequirementAgentConnector_ms": 0.12507414817810059}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.2583249999999, "episode_len_mean": 896.75, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.640000000000068, 18.364999999999963, 25.119999999999635, 17.784999999999833, 16.86500000000009, 18.184999999999953, 14.54999999999983, 18.24999999999994, 14.489999999999839, 23.70499999999965, 16.084999999999788, 18.264999999999947, 18.559999999999924, 16.724999999999905, 18.36499999999993, 18.494999999999937, 17.85499999999997, 16.34499999999974, 20.344999999999846, 17.829999999999977, 17.015000000000015, 16.979999999999713, 17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37538522039407524, "mean_inference_ms": 1.710958056619415, "mean_action_processing_ms": 0.18301334973199954, "mean_env_wait_ms": 45.21082947397308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05295062065124512, "StateBufferConnector_ms": 0.004732608795166016, "ViewRequirementAgentConnector_ms": 0.12507414817810059}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.85071634634858, "num_env_steps_trained_throughput_per_sec": 209.85071634634858, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 18967.916, "sample_time_ms": 10687.087, "load_time_ms": 312.895, "load_throughput": 12783.823, "learn_time_ms": 7946.97, "learn_throughput": 503.336, "synch_weights_time_ms": 20.397}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 122, "training_iteration": 32, "trial_id": "74231_00000", "date": "2025-04-22_14-01-58", "timestamp": 1745344918, "time_this_iter_s": 19.066731452941895, "time_total_s": 605.8346898555756, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008915, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 605.8346898555756, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.985185185185184, "ram_util_percent": 7.985185185185186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4973444477925377, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3245543993979452, "policy_loss": -0.06236595006231519, "vf_loss": 0.004509233183923624, "vf_explained_var": 0.6756023735769333, "kl": 0.0077457202971022675, "entropy": 26.82468293712985, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20150.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.004424999999898, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999], "episode_lengths": [900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37354236694699694, "mean_inference_ms": 1.7116562146795977, "mean_action_processing_ms": 0.1826352146809623, "mean_env_wait_ms": 45.30648291731771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05296897888183594, "StateBufferConnector_ms": 0.004694461822509766, "ViewRequirementAgentConnector_ms": 0.1241452693939209}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.004424999999898, "episode_len_mean": 896.75, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999], "episode_lengths": [900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37354236694699694, "mean_inference_ms": 1.7116562146795977, "mean_action_processing_ms": 0.1826352146809623, "mean_env_wait_ms": 45.30648291731771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05296897888183594, "StateBufferConnector_ms": 0.004694461822509766, "ViewRequirementAgentConnector_ms": 0.1241452693939209}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.1078484460079, "num_env_steps_trained_throughput_per_sec": 216.1078484460079, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 18940.77, "sample_time_ms": 10659.775, "load_time_ms": 313.465, "load_throughput": 12760.604, "learn_time_ms": 7946.514, "learn_throughput": 503.365, "synch_weights_time_ms": 20.447}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 144, "training_iteration": 33, "trial_id": "74231_00000", "date": "2025-04-22_14-02-17", "timestamp": 1745344937, "time_this_iter_s": 18.51513433456421, "time_total_s": 624.3498241901398, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00888, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 624.3498241901398, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.449999999999996, "ram_util_percent": 7.81923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4999763050386983, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.34017728147802934, "policy_loss": -0.07778976705045469, "vf_loss": 0.0045406687430195524, "vf_explained_var": 0.5327319660494404, "kl": 0.009032796101271215, "entropy": 26.873474677916494, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20770.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.004424999999898, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999], "episode_lengths": [900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37354236694699694, "mean_inference_ms": 1.7116562146795977, "mean_action_processing_ms": 0.1826352146809623, "mean_env_wait_ms": 45.30648291731771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05296897888183594, "StateBufferConnector_ms": 0.004694461822509766, "ViewRequirementAgentConnector_ms": 0.1241452693939209}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.004424999999898, "episode_len_mean": 896.75, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999], "episode_lengths": [900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37354236694699694, "mean_inference_ms": 1.7116562146795977, "mean_action_processing_ms": 0.1826352146809623, "mean_env_wait_ms": 45.30648291731771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05296897888183594, "StateBufferConnector_ms": 0.004694461822509766, "ViewRequirementAgentConnector_ms": 0.1241452693939209}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.52251733761557, "num_env_steps_trained_throughput_per_sec": 213.52251733761557, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 18848.929, "sample_time_ms": 10566.024, "load_time_ms": 312.03, "load_throughput": 12819.287, "learn_time_ms": 7949.696, "learn_throughput": 503.164, "synch_weights_time_ms": 20.609}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 144, "training_iteration": 34, "trial_id": "74231_00000", "date": "2025-04-22_14-02-35", "timestamp": 1745344955, "time_this_iter_s": 18.739617347717285, "time_total_s": 643.089441537857, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008845, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 643.089441537857, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 19.049999999999997, "ram_util_percent": 7.853846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4976062290130123, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3393628013924876, "policy_loss": -0.07586668269828924, "vf_loss": 0.004461993572481187, "vf_explained_var": 0.5537515815227262, "kl": 0.006755521590880122, "entropy": 26.930922665134553, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21390.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.004424999999898, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999], "episode_lengths": [900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37354236694699694, "mean_inference_ms": 1.7116562146795977, "mean_action_processing_ms": 0.1826352146809623, "mean_env_wait_ms": 45.30648291731771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05296897888183594, "StateBufferConnector_ms": 0.004694461822509766, "ViewRequirementAgentConnector_ms": 0.1241452693939209}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.004424999999898, "episode_len_mean": 896.75, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999], "episode_lengths": [900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37354236694699694, "mean_inference_ms": 1.7116562146795977, "mean_action_processing_ms": 0.1826352146809623, "mean_env_wait_ms": 45.30648291731771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05296897888183594, "StateBufferConnector_ms": 0.004694461822509766, "ViewRequirementAgentConnector_ms": 0.1241452693939209}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.37608929505316, "num_env_steps_trained_throughput_per_sec": 208.37608929505316, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 18876.457, "sample_time_ms": 10592.982, "load_time_ms": 311.8, "load_throughput": 12828.746, "learn_time_ms": 7950.342, "learn_throughput": 503.123, "synch_weights_time_ms": 20.752}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 144, "training_iteration": 35, "trial_id": "74231_00000", "date": "2025-04-22_14-02-55", "timestamp": 1745344975, "time_this_iter_s": 19.201712369918823, "time_total_s": 662.2911539077759, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00881, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 662.2911539077759, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 17.58214285714286, "ram_util_percent": 7.949999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49359854959672494, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.355084746799642, "policy_loss": -0.08828978741526483, "vf_loss": 0.001782526451484779, "vf_explained_var": 0.5546291988703512, "kl": 0.007751961208296345, "entropy": 27.012788188072943, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22010.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.004424999999898, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999], "episode_lengths": [900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37354236694699694, "mean_inference_ms": 1.7116562146795977, "mean_action_processing_ms": 0.1826352146809623, "mean_env_wait_ms": 45.30648291731771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05296897888183594, "StateBufferConnector_ms": 0.004694461822509766, "ViewRequirementAgentConnector_ms": 0.1241452693939209}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 17.004424999999898, "episode_len_mean": 896.75, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.89999999999998, 17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999], "episode_lengths": [900, 900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37354236694699694, "mean_inference_ms": 1.7116562146795977, "mean_action_processing_ms": 0.1826352146809623, "mean_env_wait_ms": 45.30648291731771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05296897888183594, "StateBufferConnector_ms": 0.004694461822509766, "ViewRequirementAgentConnector_ms": 0.1241452693939209}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.27254148843014, "num_env_steps_trained_throughput_per_sec": 209.27254148843014, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 18869.909, "sample_time_ms": 10574.936, "load_time_ms": 320.619, "load_throughput": 12475.864, "learn_time_ms": 7952.841, "learn_throughput": 502.965, "synch_weights_time_ms": 20.931}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 144, "training_iteration": 36, "trial_id": "74231_00000", "date": "2025-04-22_14-03-14", "timestamp": 1745344994, "time_this_iter_s": 19.119564294815063, "time_total_s": 681.4107182025909, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008775, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 681.4107182025909, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.92222222222222, "ram_util_percent": 7.955555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4957027288213853, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3373806709258427, "policy_loss": -0.06929820557875979, "vf_loss": 0.0026862545968616624, "vf_explained_var": 0.6097950668104233, "kl": 0.007282250777191826, "entropy": 27.222517662663613, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22630.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 16.969124999999895, "episode_len_mean": 896.75, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827], "episode_lengths": [900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3734430342691761, "mean_inference_ms": 1.7116389198645896, "mean_action_processing_ms": 0.18261867446472915, "mean_env_wait_ms": 45.30602117403926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05298447608947754, "StateBufferConnector_ms": 0.00469207763671875, "ViewRequirementAgentConnector_ms": 0.12413644790649414}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 14.029999999999827, "episode_reward_mean": 16.969124999999895, "episode_len_mean": 896.75, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.284999999999993, 16.785000000000046, 16.000000000000124, 15.343000000000098, 17.29500000000001, 16.089999999999794, 14.26999999999982, 18.130000000000003, 16.640000000000065, 17.920000000000034, 14.289999999999825, 17.12499999999996, 18.149999999999956, 23.379999999999704, 16.935000000000084, 15.044999999999813, 19.279999999999877, 14.289999999999827, 15.460000000000003, 18.464999999999936, 14.919999999999828, 18.24999999999995, 17.904999999999948, 17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827], "episode_lengths": [900, 900, 900, 696, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3734430342691761, "mean_inference_ms": 1.7116389198645896, "mean_action_processing_ms": 0.18261867446472915, "mean_env_wait_ms": 45.30602117403926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05298447608947754, "StateBufferConnector_ms": 0.00469207763671875, "ViewRequirementAgentConnector_ms": 0.12413644790649414}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.68923785123854, "num_env_steps_trained_throughput_per_sec": 209.68923785123854, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 18926.783, "sample_time_ms": 10624.278, "load_time_ms": 319.783, "load_throughput": 12508.466, "learn_time_ms": 7961.163, "learn_throughput": 502.439, "synch_weights_time_ms": 20.966}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 145, "training_iteration": 37, "trial_id": "74231_00000", "date": "2025-04-22_14-03-33", "timestamp": 1745345013, "time_this_iter_s": 19.081390142440796, "time_total_s": 700.4921083450317, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00874, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 700.4921083450317, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.72962962962963, "ram_util_percent": 7.966666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4940342418609127, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.34930977870507407, "policy_loss": -0.08046009542210208, "vf_loss": 0.001976844489870693, "vf_explained_var": 0.8634044122311377, "kl": 0.009174295901480476, "entropy": 27.266139424231746, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23250.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.077394999999868, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37247938346353165, "mean_inference_ms": 1.7134984654247205, "mean_action_processing_ms": 0.18247656968928883, "mean_env_wait_ms": 45.425800740123606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052674293518066406, "StateBufferConnector_ms": 0.004671335220336914, "ViewRequirementAgentConnector_ms": 0.12364959716796875}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.077394999999868, "episode_len_mean": 898.79, "episodes_this_iter": 23, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37247938346353165, "mean_inference_ms": 1.7134984654247205, "mean_action_processing_ms": 0.18247656968928883, "mean_env_wait_ms": 45.425800740123606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052674293518066406, "StateBufferConnector_ms": 0.004671335220336914, "ViewRequirementAgentConnector_ms": 0.12364959716796875}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.56275092212806, "num_env_steps_trained_throughput_per_sec": 207.56275092212806, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 18985.731, "sample_time_ms": 10666.285, "load_time_ms": 319.16, "load_throughput": 12532.898, "learn_time_ms": 7978.83, "learn_throughput": 501.327, "synch_weights_time_ms": 20.868}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 168, "training_iteration": 38, "trial_id": "74231_00000", "date": "2025-04-22_14-03-52", "timestamp": 1745345032, "time_this_iter_s": 19.277559995651245, "time_total_s": 719.769668340683, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008705000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 719.769668340683, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 17.84444444444444, "ram_util_percent": 7.9444444444444455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4999507160917405, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.32843217510249345, "policy_loss": -0.06254065727304307, "vf_loss": 0.0019539141990706763, "vf_explained_var": 0.5909038237025661, "kl": 0.006687367919233023, "entropy": 26.91829125496649, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23870.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.077394999999868, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37247938346353165, "mean_inference_ms": 1.7134984654247205, "mean_action_processing_ms": 0.18247656968928883, "mean_env_wait_ms": 45.425800740123606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052674293518066406, "StateBufferConnector_ms": 0.004671335220336914, "ViewRequirementAgentConnector_ms": 0.12364959716796875}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.077394999999868, "episode_len_mean": 898.79, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37247938346353165, "mean_inference_ms": 1.7134984654247205, "mean_action_processing_ms": 0.18247656968928883, "mean_env_wait_ms": 45.425800740123606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052674293518066406, "StateBufferConnector_ms": 0.004671335220336914, "ViewRequirementAgentConnector_ms": 0.12364959716796875}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.77821636063584, "num_env_steps_trained_throughput_per_sec": 216.77821636063584, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 18937.138, "sample_time_ms": 10623.499, "load_time_ms": 321.476, "load_throughput": 12442.59, "learn_time_ms": 7970.564, "learn_throughput": 501.847, "synch_weights_time_ms": 21.019}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 168, "training_iteration": 39, "trial_id": "74231_00000", "date": "2025-04-22_14-04-11", "timestamp": 1745345051, "time_this_iter_s": 18.457763671875, "time_total_s": 738.227432012558, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00867, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 738.227432012558, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.842307692307692, "ram_util_percent": 7.93846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.499166343673583, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.334830992763877, "policy_loss": -0.06941662464711455, "vf_loss": 0.003600340828891222, "vf_explained_var": 0.5137418056688001, "kl": 0.00843074708277967, "entropy": 27.07008599312075, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24490.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.077394999999868, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37247938346353165, "mean_inference_ms": 1.7134984654247205, "mean_action_processing_ms": 0.18247656968928883, "mean_env_wait_ms": 45.425800740123606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052674293518066406, "StateBufferConnector_ms": 0.004671335220336914, "ViewRequirementAgentConnector_ms": 0.12364959716796875}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.077394999999868, "episode_len_mean": 898.79, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37247938346353165, "mean_inference_ms": 1.7134984654247205, "mean_action_processing_ms": 0.18247656968928883, "mean_env_wait_ms": 45.425800740123606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052674293518066406, "StateBufferConnector_ms": 0.004671335220336914, "ViewRequirementAgentConnector_ms": 0.12364959716796875}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.48280984653206, "num_env_steps_trained_throughput_per_sec": 212.48280984653206, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 18948.222, "sample_time_ms": 10630.963, "load_time_ms": 321.802, "load_throughput": 12429.998, "learn_time_ms": 7974.052, "learn_throughput": 501.627, "synch_weights_time_ms": 20.819}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 168, "training_iteration": 40, "trial_id": "74231_00000", "date": "2025-04-22_14-04-29", "timestamp": 1745345069, "time_this_iter_s": 18.830381393432617, "time_total_s": 757.0578134059906, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008635, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 757.0578134059906, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 19.096153846153847, "ram_util_percent": 7.953846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4996330251616816, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3297410038917611, "policy_loss": -0.062448884968105106, "vf_loss": 0.0038384535887064797, "vf_explained_var": 0.6718375246370992, "kl": 0.006638093288687918, "entropy": 27.245819510183026, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25110.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.077394999999868, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37247938346353165, "mean_inference_ms": 1.7134984654247205, "mean_action_processing_ms": 0.18247656968928883, "mean_env_wait_ms": 45.425800740123606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052674293518066406, "StateBufferConnector_ms": 0.004671335220336914, "ViewRequirementAgentConnector_ms": 0.12364959716796875}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.077394999999868, "episode_len_mean": 898.79, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.55999999999997, 18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37247938346353165, "mean_inference_ms": 1.7134984654247205, "mean_action_processing_ms": 0.18247656968928883, "mean_env_wait_ms": 45.425800740123606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052674293518066406, "StateBufferConnector_ms": 0.004671335220336914, "ViewRequirementAgentConnector_ms": 0.12364959716796875}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.446794606184, "num_env_steps_trained_throughput_per_sec": 210.446794606184, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 18924.484, "sample_time_ms": 10644.698, "load_time_ms": 332.374, "load_throughput": 12034.646, "learn_time_ms": 7926.006, "learn_throughput": 504.668, "synch_weights_time_ms": 20.821}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 168, "training_iteration": 41, "trial_id": "74231_00000", "date": "2025-04-22_14-04-49", "timestamp": 1745345089, "time_this_iter_s": 19.01276445388794, "time_total_s": 776.0705778598785, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0086, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 776.0705778598785, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.944444444444443, "ram_util_percent": 7.911111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49720546218656725, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3422377381710835, "policy_loss": -0.07187268027525034, "vf_loss": 0.0017648329421805805, "vf_explained_var": 0.6892526551600425, "kl": 0.006832396388538274, "entropy": 27.349637757578204, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25730.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.112594999999864, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.372396544651683, "mean_inference_ms": 1.7133917084475372, "mean_action_processing_ms": 0.18246388733439023, "mean_env_wait_ms": 45.425189302264286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05265045166015625, "StateBufferConnector_ms": 0.0046710968017578125, "ViewRequirementAgentConnector_ms": 0.12358832359313965}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.112594999999864, "episode_len_mean": 898.79, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.92999999999989, 18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.372396544651683, "mean_inference_ms": 1.7133917084475372, "mean_action_processing_ms": 0.18246388733439023, "mean_env_wait_ms": 45.425189302264286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05265045166015625, "StateBufferConnector_ms": 0.0046710968017578125, "ViewRequirementAgentConnector_ms": 0.12358832359313965}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.66241806076593, "num_env_steps_trained_throughput_per_sec": 207.66241806076593, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 18944.57, "sample_time_ms": 10656.482, "load_time_ms": 328.99, "load_throughput": 12158.432, "learn_time_ms": 7937.771, "learn_throughput": 503.92, "synch_weights_time_ms": 20.754}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 169, "training_iteration": 42, "trial_id": "74231_00000", "date": "2025-04-22_14-05-08", "timestamp": 1745345108, "time_this_iter_s": 19.267788648605347, "time_total_s": 795.3383665084839, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008565, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 795.3383665084839, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.64444444444445, "ram_util_percent": 7.885185185185185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49935201324762835, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.34218660220738517, "policy_loss": -0.07013672399484823, "vf_loss": 0.0010362237826301122, "vf_explained_var": 0.7572834548450286, "kl": 0.006642347069453519, "entropy": 27.441458179104714, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26350.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.095494999999865, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3724261337868329, "mean_inference_ms": 1.7137116667121746, "mean_action_processing_ms": 0.18248967611971978, "mean_env_wait_ms": 45.42499641420389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05247306823730469, "StateBufferConnector_ms": 0.004670858383178711, "ViewRequirementAgentConnector_ms": 0.12351489067077637}}, "episode_reward_max": 27.509999999999483, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 17.095494999999865, "episode_len_mean": 898.79, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.57499999999992, 25.27499999999952, 16.870000000000033, 27.509999999999483, 15.914999999999882, 16.399999999999995, 16.584999999999795, 16.57499999999988, 19.179999999999875, 20.864999999999803, 23.57999999999967, 16.975000000000005, 14.38999999999982, 15.539999999999777, 17.494999999999994, 17.659999999999986, 16.7149999999999, 18.534999999999926, 17.889999999999862, 16.86000000000001, 20.444999999999812, 14.649999999999807, 15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3724261337868329, "mean_inference_ms": 1.7137116667121746, "mean_action_processing_ms": 0.18248967611971978, "mean_env_wait_ms": 45.42499641420389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05247306823730469, "StateBufferConnector_ms": 0.004670858383178711, "ViewRequirementAgentConnector_ms": 0.12351489067077637}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.21482613071382, "num_env_steps_trained_throughput_per_sec": 209.21482613071382, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 19005.553, "sample_time_ms": 10726.196, "load_time_ms": 327.895, "load_throughput": 12199.025, "learn_time_ms": 7930.16, "learn_throughput": 504.403, "synch_weights_time_ms": 20.732}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 170, "training_iteration": 43, "trial_id": "74231_00000", "date": "2025-04-22_14-05-27", "timestamp": 1745345127, "time_this_iter_s": 19.125063180923462, "time_total_s": 814.4634296894073, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00853, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 814.4634296894073, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.5962962962963, "ram_util_percent": 7.862962962962964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49960407268616464, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3263937645333616, "policy_loss": -0.0603562532725083, "vf_loss": 0.0054650806741289755, "vf_explained_var": 0.7465726360197991, "kl": 0.013053226271720984, "entropy": 27.411324168789772, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26970.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.57429499999986, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719375985216839, "mean_inference_ms": 1.7146674767327343, "mean_action_processing_ms": 0.18237196051013213, "mean_env_wait_ms": 45.5070249414227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05279135704040527, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.12345123291015625}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.57429499999986, "episode_len_mean": 898.79, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719375985216839, "mean_inference_ms": 1.7146674767327343, "mean_action_processing_ms": 0.18237196051013213, "mean_env_wait_ms": 45.5070249414227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05279135704040527, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.12345123291015625}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.28052055848332, "num_env_steps_trained_throughput_per_sec": 219.28052055848332, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 18956.36, "sample_time_ms": 10687.93, "load_time_ms": 327.842, "load_throughput": 12201.005, "learn_time_ms": 7919.425, "learn_throughput": 505.087, "synch_weights_time_ms": 20.597}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 192, "training_iteration": 44, "trial_id": "74231_00000", "date": "2025-04-22_14-05-45", "timestamp": 1745345145, "time_this_iter_s": 18.24781608581543, "time_total_s": 832.7112457752228, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008495, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 832.7112457752228, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.634615384615383, "ram_util_percent": 7.8500000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4999326528080048, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3333196623785977, "policy_loss": -0.06513966420485127, "vf_loss": 0.00452847988604375, "vf_explained_var": 0.33743903877273684, "kl": 0.0091475207224991, "entropy": 27.45379881705007, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27590.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.57429499999986, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719375985216839, "mean_inference_ms": 1.7146674767327343, "mean_action_processing_ms": 0.18237196051013213, "mean_env_wait_ms": 45.5070249414227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05279135704040527, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.12345123291015625}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.57429499999986, "episode_len_mean": 898.79, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719375985216839, "mean_inference_ms": 1.7146674767327343, "mean_action_processing_ms": 0.18237196051013213, "mean_env_wait_ms": 45.5070249414227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05279135704040527, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.12345123291015625}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.13176672463777, "num_env_steps_trained_throughput_per_sec": 214.13176672463777, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 18904.763, "sample_time_ms": 10637.377, "load_time_ms": 326.198, "load_throughput": 12262.491, "learn_time_ms": 7919.952, "learn_throughput": 505.054, "synch_weights_time_ms": 20.673}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 192, "training_iteration": 45, "trial_id": "74231_00000", "date": "2025-04-22_14-06-04", "timestamp": 1745345164, "time_this_iter_s": 18.686359405517578, "time_total_s": 851.3976051807404, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00846, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 851.3976051807404, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.115384615384617, "ram_util_percent": 7.930769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49935053985926414, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.32746345198951704, "policy_loss": -0.056474137462622996, "vf_loss": 0.002999239218664321, "vf_explained_var": 0.6038852483034134, "kl": 0.007925483887383004, "entropy": 27.55736583894299, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28210.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.57429499999986, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719375985216839, "mean_inference_ms": 1.7146674767327343, "mean_action_processing_ms": 0.18237196051013213, "mean_env_wait_ms": 45.5070249414227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05279135704040527, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.12345123291015625}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.57429499999986, "episode_len_mean": 898.79, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719375985216839, "mean_inference_ms": 1.7146674767327343, "mean_action_processing_ms": 0.18237196051013213, "mean_env_wait_ms": 45.5070249414227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05279135704040527, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.12345123291015625}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.06799523234355, "num_env_steps_trained_throughput_per_sec": 205.06799523234355, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 18943.952, "sample_time_ms": 10688.034, "load_time_ms": 315.142, "load_throughput": 12692.671, "learn_time_ms": 7919.536, "learn_throughput": 505.08, "synch_weights_time_ms": 20.682}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 192, "training_iteration": 46, "trial_id": "74231_00000", "date": "2025-04-22_14-06-23", "timestamp": 1745345183, "time_this_iter_s": 19.511187076568604, "time_total_s": 870.908792257309, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008425, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 870.908792257309, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.67037037037037, "ram_util_percent": 7.962962962962963}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4922338837817792, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.34675193731372633, "policy_loss": -0.07319006106305508, "vf_loss": 0.002173585417340878, "vf_explained_var": 0.5337153328041877, "kl": 0.008317191565912518, "entropy": 27.739890750761955, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28830.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.57429499999986, "episode_len_mean": 898.79, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719375985216839, "mean_inference_ms": 1.7146674767327343, "mean_action_processing_ms": 0.18237196051013213, "mean_env_wait_ms": 45.5070249414227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05279135704040527, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.12345123291015625}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.57429499999986, "episode_len_mean": 898.79, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.244999999999973, 17.759999999999984, 14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3719375985216839, "mean_inference_ms": 1.7146674767327343, "mean_action_processing_ms": 0.18237196051013213, "mean_env_wait_ms": 45.5070249414227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05279135704040527, "StateBufferConnector_ms": 0.004681587219238281, "ViewRequirementAgentConnector_ms": 0.12345123291015625}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.1311434162685, "num_env_steps_trained_throughput_per_sec": 213.1311434162685, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 18913.146, "sample_time_ms": 10647.125, "load_time_ms": 314.856, "load_throughput": 12704.235, "learn_time_ms": 7929.923, "learn_throughput": 504.419, "synch_weights_time_ms": 20.686}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 192, "training_iteration": 47, "trial_id": "74231_00000", "date": "2025-04-22_14-06-42", "timestamp": 1745345202, "time_this_iter_s": 18.77397322654724, "time_total_s": 889.6827654838562, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00839, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 889.6827654838562, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.34814814814815, "ram_util_percent": 7.992592592592593}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4940131258339651, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.2791325531899929, "policy_loss": -0.014071711062663986, "vf_loss": 0.01320875815476205, "vf_explained_var": 0.49672687149816946, "kl": 0.010054646311560176, "entropy": 28.028053406746157, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29450.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.60066499999986, "episode_len_mean": 897.03, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3718290684757287, "mean_inference_ms": 1.714768588071668, "mean_action_processing_ms": 0.1823615117891557, "mean_env_wait_ms": 45.48930336257127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052590370178222656, "StateBufferConnector_ms": 0.0046808719635009766, "ViewRequirementAgentConnector_ms": 0.12322759628295898}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.60066499999986, "episode_len_mean": 897.03, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 15.544999999999861, 17.16999999999994, 17.215, 16.21999999999984, 19.039999999999893, 16.680000000000003, 14.289999999999818, 18.26499999999993, 14.269999999999825, 16.3100000000001, 14.719999999999786, 17.14499999999993, 22.954999999999686, 14.389999999999825, 15.750000000000078, 14.569999999999812, 14.784999999999789, 16.869500000000098, 14.674999999999892, 14.109999999999827, 15.869999999999811, 14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 779, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3718290684757287, "mean_inference_ms": 1.714768588071668, "mean_action_processing_ms": 0.1823615117891557, "mean_env_wait_ms": 45.48930336257127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052590370178222656, "StateBufferConnector_ms": 0.0046808719635009766, "ViewRequirementAgentConnector_ms": 0.12322759628295898}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.3499720943808, "num_env_steps_trained_throughput_per_sec": 212.3499720943808, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 18869.701, "sample_time_ms": 10631.781, "load_time_ms": 314.929, "load_throughput": 12701.286, "learn_time_ms": 7901.642, "learn_throughput": 506.224, "synch_weights_time_ms": 20.795}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 194, "training_iteration": 48, "trial_id": "74231_00000", "date": "2025-04-22_14-07-01", "timestamp": 1745345221, "time_this_iter_s": 18.842742681503296, "time_total_s": 908.5255081653595, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008355, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 908.5255081653595, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.566666666666666, "ram_util_percent": 8.025925925925925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3375198339405019, "policy_loss": -0.060963265949319445, "vf_loss": 0.0018038045639954244, "vf_explained_var": 0.8716106081201184, "kl": 0.007541977589144447, "entropy": 27.986877293740548, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30070.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.89381999999985, "episode_len_mean": 898.24, "episode_media": {}, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37152824566922327, "mean_inference_ms": 1.7159196821619491, "mean_action_processing_ms": 0.1823207445914102, "mean_env_wait_ms": 45.61590440307075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05299496650695801, "StateBufferConnector_ms": 0.00472569465637207, "ViewRequirementAgentConnector_ms": 0.123870849609375}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.89381999999985, "episode_len_mean": 898.24, "episodes_this_iter": 22, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37152824566922327, "mean_inference_ms": 1.7159196821619491, "mean_action_processing_ms": 0.1823207445914102, "mean_env_wait_ms": 45.61590440307075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05299496650695801, "StateBufferConnector_ms": 0.00472569465637207, "ViewRequirementAgentConnector_ms": 0.123870849609375}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.73998767044546, "num_env_steps_trained_throughput_per_sec": 212.73998767044546, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 18904.727, "sample_time_ms": 10636.264, "load_time_ms": 314.155, "load_throughput": 12732.557, "learn_time_ms": 7932.876, "learn_throughput": 504.231, "synch_weights_time_ms": 20.865}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 216, "training_iteration": 49, "trial_id": "74231_00000", "date": "2025-04-22_14-07-20", "timestamp": 1745345240, "time_this_iter_s": 18.80839705467224, "time_total_s": 927.3339052200317, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008320000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 927.3339052200317, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.81538461538462, "ram_util_percent": 8.007692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49873281765368677, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3377389459720542, "policy_loss": -0.06513282040644798, "vf_loss": 0.0029802754116916175, "vf_explained_var": 0.654066589282405, "kl": 0.009281033855493646, "entropy": 27.744261329404768, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30690.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.89381999999985, "episode_len_mean": 898.24, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37152824566922327, "mean_inference_ms": 1.7159196821619491, "mean_action_processing_ms": 0.1823207445914102, "mean_env_wait_ms": 45.61590440307075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05299496650695801, "StateBufferConnector_ms": 0.00472569465637207, "ViewRequirementAgentConnector_ms": 0.123870849609375}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.89381999999985, "episode_len_mean": 898.24, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37152824566922327, "mean_inference_ms": 1.7159196821619491, "mean_action_processing_ms": 0.1823207445914102, "mean_env_wait_ms": 45.61590440307075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05299496650695801, "StateBufferConnector_ms": 0.00472569465637207, "ViewRequirementAgentConnector_ms": 0.123870849609375}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.81708622108957, "num_env_steps_trained_throughput_per_sec": 217.81708622108957, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 18858.625, "sample_time_ms": 10585.358, "load_time_ms": 313.562, "load_throughput": 12756.668, "learn_time_ms": 7938.197, "learn_throughput": 503.893, "synch_weights_time_ms": 20.941}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 216, "training_iteration": 50, "trial_id": "74231_00000", "date": "2025-04-22_14-07-38", "timestamp": 1745345258, "time_this_iter_s": 18.369762420654297, "time_total_s": 945.703667640686, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008285, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 945.703667640686, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.734615384615385, "ram_util_percent": 8.03076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4945637265040028, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3434647854205386, "policy_loss": -0.06803252314698072, "vf_loss": 0.003065426581979996, "vf_explained_var": 0.6631007978031712, "kl": 0.009472253127859726, "entropy": 28.03921433725665, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31310.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.89381999999985, "episode_len_mean": 898.24, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37152824566922327, "mean_inference_ms": 1.7159196821619491, "mean_action_processing_ms": 0.1823207445914102, "mean_env_wait_ms": 45.61590440307075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05299496650695801, "StateBufferConnector_ms": 0.00472569465637207, "ViewRequirementAgentConnector_ms": 0.123870849609375}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.89381999999985, "episode_len_mean": 898.24, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999826, 14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37152824566922327, "mean_inference_ms": 1.7159196821619491, "mean_action_processing_ms": 0.1823207445914102, "mean_env_wait_ms": 45.61590440307075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05299496650695801, "StateBufferConnector_ms": 0.00472569465637207, "ViewRequirementAgentConnector_ms": 0.123870849609375}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.22269999740158, "num_env_steps_trained_throughput_per_sec": 214.22269999740158, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 18825.123, "sample_time_ms": 10570.888, "load_time_ms": 303.108, "load_throughput": 13196.636, "learn_time_ms": 7929.6, "learn_throughput": 504.439, "synch_weights_time_ms": 20.966}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 216, "training_iteration": 51, "trial_id": "74231_00000", "date": "2025-04-22_14-07-57", "timestamp": 1745345277, "time_this_iter_s": 18.677836656570435, "time_total_s": 964.3815042972565, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00825, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 964.3815042972565, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.86296296296296, "ram_util_percent": 8.077777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49691709741469353, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.2748649936710154, "policy_loss": -0.01288454567065562, "vf_loss": 0.01921835394321592, "vf_explained_var": 0.6981380504946555, "kl": 0.006955033611889268, "entropy": 28.258981532435264, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31930.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.891424999999852, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3714781518744388, "mean_inference_ms": 1.7151774505613435, "mean_action_processing_ms": 0.1822998467870259, "mean_env_wait_ms": 45.622297919083024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052886247634887695, "StateBufferConnector_ms": 0.004733562469482422, "ViewRequirementAgentConnector_ms": 0.12413692474365234}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.891424999999852, "episode_len_mean": 894.95, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.829999999999806, 16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3714781518744388, "mean_inference_ms": 1.7151774505613435, "mean_action_processing_ms": 0.1822998467870259, "mean_env_wait_ms": 45.622297919083024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.052886247634887695, "StateBufferConnector_ms": 0.004733562469482422, "ViewRequirementAgentConnector_ms": 0.12413692474365234}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.89702316217273, "num_env_steps_trained_throughput_per_sec": 213.89702316217273, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 18768.978, "sample_time_ms": 10524.596, "load_time_ms": 303.238, "load_throughput": 13190.976, "learn_time_ms": 7919.668, "learn_throughput": 505.072, "synch_weights_time_ms": 20.911}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 217, "training_iteration": 52, "trial_id": "74231_00000", "date": "2025-04-22_14-08-16", "timestamp": 1745345296, "time_this_iter_s": 18.706267595291138, "time_total_s": 983.0877718925476, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008215, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 983.0877718925476, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.11923076923077, "ram_util_percent": 8.11153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4964896255923856, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.34718758709233016, "policy_loss": -0.06689343736582105, "vf_loss": 0.0014395673540504152, "vf_explained_var": 0.5362641564299984, "kl": 0.007807001588756271, "entropy": 28.329512842239872, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32550.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.890474999999853, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37139263891954427, "mean_inference_ms": 1.7154686341223138, "mean_action_processing_ms": 0.18230335561882857, "mean_env_wait_ms": 45.60310598762986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05281424522399902, "StateBufferConnector_ms": 0.004730939865112305, "ViewRequirementAgentConnector_ms": 0.12393498420715332}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.890474999999853, "episode_len_mean": 894.95, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.369999999999905, 16.50000000000007, 15.385000000000055, 16.61000000000006, 14.36999999999982, 18.299999999999944, 18.504999999999953, 14.389999999999805, 14.509999999999808, 15.0799999999998, 18.01999999999996, 15.600000000000046, 14.56999999999982, 21.3299999999998, 14.289999999999814, 16.37500000000008, 19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37139263891954427, "mean_inference_ms": 1.7154686341223138, "mean_action_processing_ms": 0.18230335561882857, "mean_env_wait_ms": 45.60310598762986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05281424522399902, "StateBufferConnector_ms": 0.004730939865112305, "ViewRequirementAgentConnector_ms": 0.12393498420715332}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.08494870206067, "num_env_steps_trained_throughput_per_sec": 211.08494870206067, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 18752.04, "sample_time_ms": 10508.823, "load_time_ms": 303.254, "load_throughput": 13190.261, "learn_time_ms": 7918.54, "learn_throughput": 505.144, "synch_weights_time_ms": 20.842}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 218, "training_iteration": 53, "trial_id": "74231_00000", "date": "2025-04-22_14-08-35", "timestamp": 1745345315, "time_this_iter_s": 18.955572605133057, "time_total_s": 1002.0433444976807, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00818, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1002.0433444976807, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.637037037037036, "ram_util_percent": 8.092592592592592}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49994053903125946, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.34891056432989576, "policy_loss": -0.06702102952817034, "vf_loss": 0.0011646008291218975, "vf_explained_var": 0.6647322446107864, "kl": 0.006503166551955209, "entropy": 28.435477515189877, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33170.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.89462499999984, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37146218569675343, "mean_inference_ms": 1.7164216608787703, "mean_action_processing_ms": 0.18225081524340905, "mean_env_wait_ms": 45.64174290903247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05244755744934082, "StateBufferConnector_ms": 0.004743099212646484, "ViewRequirementAgentConnector_ms": 0.12344503402709961}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.89462499999984, "episode_len_mean": 894.95, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.599999999999827, 18.7449999999996, 18.769999999999932, 15.39999999999995, 14.20999999999982, 18.869999999999894, 16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37146218569675343, "mean_inference_ms": 1.7164216608787703, "mean_action_processing_ms": 0.18225081524340905, "mean_env_wait_ms": 45.64174290903247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05244755744934082, "StateBufferConnector_ms": 0.004743099212646484, "ViewRequirementAgentConnector_ms": 0.12344503402709961}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.12010611104668, "num_env_steps_trained_throughput_per_sec": 215.12010611104668, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 18787.319, "sample_time_ms": 10541.31, "load_time_ms": 303.3, "load_throughput": 13188.28, "learn_time_ms": 7921.36, "learn_throughput": 504.964, "synch_weights_time_ms": 20.776}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 234, "training_iteration": 54, "trial_id": "74231_00000", "date": "2025-04-22_14-08-53", "timestamp": 1745345333, "time_this_iter_s": 18.60001802444458, "time_total_s": 1020.6433625221252, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008145, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1020.6433625221252, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 18.053846153846152, "ram_util_percent": 8.057692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49945501271755466, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3479787932521093, "policy_loss": -0.0725556746290456, "vf_loss": 0.0024693648268522897, "vf_explained_var": 0.5855462323273382, "kl": 0.007635200532463533, "entropy": 27.941953028402022, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33790.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.772524999999842, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3713596109027193, "mean_inference_ms": 1.7172469842840572, "mean_action_processing_ms": 0.18227692317378175, "mean_env_wait_ms": 45.66626937477165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05234026908874512, "StateBufferConnector_ms": 0.0047457218170166016, "ViewRequirementAgentConnector_ms": 0.12337613105773926}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.772524999999842, "episode_len_mean": 894.95, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3713596109027193, "mean_inference_ms": 1.7172469842840572, "mean_action_processing_ms": 0.18227692317378175, "mean_env_wait_ms": 45.66626937477165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05234026908874512, "StateBufferConnector_ms": 0.0047457218170166016, "ViewRequirementAgentConnector_ms": 0.12337613105773926}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.8053061978298, "num_env_steps_trained_throughput_per_sec": 213.8053061978298, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 18790.172, "sample_time_ms": 10545.76, "load_time_ms": 304.537, "load_throughput": 13134.701, "learn_time_ms": 7918.603, "learn_throughput": 505.14, "synch_weights_time_ms": 20.7}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 240, "training_iteration": 55, "trial_id": "74231_00000", "date": "2025-04-22_14-09-12", "timestamp": 1745345352, "time_this_iter_s": 18.714624404907227, "time_total_s": 1039.3579869270325, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00811, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1039.3579869270325, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.753846153846155, "ram_util_percent": 8.076923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4993091668332777, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.34124181548625443, "policy_loss": -0.06580593347128841, "vf_loss": 0.0031103342273332423, "vf_explained_var": 0.5854646221283943, "kl": 0.006363969216533493, "entropy": 27.981901467231012, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34410.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.772524999999842, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3713596109027193, "mean_inference_ms": 1.7172469842840572, "mean_action_processing_ms": 0.18227692317378175, "mean_env_wait_ms": 45.66626937477165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05234026908874512, "StateBufferConnector_ms": 0.0047457218170166016, "ViewRequirementAgentConnector_ms": 0.12337613105773926}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.772524999999842, "episode_len_mean": 894.95, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3713596109027193, "mean_inference_ms": 1.7172469842840572, "mean_action_processing_ms": 0.18227692317378175, "mean_env_wait_ms": 45.66626937477165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05234026908874512, "StateBufferConnector_ms": 0.0047457218170166016, "ViewRequirementAgentConnector_ms": 0.12337613105773926}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.37421838229804, "num_env_steps_trained_throughput_per_sec": 209.37421838229804, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 18750.054, "sample_time_ms": 10477.262, "load_time_ms": 304.693, "load_throughput": 13127.988, "learn_time_ms": 7946.925, "learn_throughput": 503.339, "synch_weights_time_ms": 20.595}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 240, "training_iteration": 56, "trial_id": "74231_00000", "date": "2025-04-22_14-09-31", "timestamp": 1745345371, "time_this_iter_s": 19.11001682281494, "time_total_s": 1058.4680037498474, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008075, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1058.4680037498474, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 18.52962962962963, "ram_util_percent": 8.125925925925925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4936333598148438, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3415187449260209, "policy_loss": -0.06122951893541481, "vf_loss": 0.0022813165978702948, "vf_explained_var": 0.6799300920578741, "kl": 0.006512873747496703, "entropy": 28.387312212297992, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35030.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.772524999999842, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3713596109027193, "mean_inference_ms": 1.7172469842840572, "mean_action_processing_ms": 0.18227692317378175, "mean_env_wait_ms": 45.66626937477165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05234026908874512, "StateBufferConnector_ms": 0.0047457218170166016, "ViewRequirementAgentConnector_ms": 0.12337613105773926}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.772524999999842, "episode_len_mean": 894.95, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.26999999999988, 15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3713596109027193, "mean_inference_ms": 1.7172469842840572, "mean_action_processing_ms": 0.18227692317378175, "mean_env_wait_ms": 45.66626937477165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05234026908874512, "StateBufferConnector_ms": 0.0047457218170166016, "ViewRequirementAgentConnector_ms": 0.12337613105773926}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.75604772062488, "num_env_steps_trained_throughput_per_sec": 210.75604772062488, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 18771.203, "sample_time_ms": 10501.679, "load_time_ms": 314.575, "load_throughput": 12715.549, "learn_time_ms": 7933.761, "learn_throughput": 504.174, "synch_weights_time_ms": 20.613}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 240, "training_iteration": 57, "trial_id": "74231_00000", "date": "2025-04-22_14-09-50", "timestamp": 1745345390, "time_this_iter_s": 18.985027551651, "time_total_s": 1077.4530313014984, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00804, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1077.4530313014984, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 18.24444444444444, "ram_util_percent": 8.114814814814814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4989629008116261, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3724297708388598, "policy_loss": -0.08842866614671244, "vf_loss": 0.0006088610105096802, "vf_explained_var": 0.6852459248035184, "kl": 0.0077168375205313704, "entropy": 28.615334329297465, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35650.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.76352499999984, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3713165754306758, "mean_inference_ms": 1.7165273852830654, "mean_action_processing_ms": 0.1822576912959337, "mean_env_wait_ms": 45.67681867894859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05217695236206055, "StateBufferConnector_ms": 0.004746675491333008, "ViewRequirementAgentConnector_ms": 0.12343502044677734}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.76352499999984, "episode_len_mean": 894.95, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.34999999999979, 18.979999999999993, 18.8949999999999, 14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3713165754306758, "mean_inference_ms": 1.7165273852830654, "mean_action_processing_ms": 0.1822576912959337, "mean_env_wait_ms": 45.67681867894859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05217695236206055, "StateBufferConnector_ms": 0.004746675491333008, "ViewRequirementAgentConnector_ms": 0.12343502044677734}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.20602146317523, "num_env_steps_trained_throughput_per_sec": 211.20602146317523, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 18781.406, "sample_time_ms": 10494.005, "load_time_ms": 320.583, "load_throughput": 12477.269, "learn_time_ms": 7945.579, "learn_throughput": 503.425, "synch_weights_time_ms": 20.671}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 241, "training_iteration": 58, "trial_id": "74231_00000", "date": "2025-04-22_14-10-09", "timestamp": 1745345409, "time_this_iter_s": 18.94437551498413, "time_total_s": 1096.3974068164825, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.008005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1096.3974068164825, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.803703703703704, "ram_util_percent": 8.08148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49170165653190306, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3582625550618808, "policy_loss": -0.07382832766480503, "vf_loss": 0.0020753417165656905, "vf_explained_var": 0.796909378036376, "kl": 0.007279471406148996, "entropy": 28.79654665300923, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36270.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.745324999999838, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37126833193163816, "mean_inference_ms": 1.716901746940145, "mean_action_processing_ms": 0.182272686211594, "mean_env_wait_ms": 45.659738509520295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05179619789123535, "StateBufferConnector_ms": 0.004736900329589844, "ViewRequirementAgentConnector_ms": 0.12326931953430176}}, "episode_reward_max": 25.424999999999326, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.745324999999838, "episode_len_mean": 894.95, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.369999999999827, 17.459999999999976, 18.924999999999915, 15.42499999999977, 18.299999999999947, 16.96499999999979, 16.684999999999736, 14.864999999999839, 16.569999999999848, 14.5499999999998, 14.309999999999823, 14.409999999999812, 13.94999999999983, 14.819999999999817, 25.424999999999326, 19.249999999999886, 19.89499999999984, 14.389999999999823, 24.449999999999687, 17.714999999999975, 15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37126833193163816, "mean_inference_ms": 1.716901746940145, "mean_action_processing_ms": 0.182272686211594, "mean_env_wait_ms": 45.659738509520295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05179619789123535, "StateBufferConnector_ms": 0.004736900329589844, "ViewRequirementAgentConnector_ms": 0.12326931953430176}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.7227544972753, "num_env_steps_trained_throughput_per_sec": 207.7227544972753, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 18826.821, "sample_time_ms": 10574.092, "load_time_ms": 321.028, "load_throughput": 12459.954, "learn_time_ms": 7910.623, "learn_throughput": 505.649, "synch_weights_time_ms": 20.513}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 244, "training_iteration": 59, "trial_id": "74231_00000", "date": "2025-04-22_14-10-28", "timestamp": 1745345428, "time_this_iter_s": 19.2619571685791, "time_total_s": 1115.6593639850616, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007970000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1115.6593639850616, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 18.114814814814817, "ram_util_percent": 8.014814814814814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.498015129998807, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3258297048182407, "policy_loss": -0.044530723116270474, "vf_loss": 0.0019957805050580648, "vf_explained_var": 0.8467279146755895, "kl": 0.0057721287445137055, "entropy": 28.444919078580796, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36890.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.48377499999984, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3710008345292659, "mean_inference_ms": 1.718720913741997, "mean_action_processing_ms": 0.18225143616751166, "mean_env_wait_ms": 45.72434698666026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048543453216552734, "StateBufferConnector_ms": 0.004732370376586914, "ViewRequirementAgentConnector_ms": 0.12333178520202637}}, "episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.48377499999984, "episode_len_mean": 894.95, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3710008345292659, "mean_inference_ms": 1.718720913741997, "mean_action_processing_ms": 0.18225143616751166, "mean_env_wait_ms": 45.72434698666026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048543453216552734, "StateBufferConnector_ms": 0.004732370376586914, "ViewRequirementAgentConnector_ms": 0.12333178520202637}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.3004501145644, "num_env_steps_trained_throughput_per_sec": 214.3004501145644, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 18856.956, "sample_time_ms": 10559.254, "load_time_ms": 325.303, "load_throughput": 12296.213, "learn_time_ms": 7951.205, "learn_throughput": 503.068, "synch_weights_time_ms": 20.633}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 264, "training_iteration": 60, "trial_id": "74231_00000", "date": "2025-04-22_14-10-47", "timestamp": 1745345447, "time_this_iter_s": 18.672433853149414, "time_total_s": 1134.331797838211, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007935000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1134.331797838211, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 18.49615384615384, "ram_util_percent": 7.880769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4977488007997313, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3633502285505059, "policy_loss": -0.08494795108356723, "vf_loss": 0.002816790998411072, "vf_explained_var": 0.609196015423344, "kl": 0.006964749933403284, "entropy": 28.261202575314428, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37510.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.48377499999984, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3710008345292659, "mean_inference_ms": 1.718720913741997, "mean_action_processing_ms": 0.18225143616751166, "mean_env_wait_ms": 45.72434698666026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048543453216552734, "StateBufferConnector_ms": 0.004732370376586914, "ViewRequirementAgentConnector_ms": 0.12333178520202637}}, "episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.48377499999984, "episode_len_mean": 894.95, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3710008345292659, "mean_inference_ms": 1.718720913741997, "mean_action_processing_ms": 0.18225143616751166, "mean_env_wait_ms": 45.72434698666026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048543453216552734, "StateBufferConnector_ms": 0.004732370376586914, "ViewRequirementAgentConnector_ms": 0.12333178520202637}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.0417114682071, "num_env_steps_trained_throughput_per_sec": 216.0417114682071, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 18841.234, "sample_time_ms": 10540.091, "load_time_ms": 325.156, "load_throughput": 12301.802, "learn_time_ms": 7954.829, "learn_throughput": 502.839, "synch_weights_time_ms": 20.597}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 264, "training_iteration": 61, "trial_id": "74231_00000", "date": "2025-04-22_14-11-06", "timestamp": 1745345466, "time_this_iter_s": 18.52037787437439, "time_total_s": 1152.8521757125854, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0079, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1152.8521757125854, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.780769230769234, "ram_util_percent": 7.842307692307694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49395470345212567, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.37729444662137185, "policy_loss": -0.09527840981928391, "vf_loss": 0.00277666850875727, "vf_explained_var": 0.6937531826957579, "kl": 0.00821331276412407, "entropy": 28.64353760134789, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38130.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.48377499999984, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3710008345292659, "mean_inference_ms": 1.718720913741997, "mean_action_processing_ms": 0.18225143616751166, "mean_env_wait_ms": 45.72434698666026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048543453216552734, "StateBufferConnector_ms": 0.004732370376586914, "ViewRequirementAgentConnector_ms": 0.12333178520202637}}, "episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.48377499999984, "episode_len_mean": 894.95, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.274999999999778, 21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3710008345292659, "mean_inference_ms": 1.718720913741997, "mean_action_processing_ms": 0.18225143616751166, "mean_env_wait_ms": 45.72434698666026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048543453216552734, "StateBufferConnector_ms": 0.004732370376586914, "ViewRequirementAgentConnector_ms": 0.12333178520202637}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.2576217938467, "num_env_steps_trained_throughput_per_sec": 212.2576217938467, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 18855.678, "sample_time_ms": 10549.923, "load_time_ms": 324.772, "load_throughput": 12316.327, "learn_time_ms": 7959.755, "learn_throughput": 502.528, "synch_weights_time_ms": 20.667}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 264, "training_iteration": 62, "trial_id": "74231_00000", "date": "2025-04-22_14-11-25", "timestamp": 1745345485, "time_this_iter_s": 18.850828170776367, "time_total_s": 1171.7030038833618, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007865, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1171.7030038833618, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.848148148148148, "ram_util_percent": 7.851851851851853}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48116182045590494, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.37614429217158635, "policy_loss": -0.09088974256789492, "vf_loss": 0.0027929122293882404, "vf_explained_var": 0.5724897958578602, "kl": 0.00878887983922581, "entropy": 28.9805249152645, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38750.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.52437499999984, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37096247323473797, "mean_inference_ms": 1.717974646487443, "mean_action_processing_ms": 0.18223379300558176, "mean_env_wait_ms": 45.731171596382666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04836869239807129, "StateBufferConnector_ms": 0.004729509353637695, "ViewRequirementAgentConnector_ms": 0.12335467338562012}}, "episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.52437499999984, "episode_len_mean": 894.95, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.339999999999744, 18.534999999999968, 16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37096247323473797, "mean_inference_ms": 1.717974646487443, "mean_action_processing_ms": 0.18223379300558176, "mean_env_wait_ms": 45.731171596382666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04836869239807129, "StateBufferConnector_ms": 0.004729509353637695, "ViewRequirementAgentConnector_ms": 0.12335467338562012}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.55005650391405, "num_env_steps_trained_throughput_per_sec": 215.55005650391405, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 18816.424, "sample_time_ms": 10498.55, "load_time_ms": 334.277, "load_throughput": 11966.125, "learn_time_ms": 7962.341, "learn_throughput": 502.365, "synch_weights_time_ms": 20.707}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 265, "training_iteration": 63, "trial_id": "74231_00000", "date": "2025-04-22_14-11-43", "timestamp": 1745345503, "time_this_iter_s": 18.562708616256714, "time_total_s": 1190.2657124996185, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00783, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1190.2657124996185, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.703846153846158, "ram_util_percent": 7.8500000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48907965001079345, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3427954022723791, "policy_loss": -0.054974170461777716, "vf_loss": 0.002807002566780812, "vf_explained_var": 0.6851914065499459, "kl": 0.005916526185935635, "entropy": 29.181154118814774, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39370.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.45282499999984, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37084814954847345, "mean_inference_ms": 1.7182547965586625, "mean_action_processing_ms": 0.182235443791395, "mean_env_wait_ms": 45.707442332165286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048102378845214844, "StateBufferConnector_ms": 0.00471186637878418, "ViewRequirementAgentConnector_ms": 0.12295126914978027}}, "episode_reward_max": 24.08999999999961, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.45282499999984, "episode_len_mean": 894.95, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.569999999999737, 21.0799999999997, 17.220000000000013, 18.279999999999955, 15.290000000000028, 23.084999999999557, 14.059999999999823, 14.30999999999981, 15.074999999999912, 15.294999999999758, 16.409999999999783, 14.12999999999982, 18.784999999999904, 14.494999999999797, 14.289999999999822, 14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37084814954847345, "mean_inference_ms": 1.7182547965586625, "mean_action_processing_ms": 0.182235443791395, "mean_env_wait_ms": 45.707442332165286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.048102378845214844, "StateBufferConnector_ms": 0.00471186637878418, "ViewRequirementAgentConnector_ms": 0.12295126914978027}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.94436490388122, "num_env_steps_trained_throughput_per_sec": 210.94436490388122, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 18853.233, "sample_time_ms": 10524.641, "load_time_ms": 343.393, "load_throughput": 11648.448, "learn_time_ms": 7963.663, "learn_throughput": 502.281, "synch_weights_time_ms": 20.985}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 267, "training_iteration": 64, "trial_id": "74231_00000", "date": "2025-04-22_14-12-02", "timestamp": 1745345522, "time_this_iter_s": 18.968414306640625, "time_total_s": 1209.2341268062592, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007795, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1209.2341268062592, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.177777777777777, "ram_util_percent": 7.881481481481483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4975080915516423, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3485756336624036, "policy_loss": -0.05898151263658468, "vf_loss": 0.0019496713443928574, "vf_explained_var": 0.8802908712817776, "kl": 0.0075286904445332065, "entropy": 29.304953578210647, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39990.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.417424999999838, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37065182459123625, "mean_inference_ms": 1.7192541875814913, "mean_action_processing_ms": 0.18220598107037897, "mean_env_wait_ms": 45.707911071934035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04540419578552246, "StateBufferConnector_ms": 0.00468754768371582, "ViewRequirementAgentConnector_ms": 0.12255692481994629}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.417424999999838, "episode_len_mean": 894.95, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.8749999999998, 14.589999999999822, 15.389999999999803, 14.629999999999809, 15.669999999999758, 16.084999999999848, 14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37065182459123625, "mean_inference_ms": 1.7192541875814913, "mean_action_processing_ms": 0.18220598107037897, "mean_env_wait_ms": 45.707911071934035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04540419578552246, "StateBufferConnector_ms": 0.00468754768371582, "ViewRequirementAgentConnector_ms": 0.12255692481994629}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.79128650453885, "num_env_steps_trained_throughput_per_sec": 215.79128650453885, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 18836.015, "sample_time_ms": 10501.247, "load_time_ms": 343.252, "load_throughput": 11653.262, "learn_time_ms": 7961.181, "learn_throughput": 502.438, "synch_weights_time_ms": 29.786}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 282, "training_iteration": 65, "trial_id": "74231_00000", "date": "2025-04-22_14-12-21", "timestamp": 1745345541, "time_this_iter_s": 18.542886972427368, "time_total_s": 1227.7770137786865, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0077599999999999995, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1227.7770137786865, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.534615384615382, "ram_util_percent": 7.938461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49771431540289235, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3538077518161792, "policy_loss": -0.06823890777905622, "vf_loss": 0.0023332880755656186, "vf_explained_var": 0.7192919772478842, "kl": 0.010791013300260801, "entropy": 29.006033838948895, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40610.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.520524999999836, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982], "episode_lengths": [900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3705592154146078, "mean_inference_ms": 1.7201467997627002, "mean_action_processing_ms": 0.18224599476469955, "mean_env_wait_ms": 45.73160047096755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045116424560546875, "StateBufferConnector_ms": 0.004790544509887695, "ViewRequirementAgentConnector_ms": 0.12510347366333008}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.520524999999836, "episode_len_mean": 894.95, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982], "episode_lengths": [900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3705592154146078, "mean_inference_ms": 1.7201467997627002, "mean_action_processing_ms": 0.18224599476469955, "mean_env_wait_ms": 45.73160047096755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045116424560546875, "StateBufferConnector_ms": 0.004790544509887695, "ViewRequirementAgentConnector_ms": 0.12510347366333008}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 219.01674535541852, "num_env_steps_trained_throughput_per_sec": 219.01674535541852, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 18751.905, "sample_time_ms": 10439.557, "load_time_ms": 343.397, "load_throughput": 11648.315, "learn_time_ms": 7938.59, "learn_throughput": 503.868, "synch_weights_time_ms": 29.818}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 288, "training_iteration": 66, "trial_id": "74231_00000", "date": "2025-04-22_14-12-39", "timestamp": 1745345559, "time_this_iter_s": 18.26924753189087, "time_total_s": 1246.0462613105774, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007725, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1246.0462613105774, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 18.43076923076923, "ram_util_percent": 7.961538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49892430146855693, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.35469531949136346, "policy_loss": -0.06889548081784479, "vf_loss": 0.003793984872515554, "vf_explained_var": 0.6622365716964967, "kl": 0.008578772759822233, "entropy": 29.130958689412765, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41230.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.520524999999836, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982], "episode_lengths": [900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3705592154146078, "mean_inference_ms": 1.7201467997627002, "mean_action_processing_ms": 0.18224599476469955, "mean_env_wait_ms": 45.73160047096755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045116424560546875, "StateBufferConnector_ms": 0.004790544509887695, "ViewRequirementAgentConnector_ms": 0.12510347366333008}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.520524999999836, "episode_len_mean": 894.95, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982], "episode_lengths": [900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3705592154146078, "mean_inference_ms": 1.7201467997627002, "mean_action_processing_ms": 0.18224599476469955, "mean_env_wait_ms": 45.73160047096755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045116424560546875, "StateBufferConnector_ms": 0.004790544509887695, "ViewRequirementAgentConnector_ms": 0.12510347366333008}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.67837937778233, "num_env_steps_trained_throughput_per_sec": 211.67837937778233, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 18743.636, "sample_time_ms": 10405.308, "load_time_ms": 333.21, "load_throughput": 12004.457, "learn_time_ms": 7974.873, "learn_throughput": 501.575, "synch_weights_time_ms": 29.7}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 288, "training_iteration": 67, "trial_id": "74231_00000", "date": "2025-04-22_14-12-58", "timestamp": 1745345578, "time_this_iter_s": 18.90223526954651, "time_total_s": 1264.948496580124, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007690000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1264.948496580124, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 18.51923076923077, "ram_util_percent": 8.01923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49290135598951773, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.37929856082548447, "policy_loss": -0.08579951710473266, "vf_loss": 0.001646683228384591, "vf_explained_var": 0.5691181491459569, "kl": 0.008087655105289275, "entropy": 29.676326508675853, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41850.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.520524999999836, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982], "episode_lengths": [900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3705592154146078, "mean_inference_ms": 1.7201467997627002, "mean_action_processing_ms": 0.18224599476469955, "mean_env_wait_ms": 45.73160047096755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045116424560546875, "StateBufferConnector_ms": 0.004790544509887695, "ViewRequirementAgentConnector_ms": 0.12510347366333008}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.520524999999836, "episode_len_mean": 894.95, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999825, 18.994999999999887, 18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982], "episode_lengths": [900, 900, 900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3705592154146078, "mean_inference_ms": 1.7201467997627002, "mean_action_processing_ms": 0.18224599476469955, "mean_env_wait_ms": 45.73160047096755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045116424560546875, "StateBufferConnector_ms": 0.004790544509887695, "ViewRequirementAgentConnector_ms": 0.12510347366333008}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.31517631733473, "num_env_steps_trained_throughput_per_sec": 215.31517631733473, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 18707.493, "sample_time_ms": 10381.66, "load_time_ms": 327.094, "load_throughput": 12228.901, "learn_time_ms": 7968.618, "learn_throughput": 501.969, "synch_weights_time_ms": 29.566}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 288, "training_iteration": 68, "trial_id": "74231_00000", "date": "2025-04-22_14-13-16", "timestamp": 1745345596, "time_this_iter_s": 18.582881450653076, "time_total_s": 1283.531378030777, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007655, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1283.531378030777, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.525925925925925, "ram_util_percent": 8.055555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49640170004098644, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3847633549430963, "policy_loss": -0.0871347737618752, "vf_loss": 0.0010443560803313659, "vf_explained_var": 0.6778088827286998, "kl": 0.00920364568954025, "entropy": 30.051367452067712, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42470.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.517974999999836, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816], "episode_lengths": [900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3704703199791217, "mean_inference_ms": 1.7198027906352056, "mean_action_processing_ms": 0.1822404419340469, "mean_env_wait_ms": 45.722741635305944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04489922523498535, "StateBufferConnector_ms": 0.0047795772552490234, "ViewRequirementAgentConnector_ms": 0.12494111061096191}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.517974999999836, "episode_len_mean": 894.95, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.279999999999944, 16.314999999999756, 20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816], "episode_lengths": [900, 900, 900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3704703199791217, "mean_inference_ms": 1.7198027906352056, "mean_action_processing_ms": 0.1822404419340469, "mean_env_wait_ms": 45.722741635305944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04489922523498535, "StateBufferConnector_ms": 0.0047795772552490234, "ViewRequirementAgentConnector_ms": 0.12494111061096191}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.78307504103455, "num_env_steps_trained_throughput_per_sec": 213.78307504103455, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 18652.904, "sample_time_ms": 10317.218, "load_time_ms": 326.253, "load_throughput": 12260.428, "learn_time_ms": 7979.304, "learn_throughput": 501.297, "synch_weights_time_ms": 29.581}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 290, "training_iteration": 69, "trial_id": "74231_00000", "date": "2025-04-22_14-13-35", "timestamp": 1745345615, "time_this_iter_s": 18.716076135635376, "time_total_s": 1302.2474541664124, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00762, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1302.2474541664124, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.865384615384617, "ram_util_percent": 8.015384615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4994595050331085, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.38067915194635954, "policy_loss": -0.08062080301930227, "vf_loss": 0.0002930798100644625, "vf_explained_var": 0.6582416676705883, "kl": 0.00934787010168469, "entropy": 30.22210144227551, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43090.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.497024999999834, "episode_len_mean": 894.95, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807], "episode_lengths": [900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3704274596137922, "mean_inference_ms": 1.71976299609591, "mean_action_processing_ms": 0.18224582009794132, "mean_env_wait_ms": 45.716387354418224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044573068618774414, "StateBufferConnector_ms": 0.004784107208251953, "ViewRequirementAgentConnector_ms": 0.12498927116394043}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.497024999999834, "episode_len_mean": 894.95, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [20.214999999999733, 15.42700000000009, 24.06999999999962, 19.274999999999878, 14.5499999999998, 18.93499999999989, 16.984999999999822, 14.489999999999837, 14.469999999999814, 18.32999999999995, 14.129999999999821, 17.080000000000016, 20.634999999999774, 18.264999999999947, 18.364999999999938, 18.304999999999822, 18.99499999999988, 23.009999999999632, 16.53000000000007, 16.73999999999982, 14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807], "episode_lengths": [900, 724, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3704274596137922, "mean_inference_ms": 1.71976299609591, "mean_action_processing_ms": 0.18224582009794132, "mean_env_wait_ms": 45.716387354418224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.044573068618774414, "StateBufferConnector_ms": 0.004784107208251953, "ViewRequirementAgentConnector_ms": 0.12498927116394043}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.5035386190475, "num_env_steps_trained_throughput_per_sec": 212.5035386190475, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 18668.687, "sample_time_ms": 10381.961, "load_time_ms": 321.313, "load_throughput": 12448.919, "learn_time_ms": 7935.218, "learn_throughput": 504.082, "synch_weights_time_ms": 29.641}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 292, "training_iteration": 70, "trial_id": "74231_00000", "date": "2025-04-22_14-13-54", "timestamp": 1745345634, "time_this_iter_s": 18.829702377319336, "time_total_s": 1321.0771565437317, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007585, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1321.0771565437317, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.57777777777778, "ram_util_percent": 7.992592592592593}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4977177899691366, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3094816156527809, "policy_loss": -0.050033546698227106, "vf_loss": 0.035842395023117264, "vf_explained_var": 0.7730913518897948, "kl": 0.009636512797254498, "entropy": 29.72177669771256, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43710.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.183004999999834, "episode_len_mean": 896.71, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983], "episode_lengths": [900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37026880550351515, "mean_inference_ms": 1.7220082705233641, "mean_action_processing_ms": 0.18227081800709544, "mean_env_wait_ms": 45.693986050687585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04253387451171875, "StateBufferConnector_ms": 0.0049076080322265625, "ViewRequirementAgentConnector_ms": 0.12961125373840332}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.183004999999834, "episode_len_mean": 896.71, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983], "episode_lengths": [900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37026880550351515, "mean_inference_ms": 1.7220082705233641, "mean_action_processing_ms": 0.18227081800709544, "mean_env_wait_ms": 45.693986050687585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04253387451171875, "StateBufferConnector_ms": 0.0049076080322265625, "ViewRequirementAgentConnector_ms": 0.12961125373840332}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.44777498295483, "num_env_steps_trained_throughput_per_sec": 212.44777498295483, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 18700.008, "sample_time_ms": 10409.17, "load_time_ms": 322.397, "load_throughput": 12407.063, "learn_time_ms": 7938.441, "learn_throughput": 503.877, "synch_weights_time_ms": 29.45}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 312, "training_iteration": 71, "trial_id": "74231_00000", "date": "2025-04-22_14-14-13", "timestamp": 1745345653, "time_this_iter_s": 18.83519983291626, "time_total_s": 1339.912356376648, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00755, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1339.912356376648, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 18.315384615384616, "ram_util_percent": 7.8500000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4935413767253199, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3135382235080244, "policy_loss": -0.05130324988220368, "vf_loss": 0.03388720647272426, "vf_explained_var": 0.6442378157569516, "kl": 0.0072984948717461405, "entropy": 29.75818872759419, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44330.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.183004999999834, "episode_len_mean": 896.71, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983], "episode_lengths": [900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37026880550351515, "mean_inference_ms": 1.7220082705233641, "mean_action_processing_ms": 0.18227081800709544, "mean_env_wait_ms": 45.693986050687585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04253387451171875, "StateBufferConnector_ms": 0.0049076080322265625, "ViewRequirementAgentConnector_ms": 0.12961125373840332}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.183004999999834, "episode_len_mean": 896.71, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983], "episode_lengths": [900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37026880550351515, "mean_inference_ms": 1.7220082705233641, "mean_action_processing_ms": 0.18227081800709544, "mean_env_wait_ms": 45.693986050687585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04253387451171875, "StateBufferConnector_ms": 0.0049076080322265625, "ViewRequirementAgentConnector_ms": 0.12961125373840332}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.34010709441395, "num_env_steps_trained_throughput_per_sec": 213.34010709441395, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 18690.442, "sample_time_ms": 10406.433, "load_time_ms": 323.514, "load_throughput": 12364.22, "learn_time_ms": 7930.466, "learn_throughput": 504.384, "synch_weights_time_ms": 29.478}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 312, "training_iteration": 72, "trial_id": "74231_00000", "date": "2025-04-22_14-14-32", "timestamp": 1745345672, "time_this_iter_s": 18.75480055809021, "time_total_s": 1358.6671569347382, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007515000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1358.6671569347382, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 18.788461538461537, "ram_util_percent": 7.803846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49234644150541673, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.2807543696768041, "policy_loss": -0.046586061354290935, "vf_loss": 0.06517616449310598, "vf_explained_var": 0.6398183587097352, "kl": 0.007944299692450928, "entropy": 30.09333409340151, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44950.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.183004999999834, "episode_len_mean": 896.71, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983], "episode_lengths": [900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37026880550351515, "mean_inference_ms": 1.7220082705233641, "mean_action_processing_ms": 0.18227081800709544, "mean_env_wait_ms": 45.693986050687585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04253387451171875, "StateBufferConnector_ms": 0.0049076080322265625, "ViewRequirementAgentConnector_ms": 0.12961125373840332}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.183004999999834, "episode_len_mean": 896.71, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.684999999999796, 14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983], "episode_lengths": [900, 900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37026880550351515, "mean_inference_ms": 1.7220082705233641, "mean_action_processing_ms": 0.18227081800709544, "mean_env_wait_ms": 45.693986050687585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04253387451171875, "StateBufferConnector_ms": 0.0049076080322265625, "ViewRequirementAgentConnector_ms": 0.12961125373840332}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.0807418752702, "num_env_steps_trained_throughput_per_sec": 209.0807418752702, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 18747.861, "sample_time_ms": 10465.795, "load_time_ms": 314.767, "load_throughput": 12707.827, "learn_time_ms": 7937.155, "learn_throughput": 503.959, "synch_weights_time_ms": 29.594}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 312, "training_iteration": 73, "trial_id": "74231_00000", "date": "2025-04-22_14-14-51", "timestamp": 1745345691, "time_this_iter_s": 19.136993169784546, "time_total_s": 1377.8041501045227, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0074800000000000005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1377.8041501045227, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 18.185185185185187, "ram_util_percent": 7.7296296296296285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.497732568267853, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.36393275761529953, "policy_loss": -0.06620657209517254, "vf_loss": 0.005744358456306673, "vf_explained_var": 0.6754127355352525, "kl": 0.006229071284483766, "entropy": 30.471636692170176, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45570.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.178254999999833, "episode_len_mean": 896.71, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827], "episode_lengths": [900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3700852015458188, "mean_inference_ms": 1.7209663002730016, "mean_action_processing_ms": 0.182219761106799, "mean_env_wait_ms": 45.69501480848082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042222023010253906, "StateBufferConnector_ms": 0.00488591194152832, "ViewRequirementAgentConnector_ms": 0.12940192222595215}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.178254999999833, "episode_len_mean": 896.71, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999821, 14.449999999999807, 17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827], "episode_lengths": [900, 900, 900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3700852015458188, "mean_inference_ms": 1.7209663002730016, "mean_action_processing_ms": 0.182219761106799, "mean_env_wait_ms": 45.69501480848082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042222023010253906, "StateBufferConnector_ms": 0.00488591194152832, "ViewRequirementAgentConnector_ms": 0.12940192222595215}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.9011216443669, "num_env_steps_trained_throughput_per_sec": 211.9011216443669, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 18739.298, "sample_time_ms": 10453.36, "load_time_ms": 305.065, "load_throughput": 13111.974, "learn_time_ms": 7950.909, "learn_throughput": 503.087, "synch_weights_time_ms": 29.413}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 313, "training_iteration": 74, "trial_id": "74231_00000", "date": "2025-04-22_14-15-10", "timestamp": 1745345710, "time_this_iter_s": 18.882641077041626, "time_total_s": 1396.6867911815643, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007445, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1396.6867911815643, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.748148148148147, "ram_util_percent": 7.751851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4994707673307388, "cur_kl_coeff": 0.2, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3674918894642859, "policy_loss": -0.06349996532906868, "vf_loss": 0.0017571726519228774, "vf_explained_var": 0.6269771249063554, "kl": 0.004543540341675849, "entropy": 30.66578113494381, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46190.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.230404999999834, "episode_len_mean": 896.71, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844], "episode_lengths": [900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37006330463253123, "mean_inference_ms": 1.721147283826937, "mean_action_processing_ms": 0.18222337798473473, "mean_env_wait_ms": 45.669098071106355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042081594467163086, "StateBufferConnector_ms": 0.004891872406005859, "ViewRequirementAgentConnector_ms": 0.12940478324890137}}, "episode_reward_max": 26.81499999999949, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.230404999999834, "episode_len_mean": 896.71, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.584999999999994, 14.070500000000088, 14.734999999999818, 14.34999999999982, 14.704999999999904, 18.024999999999967, 17.269999999999996, 18.49999999999993, 15.124999999999833, 13.94999999999983, 14.99499999999979, 24.08999999999961, 15.109999999999777, 15.404999999999758, 15.089999999999817, 14.389999999999805, 14.779999999999944, 15.86999999999994, 18.964999999999915, 14.309999999999828, 14.029999999999827, 15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844], "episode_lengths": [900, 571, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37006330463253123, "mean_inference_ms": 1.721147283826937, "mean_action_processing_ms": 0.18222337798473473, "mean_env_wait_ms": 45.669098071106355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.042081594467163086, "StateBufferConnector_ms": 0.004891872406005859, "ViewRequirementAgentConnector_ms": 0.12940478324890137}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.1131761053936, "num_env_steps_trained_throughput_per_sec": 204.1131761053936, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 18845.351, "sample_time_ms": 10555.946, "load_time_ms": 305.528, "load_throughput": 13092.071, "learn_time_ms": 7962.563, "learn_throughput": 502.351, "synch_weights_time_ms": 20.736}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 315, "training_iteration": 75, "trial_id": "74231_00000", "date": "2025-04-22_14-15-29", "timestamp": 1745345729, "time_this_iter_s": 19.60309934616089, "time_total_s": 1416.2898905277252, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00741, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1416.2898905277252, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.41785714285714, "ram_util_percent": 7.821428571428574}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3704949894187702, "policy_loss": -0.06706656750043734, "vf_loss": 0.0016236023012395654, "vf_explained_var": 0.9124138182209384, "kl": 0.007515587768085102, "entropy": 30.580358471408967, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46810.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.538649999999823, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36993299073945296, "mean_inference_ms": 1.7232779754394985, "mean_action_processing_ms": 0.18226061745342625, "mean_env_wait_ms": 45.64495107377252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03925895690917969, "StateBufferConnector_ms": 0.004891633987426758, "ViewRequirementAgentConnector_ms": 0.13004517555236816}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.538649999999823, "episode_len_mean": 900.0, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36993299073945296, "mean_inference_ms": 1.7232779754394985, "mean_action_processing_ms": 0.18226061745342625, "mean_env_wait_ms": 45.64495107377252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03925895690917969, "StateBufferConnector_ms": 0.004891633987426758, "ViewRequirementAgentConnector_ms": 0.13004517555236816}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.30557177094062, "num_env_steps_trained_throughput_per_sec": 214.30557177094062, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 18885.5, "sample_time_ms": 10603.394, "load_time_ms": 304.868, "load_throughput": 13120.449, "learn_time_ms": 7955.944, "learn_throughput": 502.769, "synch_weights_time_ms": 20.717}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 336, "training_iteration": 76, "trial_id": "74231_00000", "date": "2025-04-22_14-15-48", "timestamp": 1745345748, "time_this_iter_s": 18.67155408859253, "time_total_s": 1434.9614446163177, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007375, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1434.9614446163177, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.273076923076925, "ram_util_percent": 7.838461538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4982947873011712, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.33058802080148225, "policy_loss": -0.03560480768942544, "vf_loss": 0.0059419209097629185, "vf_explained_var": 0.7451019129445476, "kl": 0.011081677222609283, "entropy": 30.203330516815186, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47430.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.538649999999823, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36993299073945296, "mean_inference_ms": 1.7232779754394985, "mean_action_processing_ms": 0.18226061745342625, "mean_env_wait_ms": 45.64495107377252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03925895690917969, "StateBufferConnector_ms": 0.004891633987426758, "ViewRequirementAgentConnector_ms": 0.13004517555236816}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.538649999999823, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36993299073945296, "mean_inference_ms": 1.7232779754394985, "mean_action_processing_ms": 0.18226061745342625, "mean_env_wait_ms": 45.64495107377252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03925895690917969, "StateBufferConnector_ms": 0.004891633987426758, "ViewRequirementAgentConnector_ms": 0.13004517555236816}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.3903744055526, "num_env_steps_trained_throughput_per_sec": 213.3903744055526, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 18870.34, "sample_time_ms": 10624.054, "load_time_ms": 305.225, "load_throughput": 13105.098, "learn_time_ms": 7919.65, "learn_throughput": 505.073, "synch_weights_time_ms": 20.835}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 336, "training_iteration": 77, "trial_id": "74231_00000", "date": "2025-04-22_14-16-07", "timestamp": 1745345767, "time_this_iter_s": 18.750528812408447, "time_total_s": 1453.7119734287262, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00734, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1453.7119734287262, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 18.97307692307692, "ram_util_percent": 7.903846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4991699199282354, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.38077447615984467, "policy_loss": -0.07657824016040972, "vf_loss": 0.0030399891486805218, "vf_explained_var": 0.5854888873715555, "kl": 0.013786703557472661, "entropy": 30.861490108120826, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48050.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.538649999999823, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36993299073945296, "mean_inference_ms": 1.7232779754394985, "mean_action_processing_ms": 0.18226061745342625, "mean_env_wait_ms": 45.64495107377252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03925895690917969, "StateBufferConnector_ms": 0.004891633987426758, "ViewRequirementAgentConnector_ms": 0.13004517555236816}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.538649999999823, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.549999999999777, 14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36993299073945296, "mean_inference_ms": 1.7232779754394985, "mean_action_processing_ms": 0.18226061745342625, "mean_env_wait_ms": 45.64495107377252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03925895690917969, "StateBufferConnector_ms": 0.004891633987426758, "ViewRequirementAgentConnector_ms": 0.13004517555236816}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.02227848710734, "num_env_steps_trained_throughput_per_sec": 205.02227848710734, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 18963.605, "sample_time_ms": 10678.521, "load_time_ms": 305.202, "load_throughput": 13106.089, "learn_time_ms": 7958.442, "learn_throughput": 502.611, "synch_weights_time_ms": 20.873}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 336, "training_iteration": 78, "trial_id": "74231_00000", "date": "2025-04-22_14-16-26", "timestamp": 1745345786, "time_this_iter_s": 19.51602053642273, "time_total_s": 1473.227993965149, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007305000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1473.227993965149, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.47142857142857, "ram_util_percent": 7.935714285714288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4998760451232233, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3829887734215346, "policy_loss": -0.06845975453634896, "vf_loss": 0.0015989770394196146, "vf_explained_var": 0.5792952870168994, "kl": 0.00862768280564905, "entropy": 31.699077252418764, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48670.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.591749999999827, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697552894016481, "mean_inference_ms": 1.7222860389978876, "mean_action_processing_ms": 0.18221315912283523, "mean_env_wait_ms": 45.64914019053969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03905081748962402, "StateBufferConnector_ms": 0.00487518310546875, "ViewRequirementAgentConnector_ms": 0.13000893592834473}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.591749999999827, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.389999999999828, 17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697552894016481, "mean_inference_ms": 1.7222860389978876, "mean_action_processing_ms": 0.18221315912283523, "mean_env_wait_ms": 45.64914019053969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03905081748962402, "StateBufferConnector_ms": 0.00487518310546875, "ViewRequirementAgentConnector_ms": 0.13000893592834473}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.55608999052023, "num_env_steps_trained_throughput_per_sec": 207.55608999052023, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 19019.74, "sample_time_ms": 10731.408, "load_time_ms": 306.295, "load_throughput": 13059.292, "learn_time_ms": 7960.495, "learn_throughput": 502.481, "synch_weights_time_ms": 20.975}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 337, "training_iteration": 79, "trial_id": "74231_00000", "date": "2025-04-22_14-16-46", "timestamp": 1745345806, "time_this_iter_s": 19.2780339717865, "time_total_s": 1492.5060279369354, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00727, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1492.5060279369354, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 17.21111111111111, "ram_util_percent": 7.840740740740743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49935548512205, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3890262078140832, "policy_loss": -0.07229359574961446, "vf_loss": 0.0010046659825144572, "vf_explained_var": 0.7148734847384114, "kl": 0.011147418372732523, "entropy": 31.885202958506923, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49290.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.606749999999828, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697635686559488, "mean_inference_ms": 1.7223215088330028, "mean_action_processing_ms": 0.18221766235531348, "mean_env_wait_ms": 45.645113311038294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03891324996948242, "StateBufferConnector_ms": 0.004878520965576172, "ViewRequirementAgentConnector_ms": 0.13005948066711426}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.606749999999828, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.469999999999782, 17.63499999999992, 15.369999999999795, 14.364999999999826, 15.429999999999998, 21.60999999999962, 14.629999999999807, 14.20999999999982, 18.299999999999766, 16.194999999999972, 14.389999999999805, 14.394999999999843, 14.129999999999821, 14.109999999999825, 19.15999999999987, 15.11999999999976, 14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697635686559488, "mean_inference_ms": 1.7223215088330028, "mean_action_processing_ms": 0.18221766235531348, "mean_env_wait_ms": 45.645113311038294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03891324996948242, "StateBufferConnector_ms": 0.004878520965576172, "ViewRequirementAgentConnector_ms": 0.13005948066711426}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.01608560955424, "num_env_steps_trained_throughput_per_sec": 209.01608560955424, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 19051.146, "sample_time_ms": 10750.057, "load_time_ms": 307.497, "load_throughput": 13008.272, "learn_time_ms": 7971.929, "learn_throughput": 501.761, "synch_weights_time_ms": 21.099}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 338, "training_iteration": 80, "trial_id": "74231_00000", "date": "2025-04-22_14-17-05", "timestamp": 1745345825, "time_this_iter_s": 19.143429279327393, "time_total_s": 1511.6494572162628, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007235, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1511.6494572162628, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 16.937037037037037, "ram_util_percent": 7.755555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3733574791439629, "policy_loss": -0.05425564400934344, "vf_loss": 0.0007953839790146841, "vf_explained_var": 0.8047726110104592, "kl": 0.008125069442828516, "entropy": 32.070972882547686, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49910.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.491799999999827, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697684114369504, "mean_inference_ms": 1.7243011463738125, "mean_action_processing_ms": 0.18222626090388838, "mean_env_wait_ms": 45.59296051260582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038236141204833984, "StateBufferConnector_ms": 0.004868984222412109, "ViewRequirementAgentConnector_ms": 0.12914609909057617}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.491799999999827, "episode_len_mean": 900.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.12999999999982, 14.44999999999981, 17.364999999999984, 17.51999999999999, 15.749999999999762, 18.169999999999956, 18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697684114369504, "mean_inference_ms": 1.7243011463738125, "mean_action_processing_ms": 0.18222626090388838, "mean_env_wait_ms": 45.59296051260582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038236141204833984, "StateBufferConnector_ms": 0.004868984222412109, "ViewRequirementAgentConnector_ms": 0.12914609909057617}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.5629456382682, "num_env_steps_trained_throughput_per_sec": 212.5629456382682, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 19050.126, "sample_time_ms": 10743.905, "load_time_ms": 306.304, "load_throughput": 13058.931, "learn_time_ms": 7977.974, "learn_throughput": 501.38, "synch_weights_time_ms": 21.371}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 354, "training_iteration": 81, "trial_id": "74231_00000", "date": "2025-04-22_14-17-24", "timestamp": 1745345844, "time_this_iter_s": 18.8238582611084, "time_total_s": 1530.4733154773712, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0072, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1530.4733154773712, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.99615384615385, "ram_util_percent": 7.7576923076923086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4974916552824359, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3617517315752564, "policy_loss": -0.04953604779889687, "vf_loss": 0.0017902634054456528, "vf_explained_var": 0.6494808247012477, "kl": 0.012835213229708086, "entropy": 31.528947430272257, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50530.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.402799999999818, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36966588648381477, "mean_inference_ms": 1.7253540610756184, "mean_action_processing_ms": 0.18226545447989945, "mean_env_wait_ms": 45.590793654309145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0381922721862793, "StateBufferConnector_ms": 0.004876613616943359, "ViewRequirementAgentConnector_ms": 0.12906408309936523}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.402799999999818, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36966588648381477, "mean_inference_ms": 1.7253540610756184, "mean_action_processing_ms": 0.18226545447989945, "mean_env_wait_ms": 45.590793654309145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0381922721862793, "StateBufferConnector_ms": 0.004876613616943359, "ViewRequirementAgentConnector_ms": 0.12906408309936523}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.22582904220687, "num_env_steps_trained_throughput_per_sec": 211.22582904220687, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 19068.897, "sample_time_ms": 10763.771, "load_time_ms": 310.521, "load_throughput": 12881.597, "learn_time_ms": 7972.638, "learn_throughput": 501.716, "synch_weights_time_ms": 21.392}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 360, "training_iteration": 82, "trial_id": "74231_00000", "date": "2025-04-22_14-17-43", "timestamp": 1745345863, "time_this_iter_s": 18.9432110786438, "time_total_s": 1549.416526556015, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0071649999999999995, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1549.416526556015, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.466666666666665, "ram_util_percent": 7.7703703703703715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49842073210785465, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3728224615093261, "policy_loss": -0.05900578152748846, "vf_loss": 0.001458294289779822, "vf_explained_var": 0.5395169748413947, "kl": 0.00716408734372107, "entropy": 31.599139133576426, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51150.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.402799999999818, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36966588648381477, "mean_inference_ms": 1.7253540610756184, "mean_action_processing_ms": 0.18226545447989945, "mean_env_wait_ms": 45.590793654309145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0381922721862793, "StateBufferConnector_ms": 0.004876613616943359, "ViewRequirementAgentConnector_ms": 0.12906408309936523}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.402799999999818, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36966588648381477, "mean_inference_ms": 1.7253540610756184, "mean_action_processing_ms": 0.18226545447989945, "mean_env_wait_ms": 45.590793654309145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0381922721862793, "StateBufferConnector_ms": 0.004876613616943359, "ViewRequirementAgentConnector_ms": 0.12906408309936523}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.16177533655983, "num_env_steps_trained_throughput_per_sec": 212.16177533655983, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 19041.113, "sample_time_ms": 10739.647, "load_time_ms": 309.26, "load_throughput": 12934.107, "learn_time_ms": 7970.074, "learn_throughput": 501.877, "synch_weights_time_ms": 21.528}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 360, "training_iteration": 83, "trial_id": "74231_00000", "date": "2025-04-22_14-18-02", "timestamp": 1745345882, "time_this_iter_s": 18.85931086540222, "time_total_s": 1568.2758374214172, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007130000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1568.2758374214172, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.653846153846153, "ram_util_percent": 7.857692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.36809404283281294, "policy_loss": -0.04692490555312214, "vf_loss": 0.0011194538715728647, "vf_explained_var": 0.728729199594067, "kl": 0.005318080610032343, "entropy": 32.28204057139735, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51770.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.402799999999818, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36966588648381477, "mean_inference_ms": 1.7253540610756184, "mean_action_processing_ms": 0.18226545447989945, "mean_env_wait_ms": 45.590793654309145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0381922721862793, "StateBufferConnector_ms": 0.004876613616943359, "ViewRequirementAgentConnector_ms": 0.12906408309936523}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.402799999999818, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.699999999999886, 15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36966588648381477, "mean_inference_ms": 1.7253540610756184, "mean_action_processing_ms": 0.18226545447989945, "mean_env_wait_ms": 45.590793654309145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0381922721862793, "StateBufferConnector_ms": 0.004876613616943359, "ViewRequirementAgentConnector_ms": 0.12906408309936523}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.9875374851413, "num_env_steps_trained_throughput_per_sec": 215.9875374851413, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 19005.401, "sample_time_ms": 10712.382, "load_time_ms": 309.507, "load_throughput": 12923.793, "learn_time_ms": 7961.311, "learn_throughput": 502.43, "synch_weights_time_ms": 21.598}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 360, "training_iteration": 84, "trial_id": "74231_00000", "date": "2025-04-22_14-18-20", "timestamp": 1745345900, "time_this_iter_s": 18.525127410888672, "time_total_s": 1586.800964832306, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007095000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1586.800964832306, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.266666666666666, "ram_util_percent": 7.951851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.39743167595382056, "policy_loss": -0.07330363016648804, "vf_loss": 0.0005085023996292464, "vf_explained_var": 0.6143942474357543, "kl": 0.006515641642363334, "entropy": 32.528812008519324, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52390.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.400299999999817, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36949423431542433, "mean_inference_ms": 1.724483387008998, "mean_action_processing_ms": 0.18222264642875924, "mean_env_wait_ms": 45.594465721026815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038164615631103516, "StateBufferConnector_ms": 0.004866838455200195, "ViewRequirementAgentConnector_ms": 0.12907695770263672}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.400299999999817, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.209999999999795, 14.549999999999814, 16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36949423431542433, "mean_inference_ms": 1.724483387008998, "mean_action_processing_ms": 0.18222264642875924, "mean_env_wait_ms": 45.594465721026815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038164615631103516, "StateBufferConnector_ms": 0.004866838455200195, "ViewRequirementAgentConnector_ms": 0.12907695770263672}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.8496693410498, "num_env_steps_trained_throughput_per_sec": 214.8496693410498, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 18907.471, "sample_time_ms": 10585.15, "load_time_ms": 310.327, "load_throughput": 12889.622, "learn_time_ms": 7989.983, "learn_throughput": 500.627, "synch_weights_time_ms": 21.43}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 361, "training_iteration": 85, "trial_id": "74231_00000", "date": "2025-04-22_14-18-39", "timestamp": 1745345919, "time_this_iter_s": 18.623491764068604, "time_total_s": 1605.4244565963745, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00706, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1605.4244565963745, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.29230769230769, "ram_util_percent": 7.903846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4992912726536874, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3751833943210283, "policy_loss": -0.049816764965503205, "vf_loss": 0.0016522665770759388, "vf_explained_var": 0.6318546722973547, "kl": 0.008492687012509312, "entropy": 32.7868175291246, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53010.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.430599999999817, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694287516970974, "mean_inference_ms": 1.724890061338579, "mean_action_processing_ms": 0.18223423257725035, "mean_env_wait_ms": 45.576420363218034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03821539878845215, "StateBufferConnector_ms": 0.004877328872680664, "ViewRequirementAgentConnector_ms": 0.1291332244873047}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.430599999999817, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.089999999999794, 19.33499999999987, 14.029999999999827, 18.689999999999912, 14.649999999999816, 22.139999999999514, 14.309999999999823, 14.449999999999807, 15.554999999999913, 14.02999999999983, 14.029999999999827, 14.369999999999818, 18.529999999999948, 26.81499999999949, 14.30999999999981, 14.979999999999793, 15.549999999999756, 16.104999999999823, 15.009999999999776, 16.244999999999802, 16.19999999999976, 16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694287516970974, "mean_inference_ms": 1.724890061338579, "mean_action_processing_ms": 0.18223423257725035, "mean_env_wait_ms": 45.576420363218034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03821539878845215, "StateBufferConnector_ms": 0.004877328872680664, "ViewRequirementAgentConnector_ms": 0.1291332244873047}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.90670159264502, "num_env_steps_trained_throughput_per_sec": 210.90670159264502, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 18937.551, "sample_time_ms": 10615.817, "load_time_ms": 310.636, "load_throughput": 12876.797, "learn_time_ms": 7989.273, "learn_throughput": 500.671, "synch_weights_time_ms": 21.237}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 363, "training_iteration": 86, "trial_id": "74231_00000", "date": "2025-04-22_14-18-58", "timestamp": 1745345938, "time_this_iter_s": 18.97150206565857, "time_total_s": 1624.395958662033, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.007025, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1624.395958662033, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.21153846153846, "ram_util_percent": 7.8500000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49008360572399634, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4066663952379097, "policy_loss": -0.09355832645669579, "vf_loss": 0.007173417670900005, "vf_explained_var": 0.858339223650194, "kl": 0.016139036648852315, "entropy": 32.189539712475195, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53630.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.06649999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369457690788984, "mean_inference_ms": 1.7284999321372942, "mean_action_processing_ms": 0.1822793813000241, "mean_env_wait_ms": 45.52917955502188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038014888763427734, "StateBufferConnector_ms": 0.004877328872680664, "ViewRequirementAgentConnector_ms": 0.12912368774414062}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.06649999999982, "episode_len_mean": 900.0, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369457690788984, "mean_inference_ms": 1.7284999321372942, "mean_action_processing_ms": 0.1822793813000241, "mean_env_wait_ms": 45.52917955502188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038014888763427734, "StateBufferConnector_ms": 0.004877328872680664, "ViewRequirementAgentConnector_ms": 0.12912368774414062}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.92135269369314, "num_env_steps_trained_throughput_per_sec": 217.92135269369314, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 18898.576, "sample_time_ms": 10568.049, "load_time_ms": 309.996, "load_throughput": 12903.379, "learn_time_ms": 7998.824, "learn_throughput": 500.074, "synch_weights_time_ms": 21.121}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 384, "training_iteration": 87, "trial_id": "74231_00000", "date": "2025-04-22_14-19-16", "timestamp": 1745345956, "time_this_iter_s": 18.361616849899292, "time_total_s": 1642.7575755119324, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00699, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1642.7575755119324, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.865384615384617, "ram_util_percent": 7.811538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49357137588724015, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.40328859069681305, "policy_loss": -0.09592469684298961, "vf_loss": 0.009390120179637786, "vf_explained_var": 0.5609517530087502, "kl": 0.014734238487313457, "entropy": 31.822744477179743, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54250.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.06649999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369457690788984, "mean_inference_ms": 1.7284999321372942, "mean_action_processing_ms": 0.1822793813000241, "mean_env_wait_ms": 45.52917955502188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038014888763427734, "StateBufferConnector_ms": 0.004877328872680664, "ViewRequirementAgentConnector_ms": 0.12912368774414062}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.06649999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369457690788984, "mean_inference_ms": 1.7284999321372942, "mean_action_processing_ms": 0.1822793813000241, "mean_env_wait_ms": 45.52917955502188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038014888763427734, "StateBufferConnector_ms": 0.004877328872680664, "ViewRequirementAgentConnector_ms": 0.12912368774414062}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.96319815526374, "num_env_steps_trained_throughput_per_sec": 203.96319815526374, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 18908.707, "sample_time_ms": 10619.267, "load_time_ms": 309.438, "load_throughput": 12926.678, "learn_time_ms": 7958.23, "learn_throughput": 502.624, "synch_weights_time_ms": 21.175}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 384, "training_iteration": 88, "trial_id": "74231_00000", "date": "2025-04-22_14-19-36", "timestamp": 1745345976, "time_this_iter_s": 19.61721706390381, "time_total_s": 1662.3747925758362, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006955, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1662.3747925758362, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 18.107142857142858, "ram_util_percent": 7.8500000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4989702195890488, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.37453495249482655, "policy_loss": -0.0530632899845049, "vf_loss": 0.0049748528622726995, "vf_explained_var": 0.6699309648044648, "kl": 0.008848486959017934, "entropy": 32.733137204570156, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54870.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.06649999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369457690788984, "mean_inference_ms": 1.7284999321372942, "mean_action_processing_ms": 0.1822793813000241, "mean_env_wait_ms": 45.52917955502188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038014888763427734, "StateBufferConnector_ms": 0.004877328872680664, "ViewRequirementAgentConnector_ms": 0.12912368774414062}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.06649999999982, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.999999999999734, 23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369457690788984, "mean_inference_ms": 1.7284999321372942, "mean_action_processing_ms": 0.1822793813000241, "mean_env_wait_ms": 45.52917955502188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038014888763427734, "StateBufferConnector_ms": 0.004877328872680664, "ViewRequirementAgentConnector_ms": 0.12912368774414062}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.80980083044773, "num_env_steps_trained_throughput_per_sec": 203.80980083044773, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 18944.131, "sample_time_ms": 10624.852, "load_time_ms": 308.623, "load_throughput": 12960.784, "learn_time_ms": 7989.114, "learn_throughput": 500.681, "synch_weights_time_ms": 20.948}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 384, "training_iteration": 89, "trial_id": "74231_00000", "date": "2025-04-22_14-19-55", "timestamp": 1745345995, "time_this_iter_s": 19.631560564041138, "time_total_s": 1682.0063531398773, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00692, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1682.0063531398773, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.70357142857143, "ram_util_percent": 7.90357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4983162739584523, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3859867325232875, "policy_loss": -0.053417924607281515, "vf_loss": 0.00197642900338539, "vf_explained_var": 0.7242223979965333, "kl": 0.011410692854403146, "entropy": 33.5686313567623, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55490.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.06064999999982, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3692851946439616, "mean_inference_ms": 1.7276697005922914, "mean_action_processing_ms": 0.1822390120054855, "mean_env_wait_ms": 45.53439627885084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03786134719848633, "StateBufferConnector_ms": 0.004845619201660156, "ViewRequirementAgentConnector_ms": 0.12859249114990234}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.06064999999982, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.084999999999596, 14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3692851946439616, "mean_inference_ms": 1.7276697005922914, "mean_action_processing_ms": 0.1822390120054855, "mean_env_wait_ms": 45.53439627885084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03786134719848633, "StateBufferConnector_ms": 0.004845619201660156, "ViewRequirementAgentConnector_ms": 0.12859249114990234}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.5926868801824, "num_env_steps_trained_throughput_per_sec": 213.5926868801824, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 18903.126, "sample_time_ms": 10580.363, "load_time_ms": 307.297, "load_throughput": 13016.722, "learn_time_ms": 7994.219, "learn_throughput": 500.362, "synch_weights_time_ms": 20.657}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 385, "training_iteration": 90, "trial_id": "74231_00000", "date": "2025-04-22_14-20-14", "timestamp": 1745346014, "time_this_iter_s": 18.73302125930786, "time_total_s": 1700.7393743991852, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0068850000000000005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1700.7393743991852, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.74074074074074, "ram_util_percent": 7.877777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4998457371227203, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.41878115188240284, "policy_loss": -0.08284030513717763, "vf_loss": 0.0006462901741623418, "vf_explained_var": 0.6722866586139126, "kl": 0.008736029853913576, "entropy": 33.74607471650646, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56110.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.007949999999823, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369263666030653, "mean_inference_ms": 1.7277932010901775, "mean_action_processing_ms": 0.18224544736744966, "mean_env_wait_ms": 45.52774690203566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03779244422912598, "StateBufferConnector_ms": 0.004835844039916992, "ViewRequirementAgentConnector_ms": 0.12832164764404297}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.007949999999823, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.389999999999807, 14.62999999999982, 18.199999999999953, 14.569999999999816, 18.10999999999996, 14.389999999999807, 21.444999999999645, 14.469999999999802, 19.604999999999812, 14.69499999999981, 16.2400000000001, 15.229999999999892, 18.21999999999995, 18.434999999999935, 18.47999999999993, 18.419999999999934, 14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369263666030653, "mean_inference_ms": 1.7277932010901775, "mean_action_processing_ms": 0.18224544736744966, "mean_env_wait_ms": 45.52774690203566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03779244422912598, "StateBufferConnector_ms": 0.004835844039916992, "ViewRequirementAgentConnector_ms": 0.12832164764404297}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.018400583435, "num_env_steps_trained_throughput_per_sec": 209.018400583435, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 18935.037, "sample_time_ms": 10604.267, "load_time_ms": 308.313, "load_throughput": 12973.808, "learn_time_ms": 8001.395, "learn_throughput": 499.913, "synch_weights_time_ms": 20.468}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 386, "training_iteration": 91, "trial_id": "74231_00000", "date": "2025-04-22_14-20-33", "timestamp": 1745346033, "time_this_iter_s": 19.143009901046753, "time_total_s": 1719.882384300232, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00685, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1719.882384300232, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 17.981481481481485, "ram_util_percent": 7.822222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49724306264711965, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3963676437269896, "policy_loss": -0.06172237273741273, "vf_loss": 0.003358089798363043, "vf_explained_var": 0.8773958298467821, "kl": 0.010415552082894559, "entropy": 33.90449223056916, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56730.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.935799999999812, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695002890047741, "mean_inference_ms": 1.7310888859085716, "mean_action_processing_ms": 0.1822931673581371, "mean_env_wait_ms": 45.517390814723605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03640174865722656, "StateBufferConnector_ms": 0.004702091217041016, "ViewRequirementAgentConnector_ms": 0.12383484840393066}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.935799999999812, "episode_len_mean": 900.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999818, 14.38999999999982, 13.94999999999983, 14.81499999999982, 15.759999999999753, 14.46999999999981, 14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695002890047741, "mean_inference_ms": 1.7310888859085716, "mean_action_processing_ms": 0.1822931673581371, "mean_env_wait_ms": 45.517390814723605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03640174865722656, "StateBufferConnector_ms": 0.004702091217041016, "ViewRequirementAgentConnector_ms": 0.12383484840393066}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.73896798062978, "num_env_steps_trained_throughput_per_sec": 212.73896798062978, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 18921.568, "sample_time_ms": 10578.058, "load_time_ms": 312.828, "load_throughput": 12786.575, "learn_time_ms": 8009.713, "learn_throughput": 499.394, "synch_weights_time_ms": 20.379}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 402, "training_iteration": 92, "trial_id": "74231_00000", "date": "2025-04-22_14-20-52", "timestamp": 1745346052, "time_this_iter_s": 18.80825185775757, "time_total_s": 1738.6906361579895, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006815, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1738.6906361579895, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.592307692307692, "ram_util_percent": 7.753846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4987035023589288, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4107118813080653, "policy_loss": -0.08583503772895182, "vf_loss": 0.007214117277528438, "vf_explained_var": 0.7403587228828861, "kl": 0.013496738405264032, "entropy": 33.3440643495129, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57350.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02529999999981, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693937906289333, "mean_inference_ms": 1.7316452624551215, "mean_action_processing_ms": 0.1823157636118748, "mean_env_wait_ms": 45.48970133821939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03589487075805664, "StateBufferConnector_ms": 0.0046350955963134766, "ViewRequirementAgentConnector_ms": 0.12209105491638184}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02529999999981, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693937906289333, "mean_inference_ms": 1.7316452624551215, "mean_action_processing_ms": 0.1823157636118748, "mean_env_wait_ms": 45.48970133821939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03589487075805664, "StateBufferConnector_ms": 0.0046350955963134766, "ViewRequirementAgentConnector_ms": 0.12209105491638184}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.26625325939813, "num_env_steps_trained_throughput_per_sec": 209.26625325939813, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 18947.654, "sample_time_ms": 10597.18, "load_time_ms": 312.753, "load_throughput": 12789.661, "learn_time_ms": 8017.071, "learn_throughput": 498.935, "synch_weights_time_ms": 20.082}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 408, "training_iteration": 93, "trial_id": "74231_00000", "date": "2025-04-22_14-21-11", "timestamp": 1745346071, "time_this_iter_s": 19.120197772979736, "time_total_s": 1757.8108339309692, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00678, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1757.8108339309692, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 18.296296296296298, "ram_util_percent": 7.751851851851853}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49873238018443505, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3876939206870438, "policy_loss": -0.05921030437663918, "vf_loss": 0.0075632429700480345, "vf_explained_var": 0.6597929989137957, "kl": 0.013134801605449484, "entropy": 33.73603473478748, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57970.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02529999999981, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693937906289333, "mean_inference_ms": 1.7316452624551215, "mean_action_processing_ms": 0.1823157636118748, "mean_env_wait_ms": 45.48970133821939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03589487075805664, "StateBufferConnector_ms": 0.0046350955963134766, "ViewRequirementAgentConnector_ms": 0.12209105491638184}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02529999999981, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693937906289333, "mean_inference_ms": 1.7316452624551215, "mean_action_processing_ms": 0.1823157636118748, "mean_env_wait_ms": 45.48970133821939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03589487075805664, "StateBufferConnector_ms": 0.0046350955963134766, "ViewRequirementAgentConnector_ms": 0.12209105491638184}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.48461399898676, "num_env_steps_trained_throughput_per_sec": 206.48461399898676, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 19032.885, "sample_time_ms": 10671.822, "load_time_ms": 313.167, "load_throughput": 12772.752, "learn_time_ms": 8027.148, "learn_throughput": 498.309, "synch_weights_time_ms": 20.176}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 408, "training_iteration": 94, "trial_id": "74231_00000", "date": "2025-04-22_14-21-31", "timestamp": 1745346091, "time_this_iter_s": 19.377795934677124, "time_total_s": 1777.1886298656464, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006745, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1777.1886298656464, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 18.451851851851856, "ram_util_percent": 7.881481481481483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49970830294393725, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.40723276945364273, "policy_loss": -0.06473785677714454, "vf_loss": 0.0029417739067331503, "vf_explained_var": 0.7040449071315027, "kl": 0.01006880972453209, "entropy": 34.64435759205972, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58590.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02529999999981, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693937906289333, "mean_inference_ms": 1.7316452624551215, "mean_action_processing_ms": 0.1823157636118748, "mean_env_wait_ms": 45.48970133821939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03589487075805664, "StateBufferConnector_ms": 0.0046350955963134766, "ViewRequirementAgentConnector_ms": 0.12209105491638184}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02529999999981, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999827, 14.469999999999816, 16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693937906289333, "mean_inference_ms": 1.7316452624551215, "mean_action_processing_ms": 0.1823157636118748, "mean_env_wait_ms": 45.48970133821939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03589487075805664, "StateBufferConnector_ms": 0.0046350955963134766, "ViewRequirementAgentConnector_ms": 0.12209105491638184}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.4616778570472, "num_env_steps_trained_throughput_per_sec": 211.4616778570472, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 19062.715, "sample_time_ms": 10728.238, "load_time_ms": 311.434, "load_throughput": 12843.817, "learn_time_ms": 8002.287, "learn_throughput": 499.857, "synch_weights_time_ms": 20.182}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 408, "training_iteration": 95, "trial_id": "74231_00000", "date": "2025-04-22_14-21-50", "timestamp": 1745346110, "time_this_iter_s": 18.92170238494873, "time_total_s": 1796.110332250595, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006710000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1796.110332250595, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 17.785185185185185, "ram_util_percent": 7.948148148148149}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49966898824899425, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3744517734462035, "policy_loss": -0.03823700456189052, "vf_loss": 0.011466340694317794, "vf_explained_var": 0.6644586937081429, "kl": 0.013751278475404931, "entropy": 34.905624521932296, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59210.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.04959999999981, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3691873130585393, "mean_inference_ms": 1.7309103578904206, "mean_action_processing_ms": 0.1822822880180211, "mean_env_wait_ms": 45.48527878152961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03597545623779297, "StateBufferConnector_ms": 0.0046384334564208984, "ViewRequirementAgentConnector_ms": 0.1223454475402832}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.04959999999981, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.23999999999982, 19.64499999999983, 14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3691873130585393, "mean_inference_ms": 1.7309103578904206, "mean_action_processing_ms": 0.1822822880180211, "mean_env_wait_ms": 45.48527878152961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03597545623779297, "StateBufferConnector_ms": 0.0046384334564208984, "ViewRequirementAgentConnector_ms": 0.1223454475402832}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.20124363036982, "num_env_steps_trained_throughput_per_sec": 211.20124363036982, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 19060.07, "sample_time_ms": 10681.022, "load_time_ms": 311.513, "load_throughput": 12840.535, "learn_time_ms": 8046.518, "learn_throughput": 497.109, "synch_weights_time_ms": 20.441}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 410, "training_iteration": 96, "trial_id": "74231_00000", "date": "2025-04-22_14-22-09", "timestamp": 1745346129, "time_this_iter_s": 18.94559359550476, "time_total_s": 1815.0559258460999, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006675, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1815.0559258460999, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 18.223076923076924, "ram_util_percent": 7.9692307692307685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4725735414653055, "cur_kl_coeff": 0.1, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.2639708505276846, "policy_loss": -0.04062552684016766, "vf_loss": 0.13001035845183592, "vf_explained_var": 0.6808861522905288, "kl": 0.0239310967383649, "entropy": 35.574880233887704, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59830.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.983949999999806, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3691982211513637, "mean_inference_ms": 1.731256920527923, "mean_action_processing_ms": 0.18230398814110418, "mean_env_wait_ms": 45.49141084404941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035944461822509766, "StateBufferConnector_ms": 0.004647254943847656, "ViewRequirementAgentConnector_ms": 0.12221717834472656}}, "episode_reward_max": 53.67499999999904, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.983949999999806, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999827, 19.344999999999892, 14.629999999999844, 15.749999999999812, 16.45999999999987, 15.764999999999779, 14.129999999999827, 17.804999999999957, 14.129999999999827, 53.67499999999904, 17.629999999999978, 14.289999999999816, 14.349999999999813, 16.184999999999818, 16.48999999999989, 14.469999999999825, 14.209999999999821, 17.83000000000003, 15.009999999999774, 17.439999999999984, 14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3691982211513637, "mean_inference_ms": 1.731256920527923, "mean_action_processing_ms": 0.18230398814110418, "mean_env_wait_ms": 45.49141084404941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035944461822509766, "StateBufferConnector_ms": 0.004647254943847656, "ViewRequirementAgentConnector_ms": 0.12221717834472656}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.22928681437762, "num_env_steps_trained_throughput_per_sec": 210.22928681437762, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 19127.23, "sample_time_ms": 10751.796, "load_time_ms": 312.121, "load_throughput": 12815.533, "learn_time_ms": 8042.185, "learn_throughput": 497.377, "synch_weights_time_ms": 20.556}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 412, "training_iteration": 97, "trial_id": "74231_00000", "date": "2025-04-22_14-22-28", "timestamp": 1745346148, "time_this_iter_s": 19.03341007232666, "time_total_s": 1834.0893359184265, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00664, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1834.0893359184265, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 18.051851851851854, "ram_util_percent": 7.981481481481482}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4962405790244379, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.271583287185058, "policy_loss": -0.05690570397362594, "vf_loss": 0.13046710246754378, "vf_explained_var": 0.7764846173024946, "kl": 0.01183094544497679, "entropy": 34.69193358575144, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60450.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 24.064999999999507, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.606449999999802, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694428941280826, "mean_inference_ms": 1.7348132687362698, "mean_action_processing_ms": 0.18236682780053642, "mean_env_wait_ms": 45.46883282719517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03619647026062012, "StateBufferConnector_ms": 0.00470423698425293, "ViewRequirementAgentConnector_ms": 0.1233205795288086}}, "episode_reward_max": 24.064999999999507, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.606449999999802, "episode_len_mean": 900.0, "episodes_this_iter": 20, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694428941280826, "mean_inference_ms": 1.7348132687362698, "mean_action_processing_ms": 0.18236682780053642, "mean_env_wait_ms": 45.46883282719517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03619647026062012, "StateBufferConnector_ms": 0.00470423698425293, "ViewRequirementAgentConnector_ms": 0.1233205795288086}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.3558276347366, "num_env_steps_trained_throughput_per_sec": 207.3558276347366, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 19095.143, "sample_time_ms": 10719.565, "load_time_ms": 312.762, "load_throughput": 12789.269, "learn_time_ms": 8041.796, "learn_throughput": 497.401, "synch_weights_time_ms": 20.456}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 432, "training_iteration": 98, "trial_id": "74231_00000", "date": "2025-04-22_14-22-47", "timestamp": 1745346167, "time_this_iter_s": 19.296924114227295, "time_total_s": 1853.3862600326538, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006605, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1853.3862600326538, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 17.553571428571427, "ram_util_percent": 7.825000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49723768597168305, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3039669681520712, "policy_loss": -0.05431850930570715, "vf_loss": 0.09597989051239306, "vf_explained_var": 0.6369022755853592, "kl": 0.010037481841596496, "entropy": 34.71339789667437, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61070.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 24.064999999999507, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.606449999999802, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694428941280826, "mean_inference_ms": 1.7348132687362698, "mean_action_processing_ms": 0.18236682780053642, "mean_env_wait_ms": 45.46883282719517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03619647026062012, "StateBufferConnector_ms": 0.00470423698425293, "ViewRequirementAgentConnector_ms": 0.1233205795288086}}, "episode_reward_max": 24.064999999999507, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.606449999999802, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694428941280826, "mean_inference_ms": 1.7348132687362698, "mean_action_processing_ms": 0.18236682780053642, "mean_env_wait_ms": 45.46883282719517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03619647026062012, "StateBufferConnector_ms": 0.00470423698425293, "ViewRequirementAgentConnector_ms": 0.1233205795288086}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.202611760664, "num_env_steps_trained_throughput_per_sec": 209.202611760664, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 19044.551, "sample_time_ms": 10704.049, "load_time_ms": 312.573, "load_throughput": 12797.002, "learn_time_ms": 8006.841, "learn_throughput": 499.573, "synch_weights_time_ms": 20.52}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 432, "training_iteration": 99, "trial_id": "74231_00000", "date": "2025-04-22_14-23-06", "timestamp": 1745346186, "time_this_iter_s": 19.125685930252075, "time_total_s": 1872.5119459629059, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00657, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1872.5119459629059, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.559259259259257, "ram_util_percent": 7.944444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49609139318908413, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3315668791652687, "policy_loss": -0.04627297017160022, "vf_loss": 0.06951068204321165, "vf_explained_var": 0.6106674034749308, "kl": 0.009119706581400204, "entropy": 35.61725502629434, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61690.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 24.064999999999507, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.606449999999802, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694428941280826, "mean_inference_ms": 1.7348132687362698, "mean_action_processing_ms": 0.18236682780053642, "mean_env_wait_ms": 45.46883282719517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03619647026062012, "StateBufferConnector_ms": 0.00470423698425293, "ViewRequirementAgentConnector_ms": 0.1233205795288086}}, "episode_reward_max": 24.064999999999507, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.606449999999802, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.289999999999816, 14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694428941280826, "mean_inference_ms": 1.7348132687362698, "mean_action_processing_ms": 0.18236682780053642, "mean_env_wait_ms": 45.46883282719517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03619647026062012, "StateBufferConnector_ms": 0.00470423698425293, "ViewRequirementAgentConnector_ms": 0.1233205795288086}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.06212480649612, "num_env_steps_trained_throughput_per_sec": 202.06212480649612, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 19151.416, "sample_time_ms": 10818.104, "load_time_ms": 312.142, "load_throughput": 12814.686, "learn_time_ms": 7999.987, "learn_throughput": 500.001, "synch_weights_time_ms": 20.62}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 432, "training_iteration": 100, "trial_id": "74231_00000", "date": "2025-04-22_14-23-26", "timestamp": 1745346206, "time_this_iter_s": 19.802342653274536, "time_total_s": 1892.3142886161804, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006535, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1892.3142886161804, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 17.575, "ram_util_percent": 7.971428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4997488931782784, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.44948417463850593, "policy_loss": -0.08863360432216957, "vf_loss": 0.0013178337840203782, "vf_explained_var": 0.7729653637255391, "kl": 0.008720804935576105, "entropy": 36.347652727557765, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62310.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": 24.064999999999507, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.6258999999998, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36924345365755756, "mean_inference_ms": 1.7339325174556928, "mean_action_processing_ms": 0.18232506149891367, "mean_env_wait_ms": 45.46827617809553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03618168830871582, "StateBufferConnector_ms": 0.004694700241088867, "ViewRequirementAgentConnector_ms": 0.12326335906982422}}, "episode_reward_max": 24.064999999999507, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.6258999999998, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999827, 14.669999999999824, 17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36924345365755756, "mean_inference_ms": 1.7339325174556928, "mean_action_processing_ms": 0.18232506149891367, "mean_env_wait_ms": 45.46827617809553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03618168830871582, "StateBufferConnector_ms": 0.004694700241088867, "ViewRequirementAgentConnector_ms": 0.12326335906982422}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.29768046909317, "num_env_steps_trained_throughput_per_sec": 215.29768046909317, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 19095.602, "sample_time_ms": 10767.271, "load_time_ms": 312.853, "load_throughput": 12785.566, "learn_time_ms": 7994.26, "learn_throughput": 500.359, "synch_weights_time_ms": 20.661}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 433, "training_iteration": 101, "trial_id": "74231_00000", "date": "2025-04-22_14-23-45", "timestamp": 1745346225, "time_this_iter_s": 18.584495782852173, "time_total_s": 1910.8987843990326, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006500000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1910.8987843990326, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 18.276923076923076, "ram_util_percent": 7.907692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4855059251429573, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.29968527104825743, "policy_loss": -0.047304780150373135, "vf_loss": 0.11354939738114353, "vf_explained_var": 0.7101795844493374, "kl": 0.011170464160195773, "entropy": 36.76054625664988, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62930.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.085299999999815, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3691941147319324, "mean_inference_ms": 1.734259559167421, "mean_action_processing_ms": 0.1823328210932424, "mean_env_wait_ms": 45.45851418423832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0361635684967041, "StateBufferConnector_ms": 0.0046999454498291016, "ViewRequirementAgentConnector_ms": 0.12319707870483398}}, "episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.085299999999815, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.38499999999981, 20.85999999999981, 15.889999999999766, 14.209999999999825, 18.944999999999887, 17.759999999999984, 15.08999999999982, 17.069999999999705, 16.354999999999784, 14.389999999999821, 14.209999999999818, 15.109999999999822, 14.209999999999818, 14.309999999999823, 14.10999999999983, 14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3691941147319324, "mean_inference_ms": 1.734259559167421, "mean_action_processing_ms": 0.1823328210932424, "mean_env_wait_ms": 45.45851418423832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0361635684967041, "StateBufferConnector_ms": 0.0046999454498291016, "ViewRequirementAgentConnector_ms": 0.12319707870483398}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.4725653091953, "num_env_steps_trained_throughput_per_sec": 209.4725653091953, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 19124.922, "sample_time_ms": 10804.949, "load_time_ms": 303.134, "load_throughput": 13195.467, "learn_time_ms": 7995.506, "learn_throughput": 500.281, "synch_weights_time_ms": 20.772}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 435, "training_iteration": 102, "trial_id": "74231_00000", "date": "2025-04-22_14-24-04", "timestamp": 1745346244, "time_this_iter_s": 19.100846767425537, "time_total_s": 1929.9996311664581, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006465, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1929.9996311664581, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 18.114814814814814, "ram_util_percent": 7.833333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4966763761255049, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3091533172575216, "policy_loss": -0.0531032009591018, "vf_loss": 0.11002987321727203, "vf_explained_var": 0.8285510147771528, "kl": 0.011961551236761866, "entropy": 36.78742329997401, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63550.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.966099999999813, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695918269757918, "mean_inference_ms": 1.736976954570626, "mean_action_processing_ms": 0.18238637719813866, "mean_env_wait_ms": 45.47852270066222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036719560623168945, "StateBufferConnector_ms": 0.0047872066497802734, "ViewRequirementAgentConnector_ms": 0.1254100799560547}}, "episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.966099999999813, "episode_len_mean": 900.0, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.484999999999797, 14.40999999999981, 15.169999999999803, 15.189999999999774, 15.389999999999798, 14.4349999999998, 14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695918269757918, "mean_inference_ms": 1.736976954570626, "mean_action_processing_ms": 0.18238637719813866, "mean_env_wait_ms": 45.47852270066222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036719560623168945, "StateBufferConnector_ms": 0.0047872066497802734, "ViewRequirementAgentConnector_ms": 0.1254100799560547}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.04521645193884, "num_env_steps_trained_throughput_per_sec": 212.04521645193884, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 19099.873, "sample_time_ms": 10777.598, "load_time_ms": 303.404, "load_throughput": 13183.745, "learn_time_ms": 7997.504, "learn_throughput": 500.156, "synch_weights_time_ms": 20.809}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 450, "training_iteration": 103, "trial_id": "74231_00000", "date": "2025-04-22_14-24-23", "timestamp": 1745346263, "time_this_iter_s": 18.870137214660645, "time_total_s": 1948.8697683811188, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00643, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1948.8697683811188, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 18.638461538461538, "ram_util_percent": 7.81923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49960010344943695, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.3458005524096793, "policy_loss": -0.01867884484930865, "vf_loss": 0.0301227716928723, "vf_explained_var": 0.6278555821026525, "kl": 0.010812183496008609, "entropy": 35.88663178105508, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64170.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31469999999983, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695507934431122, "mean_inference_ms": 1.737415215252402, "mean_action_processing_ms": 0.18242062241930637, "mean_env_wait_ms": 45.462040320431754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03695321083068848, "StateBufferConnector_ms": 0.004826068878173828, "ViewRequirementAgentConnector_ms": 0.1260063648223877}}, "episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31469999999983, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695507934431122, "mean_inference_ms": 1.737415215252402, "mean_action_processing_ms": 0.18242062241930637, "mean_env_wait_ms": 45.462040320431754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03695321083068848, "StateBufferConnector_ms": 0.004826068878173828, "ViewRequirementAgentConnector_ms": 0.1260063648223877}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.09974559514777, "num_env_steps_trained_throughput_per_sec": 202.09974559514777, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 19141.903, "sample_time_ms": 10821.828, "load_time_ms": 303.939, "load_throughput": 13160.522, "learn_time_ms": 7994.927, "learn_throughput": 500.317, "synch_weights_time_ms": 20.655}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 456, "training_iteration": 104, "trial_id": "74231_00000", "date": "2025-04-22_14-24-42", "timestamp": 1745346282, "time_this_iter_s": 19.79811429977417, "time_total_s": 1968.667882680893, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006395, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1968.667882680893, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 18.014285714285716, "ram_util_percent": 7.767857142857141}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4999116809618088, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4225818507238141, "policy_loss": -0.055551544457088195, "vf_loss": 0.0019556697955713095, "vf_explained_var": 0.6994460963433788, "kl": 0.007834507599017666, "entropy": 37.01611606228736, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64790.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31469999999983, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695507934431122, "mean_inference_ms": 1.737415215252402, "mean_action_processing_ms": 0.18242062241930637, "mean_env_wait_ms": 45.462040320431754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03695321083068848, "StateBufferConnector_ms": 0.004826068878173828, "ViewRequirementAgentConnector_ms": 0.1260063648223877}}, "episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31469999999983, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.469999999999816, 14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695507934431122, "mean_inference_ms": 1.737415215252402, "mean_action_processing_ms": 0.18242062241930637, "mean_env_wait_ms": 45.462040320431754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03695321083068848, "StateBufferConnector_ms": 0.004826068878173828, "ViewRequirementAgentConnector_ms": 0.1260063648223877}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.92543770179037, "num_env_steps_trained_throughput_per_sec": 209.92543770179037, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 19155.746, "sample_time_ms": 10820.271, "load_time_ms": 305.482, "load_throughput": 13094.073, "learn_time_ms": 8008.699, "learn_throughput": 499.457, "synch_weights_time_ms": 20.74}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 456, "training_iteration": 105, "trial_id": "74231_00000", "date": "2025-04-22_14-25-01", "timestamp": 1745346301, "time_this_iter_s": 19.0599946975708, "time_total_s": 1987.7278773784637, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00636, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 1987.7278773784637, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 17.751851851851853, "ram_util_percent": 7.755555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4418023628092581, "policy_loss": -0.06880009003239872, "vf_loss": 0.0014524365860808992, "vf_explained_var": 0.7822930474435129, "kl": 0.007909521179965448, "entropy": 37.56411454600673, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65410.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31549999999983, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36933194838588557, "mean_inference_ms": 1.7363764512139301, "mean_action_processing_ms": 0.18237741250380385, "mean_env_wait_ms": 45.456447584764625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03688788414001465, "StateBufferConnector_ms": 0.0048100948333740234, "ViewRequirementAgentConnector_ms": 0.12583661079406738}}, "episode_reward_max": 55.23000000000157, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.31549999999983, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.64999999999988, 15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36933194838588557, "mean_inference_ms": 1.7363764512139301, "mean_action_processing_ms": 0.18237741250380385, "mean_env_wait_ms": 45.456447584764625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03688788414001465, "StateBufferConnector_ms": 0.0048100948333740234, "ViewRequirementAgentConnector_ms": 0.12583661079406738}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.13868115293198, "num_env_steps_trained_throughput_per_sec": 211.13868115293198, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 19156.306, "sample_time_ms": 10849.546, "load_time_ms": 316.169, "load_throughput": 12651.448, "learn_time_ms": 7969.512, "learn_throughput": 501.913, "synch_weights_time_ms": 20.531}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 457, "training_iteration": 106, "trial_id": "74231_00000", "date": "2025-04-22_14-25-20", "timestamp": 1745346320, "time_this_iter_s": 18.95049285888672, "time_total_s": 2006.6783702373505, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006325, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2006.6783702373505, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.14074074074074, "ram_util_percent": 7.707407407407406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4661304809710747, "policy_loss": -0.0896506804927823, "vf_loss": 0.0005932826897121906, "vf_explained_var": 0.6740985618483636, "kl": 0.008634154276964777, "entropy": 37.83682113770516, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66030.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.746999999999844, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693308788185727, "mean_inference_ms": 1.7364760112275313, "mean_action_processing_ms": 0.1823904258981309, "mean_env_wait_ms": 45.456621934355184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03694653511047363, "StateBufferConnector_ms": 0.0048100948333740234, "ViewRequirementAgentConnector_ms": 0.1259469985961914}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.746999999999844, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.249999999999758, 14.289999999999825, 18.44999999999993, 18.8399999999999, 13.94999999999983, 15.194999999999766, 14.029999999999825, 13.94999999999983, 15.529999999999774, 14.12999999999982, 14.129999999999832, 14.309999999999823, 14.28999999999982, 15.869999999999768, 14.129999999999821, 13.94999999999983, 14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693308788185727, "mean_inference_ms": 1.7364760112275313, "mean_action_processing_ms": 0.1823904258981309, "mean_env_wait_ms": 45.456621934355184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03694653511047363, "StateBufferConnector_ms": 0.0048100948333740234, "ViewRequirementAgentConnector_ms": 0.1259469985961914}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.17628649097375, "num_env_steps_trained_throughput_per_sec": 211.17628649097375, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 19147.774, "sample_time_ms": 10785.294, "load_time_ms": 316.284, "load_throughput": 12646.868, "learn_time_ms": 8020.528, "learn_throughput": 498.72, "synch_weights_time_ms": 21.407}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 458, "training_iteration": 107, "trial_id": "74231_00000", "date": "2025-04-22_14-25-39", "timestamp": 1745346339, "time_this_iter_s": 18.947359323501587, "time_total_s": 2025.625729560852, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0062900000000000005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2025.625729560852, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 16.903703703703705, "ram_util_percent": 7.755555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.42354590441682377, "policy_loss": -0.043169031383830214, "vf_loss": 0.001432397105435807, "vf_explained_var": 0.7785370994960108, "kl": 0.007139249667940725, "entropy": 38.288016534620716, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66650.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.74019999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3696928288440013, "mean_inference_ms": 1.738033857290299, "mean_action_processing_ms": 0.18242294754802188, "mean_env_wait_ms": 45.47604403730214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03686070442199707, "StateBufferConnector_ms": 0.004796028137207031, "ViewRequirementAgentConnector_ms": 0.12573885917663574}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.74019999999984, "episode_len_mean": 900.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 16.929999999999783, 13.94999999999983, 14.619999999999878, 14.129999999999821, 14.894999999999827, 15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3696928288440013, "mean_inference_ms": 1.738033857290299, "mean_action_processing_ms": 0.18242294754802188, "mean_env_wait_ms": 45.47604403730214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03686070442199707, "StateBufferConnector_ms": 0.004796028137207031, "ViewRequirementAgentConnector_ms": 0.12573885917663574}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.36083846182999, "num_env_steps_trained_throughput_per_sec": 209.36083846182999, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 19129.3, "sample_time_ms": 10740.779, "load_time_ms": 315.609, "load_throughput": 12673.915, "learn_time_ms": 8047.357, "learn_throughput": 497.058, "synch_weights_time_ms": 21.293}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 474, "training_iteration": 108, "trial_id": "74231_00000", "date": "2025-04-22_14-25-59", "timestamp": 1745346359, "time_this_iter_s": 19.11174178123474, "time_total_s": 2044.7374713420868, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006255, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2044.7374713420868, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 17.20740740740741, "ram_util_percent": 7.7888888888888905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4966413351076265, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4430411147674726, "policy_loss": -0.07313027494256535, "vf_loss": 0.006082025221764026, "vf_explained_var": 0.6017762102427021, "kl": 0.011370033913138492, "entropy": 37.76983742252473, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67270.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.731249999999843, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36959907244832324, "mean_inference_ms": 1.7381292628058773, "mean_action_processing_ms": 0.18244686630984824, "mean_env_wait_ms": 45.45291208955789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03674745559692383, "StateBufferConnector_ms": 0.004777193069458008, "ViewRequirementAgentConnector_ms": 0.12525463104248047}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.731249999999843, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36959907244832324, "mean_inference_ms": 1.7381292628058773, "mean_action_processing_ms": 0.18244686630984824, "mean_env_wait_ms": 45.45291208955789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03674745559692383, "StateBufferConnector_ms": 0.004777193069458008, "ViewRequirementAgentConnector_ms": 0.12525463104248047}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.92796256076122, "num_env_steps_trained_throughput_per_sec": 216.92796256076122, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 19061.207, "sample_time_ms": 10655.535, "load_time_ms": 315.31, "load_throughput": 12685.922, "learn_time_ms": 8064.768, "learn_throughput": 495.985, "synch_weights_time_ms": 21.335}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 480, "training_iteration": 109, "trial_id": "74231_00000", "date": "2025-04-22_14-26-17", "timestamp": 1745346377, "time_this_iter_s": 18.445269107818604, "time_total_s": 2063.1827404499054, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00622, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2063.1827404499054, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 18.296153846153842, "ram_util_percent": 7.784615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4090507305496665, "policy_loss": -0.03698983584350395, "vf_loss": 0.0055051560949117805, "vf_explained_var": 0.6374269138420782, "kl": 0.009127731042286952, "entropy": 37.89352175804876, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67890.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.731249999999843, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36959907244832324, "mean_inference_ms": 1.7381292628058773, "mean_action_processing_ms": 0.18244686630984824, "mean_env_wait_ms": 45.45291208955789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03674745559692383, "StateBufferConnector_ms": 0.004777193069458008, "ViewRequirementAgentConnector_ms": 0.12525463104248047}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.731249999999843, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36959907244832324, "mean_inference_ms": 1.7381292628058773, "mean_action_processing_ms": 0.18244686630984824, "mean_env_wait_ms": 45.45291208955789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03674745559692383, "StateBufferConnector_ms": 0.004777193069458008, "ViewRequirementAgentConnector_ms": 0.12525463104248047}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.5455239258996, "num_env_steps_trained_throughput_per_sec": 202.5455239258996, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 19056.483, "sample_time_ms": 10641.572, "load_time_ms": 314.839, "load_throughput": 12704.92, "learn_time_ms": 8074.672, "learn_throughput": 495.376, "synch_weights_time_ms": 21.132}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 480, "training_iteration": 110, "trial_id": "74231_00000", "date": "2025-04-22_14-26-37", "timestamp": 1745346397, "time_this_iter_s": 19.754316568374634, "time_total_s": 2082.93705701828, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0061849999999999995, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2082.93705701828, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 17.567857142857143, "ram_util_percent": 7.821428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49981174223846003, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4241263346386052, "policy_loss": -0.04055083699697148, "vf_loss": 0.0019671635060354497, "vf_explained_var": 0.7205559301760889, "kl": 0.007911151403342018, "entropy": 38.672934119932115, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68510.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.731249999999843, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36959907244832324, "mean_inference_ms": 1.7381292628058773, "mean_action_processing_ms": 0.18244686630984824, "mean_env_wait_ms": 45.45291208955789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03674745559692383, "StateBufferConnector_ms": 0.004777193069458008, "ViewRequirementAgentConnector_ms": 0.12525463104248047}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.731249999999843, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.85499999999976, 15.069999999999794, 15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36959907244832324, "mean_inference_ms": 1.7381292628058773, "mean_action_processing_ms": 0.18244686630984824, "mean_env_wait_ms": 45.45291208955789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03674745559692383, "StateBufferConnector_ms": 0.004777193069458008, "ViewRequirementAgentConnector_ms": 0.12525463104248047}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.7880709137508, "num_env_steps_trained_throughput_per_sec": 206.7880709137508, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 19132.938, "sample_time_ms": 10710.609, "load_time_ms": 313.331, "load_throughput": 12766.045, "learn_time_ms": 8083.566, "learn_throughput": 494.831, "synch_weights_time_ms": 21.157}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 480, "training_iteration": 111, "trial_id": "74231_00000", "date": "2025-04-22_14-26-56", "timestamp": 1745346416, "time_this_iter_s": 19.34943985939026, "time_total_s": 2102.2864968776703, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006149999999999999, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2102.2864968776703, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 17.737037037037037, "ram_util_percent": 7.914814814814815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.45841185864692013, "policy_loss": -0.06940069598025612, "vf_loss": 0.001504743682907276, "vf_explained_var": 0.7447373395004581, "kl": 0.0069466948002129, "entropy": 39.15579187331661, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69130.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.717149999999844, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36938343268875834, "mean_inference_ms": 1.7371957938551668, "mean_action_processing_ms": 0.1824158645301139, "mean_env_wait_ms": 45.4517915100733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03669857978820801, "StateBufferConnector_ms": 0.00476384162902832, "ViewRequirementAgentConnector_ms": 0.12508630752563477}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.717149999999844, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.829999999999778, 14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36938343268875834, "mean_inference_ms": 1.7371957938551668, "mean_action_processing_ms": 0.1824158645301139, "mean_env_wait_ms": 45.4517915100733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03669857978820801, "StateBufferConnector_ms": 0.00476384162902832, "ViewRequirementAgentConnector_ms": 0.12508630752563477}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.04208147330434, "num_env_steps_trained_throughput_per_sec": 216.04208147330434, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 19074.871, "sample_time_ms": 10637.896, "load_time_ms": 312.643, "load_throughput": 12794.155, "learn_time_ms": 8098.984, "learn_throughput": 493.889, "synch_weights_time_ms": 21.076}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 482, "training_iteration": 112, "trial_id": "74231_00000", "date": "2025-04-22_14-27-15", "timestamp": 1745346435, "time_this_iter_s": 18.520474672317505, "time_total_s": 2120.806971549988, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006115, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2120.806971549988, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 17.861538461538462, "ram_util_percent": 7.911538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4521421717780252, "policy_loss": -0.05821956024080845, "vf_loss": 0.0008572745578953067, "vf_explained_var": 0.661563011715489, "kl": 0.007490424847726958, "entropy": 39.590345690327304, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69750.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.699949999999845, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36935162176795033, "mean_inference_ms": 1.7373530042055967, "mean_action_processing_ms": 0.18241995326700308, "mean_env_wait_ms": 45.454479771313565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03679800033569336, "StateBufferConnector_ms": 0.0047855377197265625, "ViewRequirementAgentConnector_ms": 0.12536072731018066}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.699949999999845, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.189999999999822, 16.414999999999782, 17.8149999999998, 15.569999999999778, 14.12999999999982, 24.064999999999507, 14.129999999999821, 14.189999999999822, 14.389999999999807, 22.229999999999627, 14.309999999999828, 14.129999999999832, 14.029999999999825, 14.189999999999824, 14.469999999999821, 14.389999999999805, 21.36999999999963, 14.10999999999982, 22.609999999999626, 14.20999999999982, 14.469999999999816, 14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36935162176795033, "mean_inference_ms": 1.7373530042055967, "mean_action_processing_ms": 0.18241995326700308, "mean_env_wait_ms": 45.454479771313565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03679800033569336, "StateBufferConnector_ms": 0.0047855377197265625, "ViewRequirementAgentConnector_ms": 0.12536072731018066}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.63396490855965, "num_env_steps_trained_throughput_per_sec": 208.63396490855965, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 19105.714, "sample_time_ms": 10660.347, "load_time_ms": 313.342, "load_throughput": 12765.609, "learn_time_ms": 8106.645, "learn_throughput": 493.422, "synch_weights_time_ms": 21.11}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 483, "training_iteration": 113, "trial_id": "74231_00000", "date": "2025-04-22_14-27-34", "timestamp": 1745346454, "time_this_iter_s": 19.17784333229065, "time_total_s": 2139.9848148822784, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0060799999999999995, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2139.9848148822784, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 17.492592592592594, "ram_util_percent": 7.907407407407408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4997293932783988, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.43395464828297975, "policy_loss": -0.0807659407867299, "vf_loss": 0.02400524584843204, "vf_explained_var": 0.7285554867598318, "kl": 0.009622254097614073, "entropy": 37.86372970458, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70370.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54944999999985, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36963646269888445, "mean_inference_ms": 1.738754674762767, "mean_action_processing_ms": 0.1824720636442628, "mean_env_wait_ms": 45.44379058090162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037153005599975586, "StateBufferConnector_ms": 0.0048029422760009766, "ViewRequirementAgentConnector_ms": 0.1269698143005371}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54944999999985, "episode_len_mean": 900.0, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36963646269888445, "mean_inference_ms": 1.738754674762767, "mean_action_processing_ms": 0.1824720636442628, "mean_env_wait_ms": 45.44379058090162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037153005599975586, "StateBufferConnector_ms": 0.0048029422760009766, "ViewRequirementAgentConnector_ms": 0.1269698143005371}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.54560845048692, "num_env_steps_trained_throughput_per_sec": 208.54560845048692, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 19044.539, "sample_time_ms": 10557.329, "load_time_ms": 312.961, "load_throughput": 12781.153, "learn_time_ms": 8148.762, "learn_throughput": 490.872, "synch_weights_time_ms": 21.211}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 504, "training_iteration": 114, "trial_id": "74231_00000", "date": "2025-04-22_14-27-53", "timestamp": 1745346473, "time_this_iter_s": 19.187007665634155, "time_total_s": 2159.1718225479126, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006045000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2159.1718225479126, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 18.09259259259259, "ram_util_percent": 7.822222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.39802351659314045, "policy_loss": -0.07220521094127287, "vf_loss": 0.045448802775676846, "vf_explained_var": 0.5677421779401841, "kl": 0.010041997601940474, "entropy": 37.2773417995822, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70990.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54944999999985, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36963646269888445, "mean_inference_ms": 1.738754674762767, "mean_action_processing_ms": 0.1824720636442628, "mean_env_wait_ms": 45.44379058090162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037153005599975586, "StateBufferConnector_ms": 0.0048029422760009766, "ViewRequirementAgentConnector_ms": 0.1269698143005371}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54944999999985, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36963646269888445, "mean_inference_ms": 1.738754674762767, "mean_action_processing_ms": 0.1824720636442628, "mean_env_wait_ms": 45.44379058090162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037153005599975586, "StateBufferConnector_ms": 0.0048029422760009766, "ViewRequirementAgentConnector_ms": 0.1269698143005371}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.15358302170037, "num_env_steps_trained_throughput_per_sec": 201.15358302170037, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 19127.631, "sample_time_ms": 10625.449, "load_time_ms": 312.273, "load_throughput": 12809.29, "learn_time_ms": 8164.474, "learn_throughput": 489.927, "synch_weights_time_ms": 21.16}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 504, "training_iteration": 115, "trial_id": "74231_00000", "date": "2025-04-22_14-28-13", "timestamp": 1745346493, "time_this_iter_s": 19.89120388031006, "time_total_s": 2179.0630264282227, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.006010000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2179.0630264282227, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 18.478571428571428, "ram_util_percent": 7.846428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.41069784038249524, "policy_loss": -0.03982587406851141, "vf_loss": 0.013015531133902598, "vf_explained_var": 0.7396788540386384, "kl": 0.007745982430729313, "entropy": 38.50494025445754, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71610.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54944999999985, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36963646269888445, "mean_inference_ms": 1.738754674762767, "mean_action_processing_ms": 0.1824720636442628, "mean_env_wait_ms": 45.44379058090162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037153005599975586, "StateBufferConnector_ms": 0.0048029422760009766, "ViewRequirementAgentConnector_ms": 0.1269698143005371}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54944999999985, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999827, 15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36963646269888445, "mean_inference_ms": 1.738754674762767, "mean_action_processing_ms": 0.1824720636442628, "mean_env_wait_ms": 45.44379058090162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037153005599975586, "StateBufferConnector_ms": 0.0048029422760009766, "ViewRequirementAgentConnector_ms": 0.1269698143005371}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.71617047436055, "num_env_steps_trained_throughput_per_sec": 201.71617047436055, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 19216.127, "sample_time_ms": 10702.809, "load_time_ms": 301.204, "load_throughput": 13280.038, "learn_time_ms": 8186.647, "learn_throughput": 488.6, "synch_weights_time_ms": 21.19}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 504, "training_iteration": 116, "trial_id": "74231_00000", "date": "2025-04-22_14-28-33", "timestamp": 1745346513, "time_this_iter_s": 19.83525013923645, "time_total_s": 2198.898276567459, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005975, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2198.898276567459, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 18.20714285714286, "ram_util_percent": 7.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.48037618782611624, "policy_loss": -0.08544155506927881, "vf_loss": 0.0012457679268927972, "vf_explained_var": 0.8007959235099054, "kl": 0.007631808873831629, "entropy": 39.732518294549756, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72230.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54864999999985, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694180165728826, "mean_inference_ms": 1.7377083126742374, "mean_action_processing_ms": 0.18242659387499455, "mean_env_wait_ms": 45.43966605197294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03717327117919922, "StateBufferConnector_ms": 0.0047986507415771484, "ViewRequirementAgentConnector_ms": 0.12703347206115723}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54864999999985, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.514999999999983, 23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694180165728826, "mean_inference_ms": 1.7377083126742374, "mean_action_processing_ms": 0.18242659387499455, "mean_env_wait_ms": 45.43966605197294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03717327117919922, "StateBufferConnector_ms": 0.0047986507415771484, "ViewRequirementAgentConnector_ms": 0.12703347206115723}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.36554383937246, "num_env_steps_trained_throughput_per_sec": 209.36554383937246, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 19232.507, "sample_time_ms": 10749.824, "load_time_ms": 301.439, "load_throughput": 13269.693, "learn_time_ms": 8160.53, "learn_throughput": 490.164, "synch_weights_time_ms": 20.148}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 505, "training_iteration": 117, "trial_id": "74231_00000", "date": "2025-04-22_14-28-52", "timestamp": 1745346532, "time_this_iter_s": 19.111496925354004, "time_total_s": 2218.009773492813, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005940000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2218.009773492813, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 18.12962962962963, "ram_util_percent": 7.837037037037038}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49912556073357983, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5299339499504816, "policy_loss": -0.13186139200904196, "vf_loss": 0.00041790391039739914, "vf_explained_var": 0.8199291888744601, "kl": 0.012273647979717708, "entropy": 40.0331510174659, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72850.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54819999999985, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36942358085089916, "mean_inference_ms": 1.7378409459265445, "mean_action_processing_ms": 0.18244046190281993, "mean_env_wait_ms": 45.44730274834547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03719735145568848, "StateBufferConnector_ms": 0.0048007965087890625, "ViewRequirementAgentConnector_ms": 0.12706327438354492}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.54819999999985, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.149999999999622, 15.169999999999789, 16.799999999999784, 14.309999999999821, 15.289999999999761, 14.02999999999983, 14.20999999999982, 22.529999999999635, 15.764999999999823, 23.169999999999625, 14.129999999999832, 13.94999999999983, 14.869999999999798, 13.94999999999983, 15.889999999999809, 14.129999999999832, 14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36942358085089916, "mean_inference_ms": 1.7378409459265445, "mean_action_processing_ms": 0.18244046190281993, "mean_env_wait_ms": 45.44730274834547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03719735145568848, "StateBufferConnector_ms": 0.0048007965087890625, "ViewRequirementAgentConnector_ms": 0.12706327438354492}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.6696743449184, "num_env_steps_trained_throughput_per_sec": 206.6696743449184, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 19257.386, "sample_time_ms": 10730.892, "load_time_ms": 301.831, "load_throughput": 13252.449, "learn_time_ms": 8203.839, "learn_throughput": 487.577, "synch_weights_time_ms": 20.261}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 506, "training_iteration": 118, "trial_id": "74231_00000", "date": "2025-04-22_14-29-11", "timestamp": 1745346551, "time_this_iter_s": 19.3603458404541, "time_total_s": 2237.370119333267, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0059050000000000005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2237.370119333267, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 17.392857142857142, "ram_util_percent": 7.789285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.45076467559162164, "policy_loss": -0.053271678394183605, "vf_loss": 0.002091487088477328, "vf_explained_var": 0.83962384395061, "kl": 0.007249643304402848, "entropy": 40.067194224942114, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73470.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.727249999999852, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3698019401777334, "mean_inference_ms": 1.7396516381088925, "mean_action_processing_ms": 0.1824820908945332, "mean_env_wait_ms": 45.47883541212932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03742027282714844, "StateBufferConnector_ms": 0.004790782928466797, "ViewRequirementAgentConnector_ms": 0.12701773643493652}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.727249999999852, "episode_len_mean": 900.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.289999999999814, 14.469999999999816, 14.209999999999823, 14.129999999999825, 14.989999999999794, 14.26999999999982, 14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3698019401777334, "mean_inference_ms": 1.7396516381088925, "mean_action_processing_ms": 0.1824820908945332, "mean_env_wait_ms": 45.47883541212932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03742027282714844, "StateBufferConnector_ms": 0.004790782928466797, "ViewRequirementAgentConnector_ms": 0.12701773643493652}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.96020524050496, "num_env_steps_trained_throughput_per_sec": 213.96020524050496, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 19282.962, "sample_time_ms": 10753.647, "load_time_ms": 300.512, "load_throughput": 13310.617, "learn_time_ms": 8208.047, "learn_throughput": 487.327, "synch_weights_time_ms": 20.186}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 522, "training_iteration": 119, "trial_id": "74231_00000", "date": "2025-04-22_14-29-30", "timestamp": 1745346570, "time_this_iter_s": 18.701170206069946, "time_total_s": 2256.071289539337, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00587, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2256.071289539337, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 18.738461538461536, "ram_util_percent": 7.81923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4991964690146908, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.451427359457293, "policy_loss": -0.06373881694612904, "vf_loss": 0.007453225288265142, "vf_explained_var": 0.633452663306267, "kl": 0.009653049166597831, "entropy": 39.65897403532459, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74090.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.725399999999855, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3696397793143172, "mean_inference_ms": 1.7394370781324653, "mean_action_processing_ms": 0.1824961710643976, "mean_env_wait_ms": 45.455451649374744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037201642990112305, "StateBufferConnector_ms": 0.0047588348388671875, "ViewRequirementAgentConnector_ms": 0.12641119956970215}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.725399999999855, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3696397793143172, "mean_inference_ms": 1.7394370781324653, "mean_action_processing_ms": 0.1824961710643976, "mean_env_wait_ms": 45.455451649374744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037201642990112305, "StateBufferConnector_ms": 0.0047588348388671875, "ViewRequirementAgentConnector_ms": 0.12641119956970215}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.13578693840373, "num_env_steps_trained_throughput_per_sec": 213.13578693840373, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 19184.835, "sample_time_ms": 10646.64, "load_time_ms": 301.452, "load_throughput": 13269.094, "learn_time_ms": 8215.886, "learn_throughput": 486.862, "synch_weights_time_ms": 20.288}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 528, "training_iteration": 120, "trial_id": "74231_00000", "date": "2025-04-22_14-29-49", "timestamp": 1745346589, "time_this_iter_s": 18.773571252822876, "time_total_s": 2274.84486079216, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005835, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2274.84486079216, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 18.259259259259263, "ram_util_percent": 7.848148148148148}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49994342899130234, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.42891185146891664, "policy_loss": -0.037021780679483085, "vf_loss": 0.006557414956990493, "vf_explained_var": 0.7790316254861893, "kl": 0.008260599760978949, "entropy": 39.96865876105524, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74710.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.725399999999855, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3696397793143172, "mean_inference_ms": 1.7394370781324653, "mean_action_processing_ms": 0.1824961710643976, "mean_env_wait_ms": 45.455451649374744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037201642990112305, "StateBufferConnector_ms": 0.0047588348388671875, "ViewRequirementAgentConnector_ms": 0.12641119956970215}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.725399999999855, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999832, 23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3696397793143172, "mean_inference_ms": 1.7394370781324653, "mean_action_processing_ms": 0.1824961710643976, "mean_env_wait_ms": 45.455451649374744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037201642990112305, "StateBufferConnector_ms": 0.0047588348388671875, "ViewRequirementAgentConnector_ms": 0.12641119956970215}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.34151318035885, "num_env_steps_trained_throughput_per_sec": 196.34151318035885, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 19287.754, "sample_time_ms": 10739.022, "load_time_ms": 301.729, "load_throughput": 13256.93, "learn_time_ms": 8226.198, "learn_throughput": 486.251, "synch_weights_time_ms": 20.246}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 528, "training_iteration": 121, "trial_id": "74231_00000", "date": "2025-04-22_14-30-09", "timestamp": 1745346609, "time_this_iter_s": 20.378371715545654, "time_total_s": 2295.2232325077057, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0058000000000000005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2295.2232325077057, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 16.765517241379314, "ram_util_percent": 7.910344827586208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5058856235066008, "policy_loss": -0.09613693488927018, "vf_loss": 0.0006392506115686604, "vf_explained_var": 0.526515591721381, "kl": 0.008396523747609125, "entropy": 41.16474235903832, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75330.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.726199999999853, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36942912280098633, "mean_inference_ms": 1.7384177389257045, "mean_action_processing_ms": 0.18245254413688056, "mean_env_wait_ms": 45.45223284771478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037222862243652344, "StateBufferConnector_ms": 0.00475311279296875, "ViewRequirementAgentConnector_ms": 0.12661218643188477}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.726199999999853, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.829999999999632, 15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36942912280098633, "mean_inference_ms": 1.7384177389257045, "mean_action_processing_ms": 0.18245254413688056, "mean_env_wait_ms": 45.45223284771478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037222862243652344, "StateBufferConnector_ms": 0.00475311279296875, "ViewRequirementAgentConnector_ms": 0.12661218643188477}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.69973370902107, "num_env_steps_trained_throughput_per_sec": 207.69973370902107, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 19362.12, "sample_time_ms": 10808.503, "load_time_ms": 300.83, "load_throughput": 13296.541, "learn_time_ms": 8231.96, "learn_throughput": 485.911, "synch_weights_time_ms": 20.272}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 529, "training_iteration": 122, "trial_id": "74231_00000", "date": "2025-04-22_14-30-29", "timestamp": 1745346629, "time_this_iter_s": 19.264267921447754, "time_total_s": 2314.4875004291534, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005765, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2314.4875004291534, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 17.637037037037036, "ram_util_percent": 7.9222222222222225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4844875851308086, "policy_loss": -0.0787232710360249, "vf_loss": 0.0008886042153746177, "vf_explained_var": 0.5167056002924519, "kl": 0.01016258118343543, "entropy": 40.81773164195399, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75950.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.628199999999858, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369428021394933, "mean_inference_ms": 1.738514907482286, "mean_action_processing_ms": 0.18246422411485788, "mean_env_wait_ms": 45.45708424818139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03722214698791504, "StateBufferConnector_ms": 0.004751682281494141, "ViewRequirementAgentConnector_ms": 0.12662267684936523}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.628199999999858, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.009999999999774, 14.12999999999982, 16.23499999999976, 55.23000000000157, 19.58999999999963, 20.169999999999664, 14.129999999999821, 15.054999999999815, 14.309999999999823, 14.649999999999809, 14.209999999999816, 15.294999999999849, 16.894999999999847, 14.209999999999821, 14.129999999999821, 14.289999999999818, 13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369428021394933, "mean_inference_ms": 1.738514907482286, "mean_action_processing_ms": 0.18246422411485788, "mean_env_wait_ms": 45.45708424818139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03722214698791504, "StateBufferConnector_ms": 0.004751682281494141, "ViewRequirementAgentConnector_ms": 0.12662267684936523}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.15262444903195, "num_env_steps_trained_throughput_per_sec": 213.15262444903195, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 19321.476, "sample_time_ms": 10755.862, "load_time_ms": 299.891, "load_throughput": 13338.164, "learn_time_ms": 8244.828, "learn_throughput": 485.153, "synch_weights_time_ms": 20.336}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 530, "training_iteration": 123, "trial_id": "74231_00000", "date": "2025-04-22_14-30-47", "timestamp": 1745346647, "time_this_iter_s": 18.771435737609863, "time_total_s": 2333.2589361667633, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00573, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2333.2589361667633, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 17.896153846153844, "ram_util_percent": 7.930769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4870597116919535, "policy_loss": -0.08277402656873868, "vf_loss": 0.0007516604386828183, "vf_explained_var": 0.7834061718756152, "kl": 0.009671408474699297, "entropy": 40.648807119554085, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 76570.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.16204999999984, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697293895041918, "mean_inference_ms": 1.7399210136314034, "mean_action_processing_ms": 0.18249509531409622, "mean_env_wait_ms": 45.46706659428011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037210702896118164, "StateBufferConnector_ms": 0.00471949577331543, "ViewRequirementAgentConnector_ms": 0.12581539154052734}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.16204999999984, "episode_len_mean": 900.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 14.209999999999818, 18.52999999999969, 14.029999999999825, 52.63000000000158, 14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697293895041918, "mean_inference_ms": 1.7399210136314034, "mean_action_processing_ms": 0.18249509531409622, "mean_env_wait_ms": 45.46706659428011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037210702896118164, "StateBufferConnector_ms": 0.00471949577331543, "ViewRequirementAgentConnector_ms": 0.12581539154052734}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.83154274622038, "num_env_steps_trained_throughput_per_sec": 211.83154274622038, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 19291.723, "sample_time_ms": 10750.971, "load_time_ms": 298.582, "load_throughput": 13396.67, "learn_time_ms": 8221.367, "learn_throughput": 486.537, "synch_weights_time_ms": 20.243}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 546, "training_iteration": 124, "trial_id": "74231_00000", "date": "2025-04-22_14-31-06", "timestamp": 1745346666, "time_this_iter_s": 18.88895058631897, "time_total_s": 2352.1478867530823, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005695, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2352.1478867530823, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 17.692592592592593, "ram_util_percent": 7.896296296296298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49922619394717677, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.47561022139064246, "policy_loss": -0.08997261807164778, "vf_loss": 0.011448849320134052, "vf_explained_var": 0.7194055579362377, "kl": 0.014570095737106444, "entropy": 39.92719740098523, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77190.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.752649999999822, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695588574858344, "mean_inference_ms": 1.7398884213145553, "mean_action_processing_ms": 0.18250825050585373, "mean_env_wait_ms": 45.44938057237862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03694033622741699, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.12502384185791016}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.752649999999822, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695588574858344, "mean_inference_ms": 1.7398884213145553, "mean_action_processing_ms": 0.18250825050585373, "mean_env_wait_ms": 45.44938057237862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03694033622741699, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.12502384185791016}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.03155124825446, "num_env_steps_trained_throughput_per_sec": 208.03155124825446, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 19225.977, "sample_time_ms": 10669.846, "load_time_ms": 298.177, "load_throughput": 13414.849, "learn_time_ms": 8237.308, "learn_throughput": 485.596, "synch_weights_time_ms": 20.082}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 552, "training_iteration": 125, "trial_id": "74231_00000", "date": "2025-04-22_14-31-26", "timestamp": 1745346686, "time_this_iter_s": 19.233303546905518, "time_total_s": 2371.381190299988, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00566, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2371.381190299988, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 17.988888888888887, "ram_util_percent": 7.907407407407407}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4991439166088258, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.42027001125970853, "policy_loss": -0.05134186383276697, "vf_loss": 0.022775686347698675, "vf_explained_var": 0.6594818648792082, "kl": 0.012334921907125634, "entropy": 39.35540795480051, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77810.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.752649999999822, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695588574858344, "mean_inference_ms": 1.7398884213145553, "mean_action_processing_ms": 0.18250825050585373, "mean_env_wait_ms": 45.44938057237862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03694033622741699, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.12502384185791016}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.752649999999822, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695588574858344, "mean_inference_ms": 1.7398884213145553, "mean_action_processing_ms": 0.18250825050585373, "mean_env_wait_ms": 45.44938057237862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03694033622741699, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.12502384185791016}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 197.1030281047536, "num_env_steps_trained_throughput_per_sec": 197.1030281047536, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 19272.388, "sample_time_ms": 10717.833, "load_time_ms": 298.107, "load_throughput": 13418.006, "learn_time_ms": 8235.754, "learn_throughput": 485.687, "synch_weights_time_ms": 20.123}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 552, "training_iteration": 126, "trial_id": "74231_00000", "date": "2025-04-22_14-31-46", "timestamp": 1745346706, "time_this_iter_s": 20.299451112747192, "time_total_s": 2391.680641412735, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005625, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2391.680641412735, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 17.60357142857143, "ram_util_percent": 7.9678571428571425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49996049553155897, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4451700082206498, "policy_loss": -0.0487218834350877, "vf_loss": 0.008424868074443141, "vf_explained_var": 0.6936212995359975, "kl": 0.009395108054670873, "entropy": 40.62822685856973, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 78430.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.752649999999822, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695588574858344, "mean_inference_ms": 1.7398884213145553, "mean_action_processing_ms": 0.18250825050585373, "mean_env_wait_ms": 45.44938057237862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03694033622741699, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.12502384185791016}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.752649999999822, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.209999999999825, 14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695588574858344, "mean_inference_ms": 1.7398884213145553, "mean_action_processing_ms": 0.18250825050585373, "mean_env_wait_ms": 45.44938057237862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03694033622741699, "StateBufferConnector_ms": 0.004701375961303711, "ViewRequirementAgentConnector_ms": 0.12502384185791016}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.14228013757702, "num_env_steps_trained_throughput_per_sec": 203.14228013757702, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 19330.92, "sample_time_ms": 10779.31, "load_time_ms": 297.962, "load_throughput": 13424.525, "learn_time_ms": 8232.852, "learn_throughput": 485.858, "synch_weights_time_ms": 20.228}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 552, "training_iteration": 127, "trial_id": "74231_00000", "date": "2025-04-22_14-32-06", "timestamp": 1745346726, "time_this_iter_s": 19.69654655456543, "time_total_s": 2411.3771879673004, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00559, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2411.3771879673004, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 17.42857142857143, "ram_util_percent": 7.957142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49998838651564814, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4987837396952654, "policy_loss": -0.09446757755753013, "vf_loss": 0.0015135718586014762, "vf_explained_var": 0.8147654464167934, "kl": 0.010338287144452719, "entropy": 40.73804819660802, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79050.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.768199999999824, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693545938735809, "mean_inference_ms": 1.7389101037570385, "mean_action_processing_ms": 0.18246709456834037, "mean_env_wait_ms": 45.44773530104899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03679943084716797, "StateBufferConnector_ms": 0.004673004150390625, "ViewRequirementAgentConnector_ms": 0.12459087371826172}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.768199999999824, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.10999999999983, 14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693545938735809, "mean_inference_ms": 1.7389101037570385, "mean_action_processing_ms": 0.18246709456834037, "mean_env_wait_ms": 45.44773530104899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03679943084716797, "StateBufferConnector_ms": 0.004673004150390625, "ViewRequirementAgentConnector_ms": 0.12459087371826172}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.64262545198798, "num_env_steps_trained_throughput_per_sec": 215.64262545198798, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 19250.385, "sample_time_ms": 10734.47, "load_time_ms": 297.706, "load_throughput": 13436.059, "learn_time_ms": 8197.322, "learn_throughput": 487.964, "synch_weights_time_ms": 20.313}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 553, "training_iteration": 128, "trial_id": "74231_00000", "date": "2025-04-22_14-32-24", "timestamp": 1745346744, "time_this_iter_s": 18.555166006088257, "time_total_s": 2429.9323539733887, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005555, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2429.9323539733887, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 18.088461538461537, "ram_util_percent": 7.907692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.45667797088502876, "policy_loss": -0.051584874521429284, "vf_loss": 0.006425672432978093, "vf_explained_var": 0.6695514218461129, "kl": 0.008929610515676154, "entropy": 41.28582211771319, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79670.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.775399999999822, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693505902939072, "mean_inference_ms": 1.7389886462187238, "mean_action_processing_ms": 0.1824764970977928, "mean_env_wait_ms": 45.45201144318125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03671598434448242, "StateBufferConnector_ms": 0.004663228988647461, "ViewRequirementAgentConnector_ms": 0.1243443489074707}}, "episode_reward_max": 57.8000000000012, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.775399999999822, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.829999999999783, 14.129999999999827, 14.54999999999981, 57.8000000000012, 14.859999999999843, 16.20999999999975, 14.289999999999818, 16.539999999999768, 14.209999999999818, 14.209999999999818, 19.769999999999666, 14.189999999999825, 14.029999999999827, 14.309999999999823, 13.94999999999983, 14.129999999999832, 14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693505902939072, "mean_inference_ms": 1.7389886462187238, "mean_action_processing_ms": 0.1824764970977928, "mean_env_wait_ms": 45.45201144318125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03671598434448242, "StateBufferConnector_ms": 0.004663228988647461, "ViewRequirementAgentConnector_ms": 0.1243443489074707}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.94391280490305, "num_env_steps_trained_throughput_per_sec": 200.94391280490305, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 19371.484, "sample_time_ms": 10835.83, "load_time_ms": 305.317, "load_throughput": 13101.151, "learn_time_ms": 8209.244, "learn_throughput": 487.256, "synch_weights_time_ms": 20.519}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 554, "training_iteration": 129, "trial_id": "74231_00000", "date": "2025-04-22_14-32-44", "timestamp": 1745346764, "time_this_iter_s": 19.911459922790527, "time_total_s": 2449.843813896179, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00552, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2449.843813896179, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 17.157142857142855, "ram_util_percent": 7.9107142857142865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.44254656195126085, "policy_loss": -0.05671131837091619, "vf_loss": 0.018235005117815988, "vf_explained_var": 0.8080035074103263, "kl": 0.012313905404515895, "entropy": 40.591734535463395, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80290.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.512999999999812, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36968489474724, "mean_inference_ms": 1.7401612563769817, "mean_action_processing_ms": 0.18249756116826993, "mean_env_wait_ms": 45.46557735419267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03711056709289551, "StateBufferConnector_ms": 0.004691123962402344, "ViewRequirementAgentConnector_ms": 0.1252892017364502}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.512999999999812, "episode_len_mean": 900.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999821, 14.12999999999982, 16.344999999999764, 14.309999999999823, 15.16999999999982, 13.94999999999983, 15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36968489474724, "mean_inference_ms": 1.7401612563769817, "mean_action_processing_ms": 0.18249756116826993, "mean_env_wait_ms": 45.46557735419267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03711056709289551, "StateBufferConnector_ms": 0.004691123962402344, "ViewRequirementAgentConnector_ms": 0.1252892017364502}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.25312261750506, "num_env_steps_trained_throughput_per_sec": 213.25312261750506, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 19370.452, "sample_time_ms": 10822.21, "load_time_ms": 306.341, "load_throughput": 13057.329, "learn_time_ms": 8211.008, "learn_throughput": 487.151, "synch_weights_time_ms": 30.321}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 570, "training_iteration": 130, "trial_id": "74231_00000", "date": "2025-04-22_14-33-03", "timestamp": 1745346783, "time_this_iter_s": 18.762908697128296, "time_total_s": 2468.6067225933075, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005485, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2468.6067225933075, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 17.34074074074074, "ram_util_percent": 7.870370370370371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49986028565514473, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.42925724060905557, "policy_loss": -0.06628734768638687, "vf_loss": 0.02340521451219355, "vf_explained_var": 0.6914233623973784, "kl": 0.012294696025917417, "entropy": 38.82193178361462, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80910.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.67359999999981, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695388073103747, "mean_inference_ms": 1.7401918465105428, "mean_action_processing_ms": 0.1825160264817332, "mean_env_wait_ms": 45.44708446838897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03704047203063965, "StateBufferConnector_ms": 0.0046977996826171875, "ViewRequirementAgentConnector_ms": 0.1256859302520752}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.67359999999981, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695388073103747, "mean_inference_ms": 1.7401918465105428, "mean_action_processing_ms": 0.1825160264817332, "mean_env_wait_ms": 45.44708446838897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03704047203063965, "StateBufferConnector_ms": 0.0046977996826171875, "ViewRequirementAgentConnector_ms": 0.1256859302520752}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.704031888813, "num_env_steps_trained_throughput_per_sec": 199.704031888813, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 19336.149, "sample_time_ms": 10782.193, "load_time_ms": 314.476, "load_throughput": 12719.559, "learn_time_ms": 8208.611, "learn_throughput": 487.293, "synch_weights_time_ms": 30.293}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 576, "training_iteration": 131, "trial_id": "74231_00000", "date": "2025-04-22_14-33-23", "timestamp": 1745346803, "time_this_iter_s": 20.035383462905884, "time_total_s": 2488.6421060562134, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00545, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2488.6421060562134, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 17.474999999999998, "ram_util_percent": 7.7928571428571445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4631450314855864, "policy_loss": -0.06844111602798465, "vf_loss": 0.004021661377939176, "vf_explained_var": 0.7889523245634571, "kl": 0.011198838402185262, "entropy": 40.04054127354776, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81530.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.67359999999981, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695388073103747, "mean_inference_ms": 1.7401918465105428, "mean_action_processing_ms": 0.1825160264817332, "mean_env_wait_ms": 45.44708446838897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03704047203063965, "StateBufferConnector_ms": 0.0046977996826171875, "ViewRequirementAgentConnector_ms": 0.1256859302520752}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.67359999999981, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.729999999999809, 13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695388073103747, "mean_inference_ms": 1.7401918465105428, "mean_action_processing_ms": 0.1825160264817332, "mean_env_wait_ms": 45.44708446838897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03704047203063965, "StateBufferConnector_ms": 0.0046977996826171875, "ViewRequirementAgentConnector_ms": 0.1256859302520752}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.21170414116946, "num_env_steps_trained_throughput_per_sec": 201.21170414116946, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 19398.248, "sample_time_ms": 10835.168, "load_time_ms": 324.563, "load_throughput": 12324.263, "learn_time_ms": 8207.677, "learn_throughput": 487.349, "synch_weights_time_ms": 30.264}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 576, "training_iteration": 132, "trial_id": "74231_00000", "date": "2025-04-22_14-33-43", "timestamp": 1745346823, "time_this_iter_s": 19.885058164596558, "time_total_s": 2508.52716422081, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005415, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2508.52716422081, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 17.33928571428571, "ram_util_percent": 7.817857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.47553852458555823, "policy_loss": -0.06897773072386401, "vf_loss": 0.0015659802484283465, "vf_explained_var": 0.7428634334956447, "kl": 0.008724172323056865, "entropy": 40.94354125915035, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82150.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.663599999999812, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693308884183658, "mean_inference_ms": 1.739174772538471, "mean_action_processing_ms": 0.18247320422630214, "mean_env_wait_ms": 45.4435869306474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036939144134521484, "StateBufferConnector_ms": 0.004678010940551758, "ViewRequirementAgentConnector_ms": 0.1253955364227295}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.663599999999812, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693308884183658, "mean_inference_ms": 1.739174772538471, "mean_action_processing_ms": 0.18247320422630214, "mean_env_wait_ms": 45.4435869306474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036939144134521484, "StateBufferConnector_ms": 0.004678010940551758, "ViewRequirementAgentConnector_ms": 0.1253955364227295}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.33285860927472, "num_env_steps_trained_throughput_per_sec": 203.33285860927472, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 19488.877, "sample_time_ms": 10908.497, "load_time_ms": 333.907, "load_throughput": 11979.368, "learn_time_ms": 8215.632, "learn_throughput": 486.877, "synch_weights_time_ms": 30.27}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 577, "training_iteration": 133, "trial_id": "74231_00000", "date": "2025-04-22_14-34-03", "timestamp": 1745346843, "time_this_iter_s": 19.67810583114624, "time_total_s": 2528.205270051956, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00538, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2528.205270051956, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 17.175, "ram_util_percent": 7.846428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.47510594290891484, "policy_loss": -0.0705623836395511, "vf_loss": 0.0032376462348492493, "vf_explained_var": 0.782947426649832, "kl": 0.008287514876593054, "entropy": 40.90243439828196, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82770.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.707999999999808, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693153692839581, "mean_inference_ms": 1.7392066107993207, "mean_action_processing_ms": 0.18248009343283975, "mean_env_wait_ms": 45.44280154008989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03696632385253906, "StateBufferConnector_ms": 0.004683732986450195, "ViewRequirementAgentConnector_ms": 0.12546443939208984}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.707999999999808, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.469999999999821, 14.38999999999982, 15.30499999999988, 14.209999999999821, 14.10999999999983, 15.109999999999797, 15.699999999999827, 15.10999999999977, 14.549999999999821, 13.94999999999983, 14.229999999999832, 14.129999999999827, 14.129999999999827, 13.94999999999983, 14.129999999999827, 24.54999999999961, 14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693153692839581, "mean_inference_ms": 1.7392066107993207, "mean_action_processing_ms": 0.18248009343283975, "mean_env_wait_ms": 45.44280154008989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03696632385253906, "StateBufferConnector_ms": 0.004683732986450195, "ViewRequirementAgentConnector_ms": 0.12546443939208984}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.928392779287, "num_env_steps_trained_throughput_per_sec": 209.928392779287, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 19505.997, "sample_time_ms": 10937.285, "load_time_ms": 335.19, "load_throughput": 11933.521, "learn_time_ms": 8202.645, "learn_throughput": 487.648, "synch_weights_time_ms": 30.311}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 578, "training_iteration": 134, "trial_id": "74231_00000", "date": "2025-04-22_14-34-22", "timestamp": 1745346862, "time_this_iter_s": 19.059892892837524, "time_total_s": 2547.2651629447937, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005345, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2547.2651629447937, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.870370370370367, "ram_util_percent": 7.814814814814816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4698373852507962, "policy_loss": -0.06156157927527543, "vf_loss": 0.00294398258200442, "vf_explained_var": 0.9005632303414807, "kl": 0.008451731655294415, "entropy": 41.248756070290845, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83390.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.948249999999803, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697023011779496, "mean_inference_ms": 1.7405894718264567, "mean_action_processing_ms": 0.1825090601212036, "mean_env_wait_ms": 45.47508538602532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03717160224914551, "StateBufferConnector_ms": 0.0047130584716796875, "ViewRequirementAgentConnector_ms": 0.12507939338684082}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.948249999999803, "episode_len_mean": 900.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.309999999999823, 15.859999999999783, 18.389999999999688, 13.94999999999983, 15.484999999999818, 20.149999999999665, 14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3697023011779496, "mean_inference_ms": 1.7405894718264567, "mean_action_processing_ms": 0.1825090601212036, "mean_env_wait_ms": 45.47508538602532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03717160224914551, "StateBufferConnector_ms": 0.0047130584716796875, "ViewRequirementAgentConnector_ms": 0.12507939338684082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.36637069342405, "num_env_steps_trained_throughput_per_sec": 210.36637069342405, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 19484.656, "sample_time_ms": 10942.938, "load_time_ms": 335.563, "load_throughput": 11920.272, "learn_time_ms": 8175.193, "learn_throughput": 489.285, "synch_weights_time_ms": 30.401}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 594, "training_iteration": 135, "trial_id": "74231_00000", "date": "2025-04-22_14-34-41", "timestamp": 1745346881, "time_this_iter_s": 19.020455598831177, "time_total_s": 2566.285618543625, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00531, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2566.285618543625, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 17.566666666666666, "ram_util_percent": 7.803703703703705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4608218745407348, "policy_loss": -0.06773034259451613, "vf_loss": 0.010865285189042732, "vf_explained_var": 0.7879619228263055, "kl": 0.013489398015512815, "entropy": 40.598023254640644, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84010.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.862349999999806, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954541678738756, "mean_inference_ms": 1.7404774333269342, "mean_action_processing_ms": 0.182518227612441, "mean_env_wait_ms": 45.45134889372344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037142276763916016, "StateBufferConnector_ms": 0.0047075748443603516, "ViewRequirementAgentConnector_ms": 0.12458467483520508}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.862349999999806, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954541678738756, "mean_inference_ms": 1.7404774333269342, "mean_action_processing_ms": 0.182518227612441, "mean_env_wait_ms": 45.45134889372344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037142276763916016, "StateBufferConnector_ms": 0.0047075748443603516, "ViewRequirementAgentConnector_ms": 0.12458467483520508}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.60596583020256, "num_env_steps_trained_throughput_per_sec": 210.60596583020256, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 19354.542, "sample_time_ms": 10766.663, "load_time_ms": 336.983, "load_throughput": 11870.05, "learn_time_ms": 8219.537, "learn_throughput": 486.645, "synch_weights_time_ms": 30.804}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 600, "training_iteration": 136, "trial_id": "74231_00000", "date": "2025-04-22_14-35-00", "timestamp": 1745346900, "time_this_iter_s": 18.99962544441223, "time_total_s": 2585.285243988037, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005275, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2585.285243988037, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 18.603846153846153, "ram_util_percent": 7.707692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49996739558635217, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4321128261185461, "policy_loss": -0.04734552962885749, "vf_loss": 0.022544160231606634, "vf_explained_var": 0.7971797408596162, "kl": 0.011292499161396746, "entropy": 40.9005338791878, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84630.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.862349999999806, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954541678738756, "mean_inference_ms": 1.7404774333269342, "mean_action_processing_ms": 0.182518227612441, "mean_env_wait_ms": 45.45134889372344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037142276763916016, "StateBufferConnector_ms": 0.0047075748443603516, "ViewRequirementAgentConnector_ms": 0.12458467483520508}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.862349999999806, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954541678738756, "mean_inference_ms": 1.7404774333269342, "mean_action_processing_ms": 0.182518227612441, "mean_env_wait_ms": 45.45134889372344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037142276763916016, "StateBufferConnector_ms": 0.0047075748443603516, "ViewRequirementAgentConnector_ms": 0.12458467483520508}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.84943480114066, "num_env_steps_trained_throughput_per_sec": 200.84943480114066, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 19377.019, "sample_time_ms": 10785.851, "load_time_ms": 336.655, "load_throughput": 11881.608, "learn_time_ms": 8223.1, "learn_throughput": 486.435, "synch_weights_time_ms": 30.85}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 600, "training_iteration": 137, "trial_id": "74231_00000", "date": "2025-04-22_14-35-20", "timestamp": 1745346920, "time_this_iter_s": 19.92101740837097, "time_total_s": 2605.206261396408, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00524, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2605.206261396408, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 17.351724137931036, "ram_util_percent": 7.731034482758623}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.47670929471872026, "policy_loss": -0.05366576416718383, "vf_loss": 0.005377586416626957, "vf_explained_var": 0.7291528101890318, "kl": 0.00962934253501214, "entropy": 42.98655254610123, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85250.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.862349999999806, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954541678738756, "mean_inference_ms": 1.7404774333269342, "mean_action_processing_ms": 0.182518227612441, "mean_env_wait_ms": 45.45134889372344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037142276763916016, "StateBufferConnector_ms": 0.0047075748443603516, "ViewRequirementAgentConnector_ms": 0.12458467483520508}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.862349999999806, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.829999999999833, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954541678738756, "mean_inference_ms": 1.7404774333269342, "mean_action_processing_ms": 0.182518227612441, "mean_env_wait_ms": 45.45134889372344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037142276763916016, "StateBufferConnector_ms": 0.0047075748443603516, "ViewRequirementAgentConnector_ms": 0.12458467483520508}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.53215076740324, "num_env_steps_trained_throughput_per_sec": 204.53215076740324, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 19477.781, "sample_time_ms": 10896.967, "load_time_ms": 336.891, "load_throughput": 11873.265, "learn_time_ms": 8212.554, "learn_throughput": 487.059, "synch_weights_time_ms": 30.804}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 600, "training_iteration": 138, "trial_id": "74231_00000", "date": "2025-04-22_14-35-39", "timestamp": 1745346939, "time_this_iter_s": 19.562828540802002, "time_total_s": 2624.76908993721, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0052049999999999996, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2624.76908993721, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 18.096296296296295, "ram_util_percent": 7.818518518518518}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5040486249899973, "policy_loss": -0.073398975491704, "vf_loss": 0.0013279118649602278, "vf_explained_var": 0.6983299425532741, "kl": 0.008397799372488085, "entropy": 43.32372426679058, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85870.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.952549999999801, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36932151283444953, "mean_inference_ms": 1.7395150784329827, "mean_action_processing_ms": 0.18248293033806043, "mean_env_wait_ms": 45.448207245154684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03709244728088379, "StateBufferConnector_ms": 0.004698753356933594, "ViewRequirementAgentConnector_ms": 0.12439799308776855}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.952549999999801, "episode_len_mean": 900.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36932151283444953, "mean_inference_ms": 1.7395150784329827, "mean_action_processing_ms": 0.18248293033806043, "mean_env_wait_ms": 45.448207245154684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03709244728088379, "StateBufferConnector_ms": 0.004698753356933594, "ViewRequirementAgentConnector_ms": 0.12439799308776855}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.7960216842819, "num_env_steps_trained_throughput_per_sec": 215.7960216842819, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 19340.778, "sample_time_ms": 10783.608, "load_time_ms": 330.853, "load_throughput": 12089.967, "learn_time_ms": 8194.999, "learn_throughput": 488.103, "synch_weights_time_ms": 30.758}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 602, "training_iteration": 139, "trial_id": "74231_00000", "date": "2025-04-22_14-35-58", "timestamp": 1745346958, "time_this_iter_s": 18.54264187812805, "time_total_s": 2643.311731815338, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00517, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2643.311731815338, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 17.919230769230765, "ram_util_percent": 7.811538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5291333325898214, "policy_loss": -0.09011995986502076, "vf_loss": 0.0007731022896193955, "vf_explained_var": 0.6271398663520813, "kl": 0.01079524172538162, "entropy": 44.14057684252339, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86490.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.9769999999998, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693134278540726, "mean_inference_ms": 1.7396040860924662, "mean_action_processing_ms": 0.18248536415079916, "mean_env_wait_ms": 45.44289486173683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037035465240478516, "StateBufferConnector_ms": 0.004694938659667969, "ViewRequirementAgentConnector_ms": 0.12422537803649902}}, "episode_reward_max": 37.170000000000776, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.9769999999998, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 15.469999999999757, 24.52999999999959, 14.619999999999788, 14.129999999999821, 20.609999999999637, 14.289999999999827, 14.409999999999808, 20.78999999999965, 16.52999999999974, 14.129999999999832, 14.309999999999823, 15.969999999999777, 14.129999999999821, 15.36999999999977, 37.170000000000776, 13.94999999999983, 14.309999999999816, 15.109999999999767, 14.209999999999818, 14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693134278540726, "mean_inference_ms": 1.7396040860924662, "mean_action_processing_ms": 0.18248536415079916, "mean_env_wait_ms": 45.44289486173683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037035465240478516, "StateBufferConnector_ms": 0.004694938659667969, "ViewRequirementAgentConnector_ms": 0.12422537803649902}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.38884279429178, "num_env_steps_trained_throughput_per_sec": 202.38884279429178, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 19441.466, "sample_time_ms": 10891.06, "load_time_ms": 330.19, "load_throughput": 12114.248, "learn_time_ms": 8198.592, "learn_throughput": 487.889, "synch_weights_time_ms": 21.067}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 603, "training_iteration": 140, "trial_id": "74231_00000", "date": "2025-04-22_14-36-18", "timestamp": 1745346978, "time_this_iter_s": 19.7695415019989, "time_total_s": 2663.081273317337, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005135000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2663.081273317337, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 17.6, "ram_util_percent": 7.7851851851851865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.504439163920019, "policy_loss": -0.07411479033649929, "vf_loss": 0.006586961963531365, "vf_explained_var": 0.7541027589190391, "kl": 0.012334045371432196, "entropy": 43.8761455597416, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87110.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.809549999999795, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36952764656724446, "mean_inference_ms": 1.7405539967313817, "mean_action_processing_ms": 0.18251141330053805, "mean_env_wait_ms": 45.438244932670074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036783695220947266, "StateBufferConnector_ms": 0.004683017730712891, "ViewRequirementAgentConnector_ms": 0.12441134452819824}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.809549999999795, "episode_len_mean": 900.0, "episodes_this_iter": 21, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36952764656724446, "mean_inference_ms": 1.7405539967313817, "mean_action_processing_ms": 0.18251141330053805, "mean_env_wait_ms": 45.438244932670074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036783695220947266, "StateBufferConnector_ms": 0.004683017730712891, "ViewRequirementAgentConnector_ms": 0.12441134452819824}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.6300447247465, "num_env_steps_trained_throughput_per_sec": 208.6300447247465, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 19355.772, "sample_time_ms": 10793.288, "load_time_ms": 321.535, "load_throughput": 12440.322, "learn_time_ms": 8219.272, "learn_throughput": 486.661, "synch_weights_time_ms": 21.118}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 624, "training_iteration": 141, "trial_id": "74231_00000", "date": "2025-04-22_14-36-37", "timestamp": 1745346997, "time_this_iter_s": 19.179253578186035, "time_total_s": 2682.260526895523, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0051, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2682.260526895523, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 17.840740740740742, "ram_util_percent": 7.7851851851851865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4997918271730023, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.490640178361472, "policy_loss": -0.06953771300914306, "vf_loss": 0.011960351753526582, "vf_explained_var": 0.6694899410970749, "kl": 0.012262129727585133, "entropy": 43.49021415710449, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87730.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.809549999999795, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36952764656724446, "mean_inference_ms": 1.7405539967313817, "mean_action_processing_ms": 0.18251141330053805, "mean_env_wait_ms": 45.438244932670074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036783695220947266, "StateBufferConnector_ms": 0.004683017730712891, "ViewRequirementAgentConnector_ms": 0.12441134452819824}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.809549999999795, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36952764656724446, "mean_inference_ms": 1.7405539967313817, "mean_action_processing_ms": 0.18251141330053805, "mean_env_wait_ms": 45.438244932670074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036783695220947266, "StateBufferConnector_ms": 0.004683017730712891, "ViewRequirementAgentConnector_ms": 0.12441134452819824}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 197.91205879034314, "num_env_steps_trained_throughput_per_sec": 197.91205879034314, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 19388.915, "sample_time_ms": 10830.229, "load_time_ms": 312.575, "load_throughput": 12796.921, "learn_time_ms": 8224.348, "learn_throughput": 486.361, "synch_weights_time_ms": 21.199}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 624, "training_iteration": 142, "trial_id": "74231_00000", "date": "2025-04-22_14-36-57", "timestamp": 1745347017, "time_this_iter_s": 20.216466665267944, "time_total_s": 2702.476993560791, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005065, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2702.476993560791, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 17.30344827586207, "ram_util_percent": 7.868965517241381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5081155847983375, "policy_loss": -0.06018048994198081, "vf_loss": 0.0048233695767521565, "vf_explained_var": 0.641238157114675, "kl": 0.010192084225667303, "entropy": 45.428728454343734, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88350.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.809549999999795, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36952764656724446, "mean_inference_ms": 1.7405539967313817, "mean_action_processing_ms": 0.18251141330053805, "mean_env_wait_ms": 45.438244932670074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036783695220947266, "StateBufferConnector_ms": 0.004683017730712891, "ViewRequirementAgentConnector_ms": 0.12441134452819824}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.809549999999795, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.469999999999803, 14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36952764656724446, "mean_inference_ms": 1.7405539967313817, "mean_action_processing_ms": 0.18251141330053805, "mean_env_wait_ms": 45.438244932670074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036783695220947266, "StateBufferConnector_ms": 0.004683017730712891, "ViewRequirementAgentConnector_ms": 0.12441134452819824}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.37422425350803, "num_env_steps_trained_throughput_per_sec": 201.37422425350803, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 19408.049, "sample_time_ms": 10860.775, "load_time_ms": 303.097, "load_throughput": 13197.101, "learn_time_ms": 8222.599, "learn_throughput": 486.464, "synch_weights_time_ms": 21.017}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 624, "training_iteration": 143, "trial_id": "74231_00000", "date": "2025-04-22_14-37-17", "timestamp": 1745347037, "time_this_iter_s": 19.868767976760864, "time_total_s": 2722.345761537552, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.005030000000000001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2722.345761537552, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 17.8, "ram_util_percent": 7.9107142857142865}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5451811603926715, "policy_loss": -0.08854686079317733, "vf_loss": 0.0008163577630996095, "vf_explained_var": 0.7817945054461879, "kl": 0.008657449713521805, "entropy": 45.874929428100586, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88970.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.806949999999794, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693287356240225, "mean_inference_ms": 1.7395811875755183, "mean_action_processing_ms": 0.18247058612061157, "mean_env_wait_ms": 45.438742977751865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0367741584777832, "StateBufferConnector_ms": 0.004675388336181641, "ViewRequirementAgentConnector_ms": 0.12438535690307617}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.806949999999794, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.484999999999797, 13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693287356240225, "mean_inference_ms": 1.7395811875755183, "mean_action_processing_ms": 0.18247058612061157, "mean_env_wait_ms": 45.438742977751865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0367741584777832, "StateBufferConnector_ms": 0.004675388336181641, "ViewRequirementAgentConnector_ms": 0.12438535690307617}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.1311746659744, "num_env_steps_trained_throughput_per_sec": 205.1311746659744, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 19452.609, "sample_time_ms": 10884.084, "load_time_ms": 301.99, "load_throughput": 13245.468, "learn_time_ms": 8244.985, "learn_throughput": 485.143, "synch_weights_time_ms": 20.964}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 625, "training_iteration": 144, "trial_id": "74231_00000", "date": "2025-04-22_14-37-36", "timestamp": 1745347056, "time_this_iter_s": 19.504952907562256, "time_total_s": 2741.850714445114, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.004995, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2741.850714445114, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 17.210714285714285, "ram_util_percent": 7.953571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5285016963724047, "policy_loss": -0.07142895668606093, "vf_loss": 0.001400048888210163, "vf_explained_var": 0.7634272776303753, "kl": 0.008571160673554621, "entropy": 45.97584696123677, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89590.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.802399999999793, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693039345863799, "mean_inference_ms": 1.7395892065999499, "mean_action_processing_ms": 0.1824754174736134, "mean_env_wait_ms": 45.43626050092493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036745309829711914, "StateBufferConnector_ms": 0.0046770572662353516, "ViewRequirementAgentConnector_ms": 0.12422657012939453}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 15.802399999999793, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 13.94999999999983, 14.209999999999818, 14.02999999999983, 14.029999999999825, 13.94999999999983, 14.109999999999824, 13.94999999999983, 14.209999999999818, 14.029999999999827, 14.129999999999832, 13.94999999999983, 14.209999999999823, 15.009999999999785, 14.129999999999827, 15.469999999999771, 13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3693039345863799, "mean_inference_ms": 1.7395892065999499, "mean_action_processing_ms": 0.1824754174736134, "mean_env_wait_ms": 45.43626050092493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036745309829711914, "StateBufferConnector_ms": 0.0046770572662353516, "ViewRequirementAgentConnector_ms": 0.12422657012939453}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.67349149677352, "num_env_steps_trained_throughput_per_sec": 208.67349149677352, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 19468.035, "sample_time_ms": 10897.311, "load_time_ms": 302.746, "load_throughput": 13212.396, "learn_time_ms": 8246.429, "learn_throughput": 485.058, "synch_weights_time_ms": 20.971}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 626, "training_iteration": 145, "trial_id": "74231_00000", "date": "2025-04-22_14-37-56", "timestamp": 1745347076, "time_this_iter_s": 19.1739182472229, "time_total_s": 2761.024632692337, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00496, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2761.024632692337, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 18.01111111111111, "ram_util_percent": 7.9296296296296305}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5093140981911171, "policy_loss": -0.048709480382498324, "vf_loss": 0.002501249155428072, "vf_explained_var": 0.8503498921471258, "kl": 0.010270283128245261, "entropy": 46.4646419279037, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90210.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.055749999999794, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3696931193785273, "mean_inference_ms": 1.7407851449765142, "mean_action_processing_ms": 0.18249470977590374, "mean_env_wait_ms": 45.46526091574187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037093162536621094, "StateBufferConnector_ms": 0.004683017730712891, "ViewRequirementAgentConnector_ms": 0.1247856616973877}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.055749999999794, "episode_len_mean": 900.0, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.94999999999983, 14.85499999999982, 26.989999999999604, 13.94999999999983, 14.02999999999983, 14.389999999999823, 14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3696931193785273, "mean_inference_ms": 1.7407851449765142, "mean_action_processing_ms": 0.18249470977590374, "mean_env_wait_ms": 45.46526091574187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037093162536621094, "StateBufferConnector_ms": 0.004683017730712891, "ViewRequirementAgentConnector_ms": 0.1247856616973877}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.08373524898047, "num_env_steps_trained_throughput_per_sec": 212.08373524898047, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 19454.8, "sample_time_ms": 10918.719, "load_time_ms": 309.908, "load_throughput": 12907.039, "learn_time_ms": 8205.053, "learn_throughput": 487.504, "synch_weights_time_ms": 20.538}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 642, "training_iteration": 146, "trial_id": "74231_00000", "date": "2025-04-22_14-38-15", "timestamp": 1745347095, "time_this_iter_s": 18.866374969482422, "time_total_s": 2779.8910076618195, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0049250000000000006, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2779.8910076618195, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 18.599999999999998, "ram_util_percent": 7.853846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49997774727882877, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4910943640215743, "policy_loss": -0.04951191582236319, "vf_loss": 0.010939347095310012, "vf_explained_var": 0.7434871119837607, "kl": 0.012893546325247689, "entropy": 45.44558373728106, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90830.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.027299999999787, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 24.689999999999603, 13.94999999999983, 14.829999999999808, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954058362633524, "mean_inference_ms": 1.740682397097136, "mean_action_processing_ms": 0.18250484813957246, "mean_env_wait_ms": 45.43758378679877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03685331344604492, "StateBufferConnector_ms": 0.004673957824707031, "ViewRequirementAgentConnector_ms": 0.12482595443725586}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.027299999999787, "episode_len_mean": 900.0, "episodes_this_iter": 6, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 24.689999999999603, 13.94999999999983, 14.829999999999808, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954058362633524, "mean_inference_ms": 1.740682397097136, "mean_action_processing_ms": 0.18250484813957246, "mean_env_wait_ms": 45.43758378679877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03685331344604492, "StateBufferConnector_ms": 0.004673957824707031, "ViewRequirementAgentConnector_ms": 0.12482595443725586}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.70282736269718, "num_env_steps_trained_throughput_per_sec": 210.70282736269718, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 19361.668, "sample_time_ms": 10782.349, "load_time_ms": 309.288, "load_throughput": 12932.934, "learn_time_ms": 8248.877, "learn_throughput": 484.914, "synch_weights_time_ms": 20.581}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 648, "training_iteration": 147, "trial_id": "74231_00000", "date": "2025-04-22_14-38-34", "timestamp": 1745347114, "time_this_iter_s": 18.990042209625244, "time_total_s": 2798.8810498714447, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.00489, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2798.8810498714447, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 18.05925925925926, "ram_util_percent": 7.803703703703705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.4879493066950911, "policy_loss": -0.03720350940110943, "vf_loss": 0.006081161345742481, "vf_explained_var": 0.8047925049258816, "kl": 0.010322475294543115, "entropy": 45.83753406770768, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91450.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.027299999999787, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 24.689999999999603, 13.94999999999983, 14.829999999999808, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954058362633524, "mean_inference_ms": 1.740682397097136, "mean_action_processing_ms": 0.18250484813957246, "mean_env_wait_ms": 45.43758378679877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03685331344604492, "StateBufferConnector_ms": 0.004673957824707031, "ViewRequirementAgentConnector_ms": 0.12482595443725586}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.027299999999787, "episode_len_mean": 900.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.029999999999825, 14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 24.689999999999603, 13.94999999999983, 14.829999999999808, 13.94999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36954058362633524, "mean_inference_ms": 1.740682397097136, "mean_action_processing_ms": 0.18250484813957246, "mean_env_wait_ms": 45.43758378679877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03685331344604492, "StateBufferConnector_ms": 0.004673957824707031, "ViewRequirementAgentConnector_ms": 0.12482595443725586}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.73764374644142, "num_env_steps_trained_throughput_per_sec": 201.73764374644142, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 19388.759, "sample_time_ms": 10806.295, "load_time_ms": 309.109, "load_throughput": 12940.41, "learn_time_ms": 8252.205, "learn_throughput": 484.719, "synch_weights_time_ms": 20.575}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 648, "training_iteration": 148, "trial_id": "74231_00000", "date": "2025-04-22_14-38-53", "timestamp": 1745347133, "time_this_iter_s": 19.833534955978394, "time_total_s": 2818.714584827423, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.004855, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2818.714584827423, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 17.835714285714282, "ram_util_percent": 7.8535714285714295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5402551953048039, "policy_loss": -0.07239909451267111, "vf_loss": 0.0011458381570183783, "vf_explained_var": 0.6293861702565224, "kl": 0.010809115281881531, "entropy": 47.06233176569785, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92070.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02829999999979, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 24.689999999999603, 13.94999999999983, 14.829999999999808, 13.94999999999983, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36934514222814663, "mean_inference_ms": 1.7397157307800861, "mean_action_processing_ms": 0.18246411912991917, "mean_env_wait_ms": 45.439383433801595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03683757781982422, "StateBufferConnector_ms": 0.004667758941650391, "ViewRequirementAgentConnector_ms": 0.12476682662963867}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02829999999979, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.129999999999832, 14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 24.689999999999603, 13.94999999999983, 14.829999999999808, 13.94999999999983, 14.129999999999832], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36934514222814663, "mean_inference_ms": 1.7397157307800861, "mean_action_processing_ms": 0.18246411912991917, "mean_env_wait_ms": 45.439383433801595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03683757781982422, "StateBufferConnector_ms": 0.004667758941650391, "ViewRequirementAgentConnector_ms": 0.12476682662963867}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.51903518432073, "num_env_steps_trained_throughput_per_sec": 209.51903518432073, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 19444.291, "sample_time_ms": 10848.611, "load_time_ms": 308.875, "load_throughput": 12950.232, "learn_time_ms": 8265.803, "learn_throughput": 483.922, "synch_weights_time_ms": 20.427}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 649, "training_iteration": 149, "trial_id": "74231_00000", "date": "2025-04-22_14-39-13", "timestamp": 1745347153, "time_this_iter_s": 19.096702575683594, "time_total_s": 2837.8112874031067, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0048200000000000005, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2837.8112874031067, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 18.09629629629629, "ram_util_percent": 7.862962962962964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5, "cur_kl_coeff": 0.15, "cur_lr": 2.9999999999999997e-05, "total_loss": -0.5154439253334496, "policy_loss": -0.05288816914150131, "vf_loss": 0.0011153402213758747, "vf_explained_var": 0.812509048369623, "kl": 0.00995984965289863, "entropy": 46.51650812702794, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92690.5, "diff_num_grad_updates_vs_sampler_policy": 309.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02729999999979, "episode_len_mean": 900.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 24.689999999999603, 13.94999999999983, 14.829999999999808, 13.94999999999983, 14.129999999999832, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369317481350829, "mean_inference_ms": 1.7397101367408223, "mean_action_processing_ms": 0.18246808107640597, "mean_env_wait_ms": 45.4361058130136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036772727966308594, "StateBufferConnector_ms": 0.0046579837799072266, "ViewRequirementAgentConnector_ms": 0.12453007698059082}}, "episode_reward_max": 29.949999999999637, "episode_reward_min": 13.94999999999983, "episode_reward_mean": 16.02729999999979, "episode_len_mean": 900.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.509999999999794, 15.269999999999808, 15.76499999999978, 14.829999999999806, 15.089999999999822, 25.089999999999574, 17.44999999999985, 13.94999999999983, 15.524999999999915, 13.94999999999983, 13.94999999999983, 14.209999999999832, 14.79499999999991, 14.129999999999832, 14.309999999999821, 14.029999999999827, 16.719999999999857, 24.409999999999584, 13.94999999999983, 14.209999999999823, 17.384999999999735, 14.02999999999983, 29.949999999999637, 14.389999999999823, 14.38999999999982, 13.94999999999983, 14.72999999999982, 18.389999999999638, 14.129999999999821, 14.309999999999823, 14.02999999999983, 16.70999999999975, 14.129999999999827, 15.169999999999801, 13.94999999999983, 14.02999999999983, 26.5099999999996, 19.129999999999647, 14.10999999999983, 15.009999999999785, 14.029999999999825, 15.109999999999816, 17.03999999999979, 28.649999999999608, 14.129999999999827, 15.04499999999977, 14.02999999999983, 14.829999999999815, 14.029999999999827, 17.48999999999986, 18.209999999999688, 19.58999999999965, 16.394999999999754, 14.409999999999833, 14.10999999999983, 14.02999999999983, 14.129999999999821, 14.309999999999823, 13.94999999999983, 18.249999999999698, 13.94999999999983, 15.769999999999792, 14.38999999999982, 13.94999999999983, 13.94999999999983, 13.94999999999983, 15.72999999999981, 28.549999999999613, 14.209999999999818, 14.389999999999807, 14.129999999999821, 29.689999999999635, 14.694999999999803, 14.649999999999801, 14.209999999999832, 14.029999999999825, 24.369999999999585, 14.129999999999827, 15.109999999999816, 15.689999999999776, 13.94999999999983, 19.54999999999964, 19.709999999999663, 15.00999999999983, 14.109999999999824, 14.389999999999814, 14.309999999999823, 14.289999999999813, 14.829999999999815, 15.30499999999998, 13.94999999999983, 13.94999999999983, 13.94999999999983, 13.94999999999983, 24.689999999999603, 13.94999999999983, 14.829999999999808, 13.94999999999983, 14.129999999999832, 14.02999999999983], "episode_lengths": [900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900, 900]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.369317481350829, "mean_inference_ms": 1.7397101367408223, "mean_action_processing_ms": 0.18246808107640597, "mean_env_wait_ms": 45.4361058130136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036772727966308594, "StateBufferConnector_ms": 0.0046579837799072266, "ViewRequirementAgentConnector_ms": 0.12453007698059082}, "num_healthy_workers": 24, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.1905876569843, "num_env_steps_trained_throughput_per_sec": 213.1905876569843, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 19344.153, "sample_time_ms": 10742.633, "load_time_ms": 308.911, "load_throughput": 12948.728, "learn_time_ms": 8271.665, "learn_throughput": 483.579, "synch_weights_time_ms": 20.372}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": true, "episodes_total": 650, "training_iteration": 150, "trial_id": "74231_00000", "date": "2025-04-22_14-39-31", "timestamp": 1745347171, "time_this_iter_s": 18.76794719696045, "time_total_s": 2856.579234600067, "pid": 763949, "hostname": "mecha-ws-2", "node_ip": "10.26.3.157", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "FlagFrenzyEnv-v0", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "_env_to_module_connector": null, "_module_to_env_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.995, "lr": 3e-05, "grad_clip": 0.5, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "flag_frenzy_model", "custom_model_config": {}, "custom_action_dist": "hybrid_action_dist", "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x703209d660d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "custom_async_evaluation_function": null, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 20, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.004785, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "horizon": 900, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 0.95, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class '__main__.FlagFrenzyCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 24}, "time_since_restore": 2856.579234600067, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 18.488461538461543, "ram_util_percent": 7.8076923076923075}}
